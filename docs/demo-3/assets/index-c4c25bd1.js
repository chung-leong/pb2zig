var $n=Object.defineProperty;var Dn=(e,t,n)=>t in e?$n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var P=(e,t,n)=>(Dn(e,typeof t!="symbol"?t+"":t,n),n);const x={Void:0,Bool:1,Int:2,Uint:3,Float:4,Object:5,Type:6,Comptime:7,Static:8,Literal:9,Null:10,Undefined:11,Unsupported:12},v={Primitive:0,Array:1,Struct:2,ExternStruct:3,PackedStruct:4,ArgStruct:5,VariadicStruct:6,ExternUnion:7,BareUnion:8,TaggedUnion:9,ErrorUnion:10,ErrorSet:11,Enum:12,Optional:13,SinglePointer:14,SlicePointer:15,MultiPointer:16,CPointer:17,Slice:18,Vector:19,Opaque:20,Function:21},fe={Normal:0,Scratch:1};function Jt(e){const{type:t,bitSize:n,byteSize:s}=e;if(t===x.Int)return`${n<=32?"":"Big"}Int${n}`;if(t===x.Uint)return`${n<=32?"":"Big"}Uint${n}`;if(t===x.Float)return`Float${n}`;if(t===x.Bool)return`Bool${s!==void 0?s*8:1}`;if(t===x.Void)return"Null"}function jn(e){for(const[t,n]of Object.entries(v))if(n===e)return t.replace(/\B[A-Z]/g,s=>` ${s}`).toLowerCase()}function Cn(e){const{type:t,bitSize:n}=e,s=t===x.Int;let i=s?n-1:n;if(n<=32){const o=2**i-1;return{min:s?-(2**i):0,max:o}}else{i=BigInt(i);const o=2n**i-1n;return{min:s?-(2n**i):0n,max:o}}}function Ue({type:e,bitSize:t}){if(e===x.Int||e===x.Uint)return t<=32?Number:BigInt;if(e===x.Float)return Number;if(e===x.Bool)return Boolean}function Le(e){const t=Ue(e);if(t)return typeof t(0)}function Pe(e){switch(e){case v.SinglePointer:case v.SlicePointer:case v.MultiPointer:case v.CPointer:return!0;default:return!1}}function kn(e){return e===v.Array||e===v.Vector||e===v.Slice}function me({bitOffset:e,bitSize:t,byteSize:n}){return n!==void 0||!(e&7)&&!(t&7)||t===0}function Ct(e){return typeof e=="object"&&typeof e.error=="string"&&Object.keys(e).length===1}class _n extends ReferenceError{constructor(t){super(`Invalid memory deallocation: @${t.toString(16)}`)}}class Fn extends TypeError{constructor(t){const{name:n}=t;super(`An initializer must be provided to the constructor of ${n}, even when the intended value is undefined`)}}class We extends TypeError{constructor(t,n,s=null){const{name:i,type:o,byteSize:r}=t,c=n.byteLength,l=r!==1?"s":"";let a;if(o===v.Slice&&!s)a=`${i} has elements that are ${r} byte${l} in length, received ${c}`;else{const f=o===v.Slice?s.length*r:r;a=`${i} has ${f} byte${l}, received ${c}`}super(a)}}class zn extends TypeError{constructor(t){const{type:n,byteSize:s,typedArray:i}=t,o=s!==1?"s":"",r=["ArrayBuffer","DataView"].map(ct);i&&r.push(ct(i.name));let c;n===v.Slice?c=`Expecting ${ue(r)} that can accommodate items ${s} byte${o} in length`:c=`Expecting ${ue(r)} that is ${s} byte${o} in length`,super(c)}}class Bn extends TypeError{constructor(t,n){const{name:s}=t;let i;typeof n=="number"||typeof n=="bigint"?i=`Value given does not correspond to an item of enum ${s}: ${n}`:i=`Enum item of the type ${s} expected, received ${n}`,super(i)}}class Nn extends TypeError{constructor(t,n){const{name:s}=t,i=typeof n;let o;i==="string"||i==="number"||Ct(n)?(Ct(n)&&(n=`{ error: ${JSON.stringify(n.error)} }`),o=`Error ${i} does not corresponds to any error in error set ${s}: ${n}`):o=`Error of the type ${s} expected, received ${n}`,super(o)}}class Ge extends TypeError{constructor(t){const{name:n}=t;super(`Error given is not a part of error set ${n}`)}}class mt extends TypeError{constructor(t,n,s){const{name:i}=t,o=[];if(Array.isArray(n))for(const c of n)o.push(ct(c));else o.push(ct(n));const r=He(s);super(`${i} expects ${ue(o)} as argument, received ${r}`)}}class bt extends mt{constructor(t,n,s=!1){var a;const{instance:{members:[i]},type:o,typedArray:r}=t,c=[],l=Le(i);if(l){let f;switch((a=i.structure)==null?void 0:a.type){case v.Enum:f="enum item";break;case v.ErrorSet:f="error";break;default:f=l}c.push(`array of ${f}s`)}else c.push("array of objects");r&&c.push(r.name),o===v.Slice&&s&&c.push("length"),super(t,c.join(" or "),n)}}class Ht extends TypeError{constructor(t,n,s){const{name:i,length:o,instance:{members:[r]}}=t,{structure:{constructor:c}}=r,{length:l,constructor:a}=s,f=(n==null?void 0:n.length)??o,u=f!==1?"s":"";let d;a===c?d="only a single one":a.child===c?d=`a slice/array that has ${l}`:d=`${l} initializer${l>1?"s":""}`,super(`${i} has ${f} element${u}, received ${d}`)}}class Me extends TypeError{constructor(t,n){t<0?super("Length of slice cannot be negative"):super(`Length of slice can be ${n} or less, received ${t}`)}}class Rn extends TypeError{constructor(t,n){const{name:s}=t;super(`Missing initializers for ${s}: ${n.join(", ")}`)}}class Un extends TypeError{constructor(t,n){const{name:s,instance:{members:i}}=t,o=i.find(c=>c.name===n);let r;o?r=`Comptime value cannot be changed: ${n}`:r=`${s} does not have a property with that name: ${n}`,super(r)}}class Ln extends Error{constructor(t,n,s){const i=n!==1?"s":"";super(`${t}() expects ${n} argument${i}, received ${s}`)}}class Wn extends TypeError{constructor(t){super("Non-slice pointers can only be created with the help of the new operator")}}class Gn extends TypeError{constructor(t,n){const{name:s}=t,{constructor:{name:i}}=n;super(`Conversion of ${i} to ${s} requires an explicit cast`)}}class $e extends TypeError{constructor(t,n,s,i){const{name:o}=t;super(`${o} expects the sentinel value ${n} at ${i-1}, found at ${s}`)}}class Nt extends TypeError{constructor(t,n,s){const{name:i}=t;super(`${i} expects the sentinel value ${n} at ${s-1}`)}}class qn extends TypeError{constructor(t,n){super(`Unable to simultaneously align memory to ${n}-byte and ${t}-byte boundary`)}}class Yt extends TypeError{constructor(t,n){const s=He(n);super(`Expected ${ct(t)}, received ${s}`)}}class Jn extends TypeError{constructor(){super("Null pointer")}}class Hn extends TypeError{constructor(t,n){const{name:s}=t;let i;if(n!=null){const o=typeof n,r=o==="object"&&n.constructor!==Object?`${n.constructor.name} object`:o;i=`${Ye(r)} ${r}`}else i=n+"";super(`${s} cannot point to ${i}`)}}class Yn extends TypeError{constructor(t,n){super("Pointers in fixed memory cannot point to garbage-collected object")}}class Kn extends TypeError{constructor(t,n){const s=Jt(t);super(`${s} cannot represent the value given: ${n}`)}}class De extends RangeError{constructor(t,n){const{name:s}=t;super(`Index exceeds the size of ${s??"array"}: ${n}`)}}class Xn extends TypeError{constructor(t){const{name:n,structure:{name:{struct:s}}}=t;super(`Unable to create ${s} as it is not situated on a byte boundary: ${n}`)}}class Zn extends TypeError{constructor(){super("Unable to modify read-only object")}}class Qn extends TypeError{constructor(t){const{name:n}=t;super(`${n} cannot point to a read-only object`)}}class qe extends Error{constructor(t){super(Je(t))}}class je extends qe{constructor(t){super("Program exited"),this.code=t}}function ts(e,t,n,s){const i=`args[${t}]`,o=t!==0?"..., ":"",r=t!==n-1?", ...":"",c=o+i+r,l=Object.create(s.constructor.prototype);return l.message=`${e}(${c}): ${s.message}`,l.stack=s.stack,l}function Ce(e,t,n){return n instanceof RangeError&&!(n instanceof De)&&(n=new De(e,t)),n}function Ot(){throw new Zn}function es(e,t){const n=ct(e.typedArray.name),s=ct(t.constructor.name);console.warn(`Implicitly creating ${n} from ${s}`)}function Je(e){let t=e.replace(/_/g," ");try{t=t.replace(/(\p{Uppercase}+)(\p{Lowercase}*)/gu,(n,s,i)=>s.length===1?` ${s.toLocaleLowerCase()}${i}`:i?n:` ${s}`).trimStart()}catch{}return t.charAt(0).toLocaleUpperCase()+t.substring(1)}function He(e){const t=typeof e;let n;return t==="object"?n=e?Object.prototype.toString.call(e):"null":n=t,ct(n)}function ct(e){return`${Ye(e)} ${e}`}function Ye(e){return/^\W*[aeiou]/i.test(e)?"an":"a"}function ue(e,t="or"){const n=` ${t} `;return e.length>2?e.slice(0,-1).join(", ")+n+e[e.length-1]:e.join(n)}const g=Symbol("memory"),I=Symbol("slots"),ge=Symbol("parent"),D=Symbol("fixed"),Ke=Symbol("name"),G=Symbol("type"),Xe=Symbol("tuple"),$t=Symbol("class"),ke=Symbol("tag"),gt=Symbol("props"),Kt=Symbol("getter"),Xt=Symbol("setter"),Pt=Symbol("elementGetter"),Mt=Symbol("elementSetter"),K=Symbol("targetGetter"),he=Symbol("targetSetter"),wt=Symbol("entriesGetter"),de=Symbol("addressSetter"),ye=Symbol("lengthSetter"),Ze=Symbol("targetUpdater"),Rt=Symbol("maxLength"),Zt=Symbol("propSetters"),U=Symbol("memoryRestorer"),q=Symbol("writeDisabler"),Qe=Symbol("allKeys"),Ut=Symbol("address"),pt=Symbol("length"),Qt=Symbol("proxy"),_t=Symbol("compat"),tn=Symbol("cache"),J=Symbol("size"),ns=Symbol("bitSize"),_=Symbol("align"),we=Symbol("array"),St=Symbol("pointer"),vt=Symbol("constTarget"),le=Symbol("constProxy"),j=Symbol("copier"),_e=Symbol("resetter"),X=Symbol("vivificator"),k=Symbol("pointerVisitor"),Dt=Symbol("environment"),ss=Symbol("attributes"),en=Symbol("more"),is=Symbol("primitive");function lt(e){return function(){const t=this[g];this[g]=null,this[I]&&(this[I]={}),e.releaseFixedView(t)}}function Fe(e,t,n){if(e+t<=8){const s=2**t-1;if(n)return function(i,o,r){const l=o.getUint8(r)>>e&s;i.setUint8(0,l)};{const i=255^s<<e;return function(o,r,c){const l=r.getUint8(0),f=o.getUint8(c)&i|(l&s)<<e;o.setUint8(c,f)}}}else{const s=8-e,i=2**s-1;if(n){const r=2**(t%8)-1;return function(c,l,a){let f=a,u=0,d=l.getUint8(f++),b,m=d>>e&i,h=s,p=t;do p>h&&(d=l.getUint8(f++),m=m|d<<h),b=p>=8?m&255:m&r,c.setUint8(u++,b),m>>=8,p-=8;while(p>0)}}else{const r=2**((t-s)%8)-1,c=255^i<<e,l=255^r;return function(a,f,u){let d=0,b=u,m=a.getUint8(b),h,p,w=m&c,S=e,M=t+S;do M>S&&(h=f.getUint8(d++),w=w|h<<S,S+=8),M>=8?p=w&255:(m=a.getUint8(b),p=m&l|w&r),a.setUint8(b++,p),w>>=8,S-=8,M-=8;while(M>0)}}}}function H(e,t=!1){const n=Se(e,t);return function(s){var r,c;(r=this[U])==null||r.call(this),(c=s[U])==null||c.call(s);const i=s[g],o=this[g];n(o,i)}}function Se(e,t=!1){if(e!==void 0){if(!t){const n=rs[e];if(n)return n}return e&7?e&3?e&1?cs:ls:as:fs}else return os}function os(e,t){Se(e.byteLength)(e,t)}const rs={1:us,2:hs,4:ds,8:ys,16:ps,32:bs};function cs(e,t){for(let n=0,s=e.byteLength;n<s;n++)e.setInt8(n,t.getInt8(n))}function ls(e,t){for(let n=0,s=e.byteLength;n<s;n+=2)e.setInt16(n,t.getInt16(n,!0),!0)}function as(e,t){for(let n=0,s=e.byteLength;n<s;n+=4)e.setInt32(n,t.getInt32(n,!0),!0)}function fs(e,t){for(let n=0,s=e.byteLength;n<s;n+=8)e.setInt32(n,t.getInt32(n,!0),!0),e.setInt32(n+4,t.getInt32(n+4,!0),!0)}function us(e,t){e.setInt8(0,t.getInt8(0))}function hs(e,t){e.setInt16(0,t.getInt16(0,!0),!0)}function ds(e,t){e.setInt32(0,t.getInt32(0,!0),!0)}function ys(e,t){e.setInt32(0,t.getInt32(0,!0),!0),e.setInt32(4,t.getInt32(4,!0),!0)}function ps(e,t){e.setInt32(0,t.getInt32(0,!0),!0),e.setInt32(4,t.getInt32(4,!0),!0),e.setInt32(8,t.getInt32(8,!0),!0),e.setInt32(12,t.getInt32(12,!0),!0)}function bs(e,t){e.setInt32(0,t.getInt32(0,!0),!0),e.setInt32(4,t.getInt32(4,!0),!0),e.setInt32(8,t.getInt32(8,!0),!0),e.setInt32(12,t.getInt32(12,!0),!0),e.setInt32(16,t.getInt32(16,!0),!0),e.setInt32(20,t.getInt32(20,!0),!0),e.setInt32(24,t.getInt32(24,!0),!0),e.setInt32(28,t.getInt32(28,!0),!0)}function ms(e,t){const n=gs(t);return function(){var i;(i=this[U])==null||i.call(this);const s=this[g];n(s,e,t)}}function gs(e){const t=ws[e];return t||(e&7?e&3?e&1?Ss:vs:As:Ts)}const ws={1:Es,2:xs,4:Os,8:Is,16:Vs,32:Ps};function Ss(e,t,n){for(let s=t,i=t+n;s<i;s++)e.setInt8(s,0)}function vs(e,t,n){for(let s=t,i=t+n;s<i;s+=2)e.setInt16(s,0,!0)}function As(e,t,n){for(let s=t,i=t+n;s<i;s+=4)e.setInt32(s,0,!0)}function Ts(e,t,n){for(let s=t,i=t+n;s<i;s+=8)e.setInt32(s,0,!0),e.setInt32(s+4,0,!0)}function Es(e,t){e.setInt8(t,0)}function xs(e,t){e.setInt16(t,0,!0)}function Os(e,t){e.setInt32(t,0,!0)}function Is(e,t){e.setInt32(t+0,0,!0),e.setInt32(t+4,0,!0)}function Vs(e,t){e.setInt32(t+0,0,!0),e.setInt32(t+4,0,!0),e.setInt32(t+8,0,!0),e.setInt32(t+12,0,!0)}function Ps(e,t){e.setInt32(t+0,0,!0),e.setInt32(t+4,0,!0),e.setInt32(t+8,0,!0),e.setInt32(t+12,0,!0),e.setInt32(t+16,0,!0),e.setInt32(t+20,0,!0),e.setInt32(t+24,0,!0),e.setInt32(t+28,0,!0)}function Ms(e,t){return cn(e,t,()=>{if(me(t)){const{byteSize:n}=t,s=Jt({type:x.Int,bitSize:n*8});if(e==="get"){const i=DataView.prototype[`get${s}`];return function(o,r){return!!i.call(this,o,r)}}else{const i=DataView.prototype[`set${s}`],o=n>4?1n:1,r=n>4?0n:0;return function(c,l,a){i.call(this,c,l?o:r,a)}}}else return sn(e,t)})}function kt(e,t){return cn(e,t,n=>DataView.prototype[n]?DataView.prototype[n]:sn(e,t))}const nn={};function Ri(){nn[x.Uint]=$s}function sn(e,t){const n=nn[t.type];return n(e,t)}function $s(e,t){return me(t)?Fs(e,t):zs(e,t)}function te(e,t,n){const{type:s,byteSize:i,typedArray:o}=e;let r;const c=t==null?void 0:t[Symbol.toStringTag];if(c==="DataView")r=n.registerView(t);else if(c==="ArrayBuffer"||c==="SharedArrayBuffer")r=n.obtainView(t,0,t.byteLength);else if(o&&c===o.name||c==="Uint8ClampedArray"&&o===Uint8Array)r=n.obtainView(t.buffer,t.byteOffset,t.byteLength);else if(c==="Uint8Array"&&typeof Buffer=="function"&&t instanceof Buffer)r=n.obtainView(t.buffer,t.byteOffset,t.byteLength);else{const l=t==null?void 0:t[g];if(l){const{constructor:a,instance:{members:[f]}}=e;if(t instanceof a)return l;if(kn(s)){const{byteSize:u,structure:{constructor:d}}=f,b=rn(t,d);if(b!==void 0){if(s===v.Slice||b*u===i)return l;throw new Ht(e,null,t)}}}}return r&&i!==void 0&&on(r,e),r}function Ds(e){if((e==null?void 0:e[Symbol.toStringTag])!=="DataView")throw new Yt("a DataView",e);return e}function on(e,t){const{byteSize:n,type:s}=t;if(!(s===v.Slice?e.byteLength%n===0:e.byteLength===n))throw new We(t,e)}function Ft(e,t,n,s,i){const{byteSize:o,type:r,sentinel:c}=t,l=o??1;if(this[g]){const a=r===v.Slice?l*this.length:l;if(e.byteLength!==a)throw new We(t,e,this);const f={[g]:e};c==null||c.validateData(f,this.length),this[j](f)}else{const{shapeDefiner:a}=i;o!==void 0&&on(e,t);const f=e.byteLength/l,u={[g]:e};c==null||c.validateData(u,f),s&&(n=!0),a.call(this,n?null:e,f,s),n&&this[j](u)}}function rn(e,t){const{constructor:n}=e;if(n===t)return 1;if(n.child===t)return e.length}function js(e,t,n){const s=te(e,t,n);if(!s)throw new zn(e);return s}function At(e){const{type:t,byteSize:n}=e;if(t===x.Int)switch(n){case 1:return Int8Array;case 2:return Int16Array;case 4:return Int32Array;case 8:return BigInt64Array}else if(t===x.Uint)switch(n){case 1:return Uint8Array;case 2:return Uint16Array;case 4:return Uint32Array;case 8:return BigUint64Array}else if(t===x.Float)switch(n){case 4:return Float32Array;case 8:return Float64Array}else if(t===x.Object)return e.structure.typedArray;return null}function Cs(e,t){const n=e==null?void 0:e[Symbol.toStringTag];return!!t&&n===t.name}function ks(e,t){if(e){const n=t[_t];if(n){const s=e==null?void 0:e[Symbol.toStringTag];if(n.includes(s))return!0}if(t.child&&rn(e,t.child)!==void 0)return!0}return!1}function ee(e){const{typedArray:t}=e,n=[];return t&&(n.push(t.name),n.push("DataView"),(t===Uint8Array||t===Int8Array)&&(n.push("ArrayBuffer"),n.push("SharedArrayBuffer"),t===Uint8Array&&n.push("Uint8ClampedArray"))),n}function _s(e){const t=DataView.prototype.getBigUint64,n=DataView.prototype.setBigUint64,s=Math.ceil(e/64);return{get:function(i,o){let r=0n;if(o)for(let c=0,l=i+(s-1)*8;c<s;c++,l-=8){const a=t.call(this,l,o);r=r<<64n|a}else for(let c=0,l=i;c<s;c++,l+=8){const a=t.call(this,l,o);r=r<<64n|a}return r},set:function(i,o,r){let c=o;const l=0xFFFFFFFFFFFFFFFFn;if(r)for(let a=0,f=i;a<s;a++,f+=8){const u=c&l;n.call(this,f,u,r),c>>=64n}else{c<<=BigInt(s*64-e);for(let a=0,f=i+(s-1)*8;a<s;a++,f-=8){const u=c&l;n.call(this,f,u,r),c>>=64n}}return c}}}function Fs(e,t){const{bitSize:n,byteSize:s}=t;if(n<64){const i=Jt({...t,bitSize:s*8}),o=DataView.prototype[`get${i}`],r=DataView.prototype[`set${i}`],c=n<=32?2**n-1:2n**BigInt(n)-1n;return e==="get"?function(l,a){return o.call(this,l,a)&c}:function(l,a,f){const u=a&c;r.call(this,l,u,f)}}else{const{get:i,set:o}=_s(n),r=2n**BigInt(n)-1n;return e==="get"?function(c,l){return i.call(this,c,l)&r}:function(c,l,a){const f=l&r;o.call(this,c,f,a)}}}function zs(e,t){const{bitSize:n,bitOffset:s}=t,i=s&7;if(i+n<=8){const o=DataView.prototype.setUint8,r=DataView.prototype.getUint8,c=2**n-1;if(e==="get")return function(l){return r.call(this,l)>>>i&c};{const l=255^c<<i;return function(a,f){const d=r.call(this,a)&l|(f&c)<<i;o.call(this,a,d)}}}return Bs(e,t)}function Bs(e,t){const{bitSize:n,bitOffset:s}=t,i=s&7,o=[1,2,4,8].find(c=>c*8>=n)??Math.ceil(n/64)*64,r=new DataView(new ArrayBuffer(o));if(e==="get"){const c=kt("get",{...t,byteSize:o}),l=Fe(i,n,!0);return function(a,f){return l(r,this,a),c.call(r,0,f)}}else{const c=kt("set",{...t,byteSize:o}),l=Fe(i,n,!1);return function(a,f,u){c.call(r,0,f,u),l(this,r,a)}}}const ze={};function cn(e,t,n){const{type:s,bitOffset:i,bitSize:o,structure:r}=t,c=i&7,l=Jt(t),a=me(t)?"":`Bit${c}`,f=s===x.Int||s===x.Uint;let u=`${e}${l}${a}`,d=!1,b=u;if(f&&o===64){const h=r==null?void 0:r.name;(h==="usize"||h==="isize")&&(u+="Size",d=!0)}let m=ze[u];if(!m){if(f&&e==="set"){const h=Ue(t),p=n(b);m=function(w,S,M){p.call(this,w,h(S),M)}}else if(d&&e==="get"){const h=n(b),p=BigInt(Number.MIN_SAFE_INTEGER),w=BigInt(Number.MAX_SAFE_INTEGER);m=function(S,M){const E=h.call(this,S,M);return p<=E&&E<=w?Number(E):E}}else m=n(u);m&&m.name!==u&&Object.defineProperty(m,"name",{value:u,configurable:!0,writable:!1}),ze[u]=m}return m}function Ns({type:e}){switch(e){case x.Type:case x.Comptime:case x.Literal:return!0;default:return!1}}const at={};function Ui(){at[x.Bool]=Ls}function Li(){at[x.Int]=Ws}function ln(){at[x.Uint]=Gs}function Wi(){at[x.Float]=qs}function Gi(){at[x.Object]=Ks}function qi(){at[x.Type]=Zs}function Ji(){at[x.Comptime]=Qs}const ve={};function Rs(){ve[v.Enum]=Js}function Us(){ve[v.ErrorSet]=Hs}function N(e,t){const n=at[e.type];return n(e,t)}function an(e,t){const{structure:n}=t,s=ve[n==null?void 0:n.type];return s?s(e,n):e}function Ls(e,t){return ne(e,t,Ms)}function Ws(e,t){const n=fn(t,kt),s=ne(e,t,n);return an(s,e)}function Gs(e,t){const n=fn(t,kt),s=ne(e,t,n);return an(s,e)}function fn(e,t){return function(n,s){const{runtimeSafety:i=!0}=e,o=t(n,s);if(i&&n==="set"){const{min:r,max:c}=Cn(s);return function(l,a,f){if(a<r||a>c)throw new Kn(s,a);o.call(this,l,a,f)}}return o}}function qs(e,t){return ne(e,t,kt)}function Js(e,t){const n=function(s){const{constructor:i}=t,o=i(s);if(!o)throw new Bn(t,s);return o};return{get:e.get.length===0?function(i){const o=e.get.call(this);return i==="number"?o:n(o)}:function(i){const o=e.get.call(this,i);return n(o)},set:e.set.length===1?function(i,o){o!=="number"&&(i=n(i)[Symbol.toPrimitive]()),e.set.call(this,i)}:function(i,o){const r=n(o);e.set.call(this,i,r[Symbol.toPrimitive]())}}}function Hs(e,t){const n=function(s){const{constructor:i}=t,o=i(s);if(!o)throw s instanceof Error?new Ge(t):new Nn(t,s);return o};return{get:e.get.length===0?function(i){const o=e.get.call(this);return i==="number"?o:n(o)}:function(i){const o=e.get.call(this,i);return n(o)},set:e.set.length===1?function(i,o){if(o!=="number"){const r=n(i);i=Number(r)}e.set.call(this,i)}:function(i,o){const r=n(o);o=Number(r),e.set.call(this,i,o)}}}function Ae(e){switch(e==null?void 0:e.type){case v.Primitive:case v.ErrorUnion:case v.Optional:case v.Enum:case v.ErrorSet:return!0;default:return!1}}function un(e){return(this[I][e]??this[X](e))[Kt]()}function hn(e){return this[I][e]??this[X](e)}function Ys(e,t){(this[I][e]??this[X](e))[Xt](t)}function Te(e,{get:t,set:n}){return e!==void 0?{get:function(){return t.call(this,e)},set:n?function(s){return n.call(this,e,s)}:void 0}:{get:t,set:n}}function Ks(e,t){const{structure:n,slot:s}=e;return Te(s,{get:Ae(n)?un:hn,set:Ys})}function Xs(e){const t=this[I][e];return t==null?void 0:t.constructor}function Zs(e,t){const{slot:n}=e;return Te(n,{get:Xs})}function Qs(e,t){const{slot:n,structure:s}=e;return Te(n,{get:Ae(s)?un:hn})}function ne(e,t,n){const{littleEndian:s=!0}=t,{bitOffset:i,byteSize:o}=e,r=n("get",e),c=n("set",e);if(i!==void 0){const l=i>>3;return{get:function(){try{return r.call(this[g],l,s)}catch(f){if(f instanceof TypeError&&this[U]())return r.call(this[g],l,s);throw f}},set:function(f){try{return c.call(this[g],l,f,s)}catch(u){if(u instanceof TypeError&&this[U]())return c.call(this[g],l,f,s);throw u}}}}else return{get:function(a){try{return r.call(this[g],a*o,s)}catch(f){if(f instanceof TypeError&&this[U]())return r.call(this[g],a*o,s);throw Ce(e,a,f)}},set:function(a,f){try{return c.call(this[g],a*o,f,s)}catch(u){if(u instanceof TypeError&&this[U]())return c.call(this[g],a*o,f,s);throw Ce(e,a,u)}}}}function pe(e,t,n){if(n){const{set:s,get:i,value:o,enumerable:r,configurable:c=!0,writable:l=!0}=n;Object.defineProperty(e,t,i?{get:i,set:s,configurable:c,enumerable:r}:{value:o,configurable:c,enumerable:r,writable:l})}}function L(e,t){for(const[n,s]of Object.entries(t))pe(e,n,s);for(const n of Object.getOwnPropertySymbols(t)){const s=t[n];pe(e,n,s)}}function st(e,t,n,s){const i={};for(const[c,l]of Object.entries(t))l!=null&&l.set&&c!=="$"&&(i[c]=l.set);const{get:o,set:r}=t.$;return L(e.prototype,{[Qe]:{value:Object.keys(i)},[Xt]:{value:r},[Kt]:{value:o},[Zt]:{value:i},[vt]:{value:null},[U]:{value:Ee(e[tn],s)},...t}),L(e,n),e}function Tt(){const e=Object.getOwnPropertyDescriptors(this.constructor.prototype);for(const[t,n]of Object.entries(e))n.set&&(n.set=Ot,Object.defineProperty(this,t,n));Object.defineProperty(this,Xt,{value:Ot}),Object.defineProperty(this,vt,{value:this})}function it(e,t,n){const{byteSize:s,align:i,instance:{members:o,template:r}}=e,{modifier:c,initializer:l,finalizer:a,alternateCaster:f,shapeDefiner:u}=t,d=ti(o);let b;if(r!=null&&r[I]){const p=o.filter(w=>Ns(w));p.length>0&&(b=p.map(w=>w.slot))}const m=new ei,h=function(p,w={}){const{fixed:S=!1}=w,M=this instanceof h;let E,T;if(M){if(arguments.length===0)throw new Fn(e);E=this,d&&(E[I]={}),u?(l.call(E,p,S),T=E[g]):E[g]=T=n.allocateMemory(s,i,S)}else{if(f&&(E=f.call(this,p,w),E!==!1)||(T=js(e,p,n),E=m.find(T)))return E;E=Object.create(h.prototype),u?Ft.call(E,T,e,!1,!1,{shapeDefiner:u}):E[g]=T,d&&(E[I]={})}if(b)for(const B of b)E[I][B]=r[I][B];return c&&c.call(E),M&&(u||l.call(E,p)),a&&(E=a.call(E)),m.save(T,E)};return pe(h,tn,{value:m}),h}function Ee(e,t){return function(){const n=this[g],s=n[D];if(s&&n.buffer.byteLength===0){const i=t.obtainFixedView(s.address,s.len);return s.align&&(i[D].align=s.align),this[g]=i,e==null||e.save(i,this),!0}else return!1}}function zt({source:e}){const t=e[I][0];t&&this[he](t)}function ft(e){const{instance:{template:t}}=e;return function(n,s){var u;const i=Object.keys(n),o=this[Zt],r=this[Qe];for(const d of i)if(!(d in o))throw new Un(e,d);let c=0,l=0,a=0,f=0;for(const d of r){const b=o[d];b.special?d in n&&f++:(c++,d in n?l++:b.required&&a++)}if(a!==0&&f===0){const d=r.filter(b=>o[b].required&&!(b in n));throw new Rn(e,d)}if(f+l>i.length)for(const d of r)d in n&&(i.includes(d)||i.push(d));l<c&&f===0&&t&&(t[g]&&this[j](t),(u=this[k])==null||u.call(this,zt,{vivificate:!0,source:t}));for(const d of i)o[d].call(this,n[d],s);return i.length}}function ti(e){for(const{type:t}of e)switch(t){case x.Object:case x.Comptime:case x.Type:case x.Literal:return!0}return!1}function dn(){return this}class ei{constructor(){P(this,"map",new WeakMap)}find(t){return this.map.get(t)}save(t,n){return this.map.set(t,n),n}}const Be={},Ne={};function jt(e,t="utf-8"){let n=Be[t];n||(n=Be[t]=new TextDecoder(t));let s;if(Array.isArray(e))if(e.length===1)s=e[0];else{let i=0;for(const c of e)i+=c.length;const{constructor:o}=e[0];s=new o(i);let r=0;for(const c of e)s.set(c,r),r+=c.length}else s=e;return n.decode(s)}function ni(e,t="utf-8"){switch(t){case"utf-16":{const{length:n}=e,s=new Uint16Array(n);for(let i=0;i<n;i++)s[i]=e.charCodeAt(i);return s}default:{let n=Ne[t];return n||(n=Ne[t]=new TextEncoder),n.encode(e)}}}function si(e){const t=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=String.fromCharCode.apply(null,t);return btoa(n)}function ii(e){const t=atob(e),n=new Uint8Array(t.length);for(let s=0;s<n.byteLength;s++)n[s]=t.charCodeAt(s);return new DataView(n.buffer)}function Z(){return yn(this,!1)}function tt(){return yn(this,!0)}const oi=BigInt(Number.MAX_SAFE_INTEGER),ri=BigInt(Number.MIN_SAFE_INTEGER);function yn(e,t){const n=t?"return":"throw",s=new Map,i=function(o){var l,a,f;const r=typeof o=="function"?v.Struct:(l=o==null?void 0:o.constructor)==null?void 0:l[G];if(r===void 0){if(t){if(typeof o=="bigint"&&ri<=o&&o<=oi)return Number(o);if(o instanceof Error)return{error:o.message}}return o}let c=s.get(o);if(c===void 0){let u;switch(r){case v.Struct:case v.PackedStruct:case v.ExternStruct:case v.TaggedUnion:case v.BareUnion:case v.ExternUnion:u=(a=o[wt])==null?void 0:a.call(o,{error:n}),c=o.constructor[Xe]?[]:{};break;case v.Array:case v.Vector:case v.Slice:u=(f=o[wt])==null?void 0:f.call(o,{error:n}),c=[];break;case v.SinglePointer:case v.SlicePointer:case v.MultiPointer:case v.CPointer:try{c=o["*"]}catch{c=Symbol.for("inaccessible")}break;case v.Enum:c=Wt(()=>String(o),{error:n});break;case v.Opaque:c={};break;default:c=Wt(()=>o.$,{error:n})}if(c=i(c),s.set(o,c),u)for(const[d,b]of u)c[d]=i(b)}return c};return i(e)}function Wt(e,t={}){const{error:n="throw"}=t;try{return e()}catch(s){if(n==="return")return s;throw s}}function ut(e,t={}){return se({get(){return this[U](),this[g]},set(n,s){Ds(n),Ft.call(this,n,e,!0,s,t)}})}function ht(e,t={}){return se({get(){return si(this.dataView)},set(n,s){if(typeof n!="string")throw new Yt("string",n);const i=ii(n);Ft.call(this,i,e,!1,s,t)}})}function pn(e,t={}){const{sentinel:n,instance:{members:s}}=e,{byteSize:i}=s[0];return se({get(){const o=this.dataView,r=i===1?Int8Array:Int16Array,c=new r(o.buffer,o.byteOffset,this.length);let l=jt(c,`utf-${i*8}`);return(n==null?void 0:n.value)!==void 0&&l.charCodeAt(l.length-1)===n.value&&(l=l.slice(0,-1)),l},set(o,r){if(typeof o!="string")throw new Yt("a string",o);(n==null?void 0:n.value)!==void 0&&o.charCodeAt(o.length-1)!==n.value&&(o=o+String.fromCharCode(n.value));const c=ni(o,`utf-${i*8}`),l=new DataView(c.buffer);Ft.call(this,l,e,!1,r,t)}})}function It(e,t={}){const{typedArray:n}=e;return se({get(){const s=this.dataView,i=s.byteLength/n.BYTES_PER_ELEMENT;return new n(s.buffer,s.byteOffset,i)},set(s,i){if(!Cs(s,n))throw new Yt(n.name,s);const o=new DataView(s.buffer,s.byteOffset,s.byteLength);Ft.call(this,o,e,!0,i,t)}})}function se({get:e,set:t}){return e.special=t.special=!0,{get:e,set:t}}let rt,Lt;function bn(e,t){const{name:n,byteSize:s,align:i,instance:{members:[o]}}=e;if(Lt||(Lt=class extends ai{},rt=bn({...e,name:"anyerror"},t)),rt&&n==="anyerror")return e.constructor=rt,e.typedArray=At(o),rt;const r=Lt,{get:c,set:l}=N(o,t),a=["string","number"],f=ft(e),u=function(w){if(w instanceof b[$t])l.call(this,w);else if(w&&typeof w=="object"&&!Ct(w)){if(f.call(this,w)===0)throw new mt(e,a,w)}else w!==void 0&&l.call(this,w)},d=function(w){if(typeof w=="number"||typeof w=="string")return b[w];if(w instanceof b[$t])return b[Number(w)];if(Ct(w))return b[`Error: ${w.error}`];if(te(e,w,t))return!1;throw new mt(e,a,w)},b=e.constructor=it(e,{initializer:u,alternateCaster:d},t),m=e.typedArray=At(o),h={$:{get:c,set:l},dataView:ut(e),base64:ht(e),typedArray:m&&It(e),valueOf:{value:Z},toJSON:{value:tt},delete:{value:lt(t)},[j]:{value:H(s)},[q]:{value:Tt}},p={[_]:{value:i},[J]:{value:s},[$t]:{value:r},[gt]:n==="anyerror"?{value:[]}:void 0,[G]:{value:e.type}};return st(b,h,p,t)}function ci(e,t,n){const s=n[Kt]("number");let i=rt[s];if(!i){const c=e[$t];i=new c(t,s)}const o=String(i),r={[s]:{value:i},[o]:{value:i},[t]:{value:i}};L(e,r),L(rt,r),rt[gt].push(t)}function li(){Lt=rt=void 0}class ai extends Error{constructor(t,n){super(Je(t)),this.number=n,this.stack=void 0}[Symbol.toPrimitive](t){switch(t){case"string":case"default":return Error.prototype.toString.call(this,t);default:return this.number}}toJSON(){return{error:this.message}}}function fi(e,t){const n=(s,{methods:i},o)=>{const r={},c=/^(get|set)\s+([\s\S]+)/;for(const l of i){const a=t.createCaller(l,o),f=c.exec(a.name);if(f){const u=f[1],d=f[2],b=u==="get"?0:1;if(ui(l,o)===b){let h=r[d];h||(h=r[d]={configurable:!0,enumerable:!0}),h[u]=a}}else r[a.name]={value:a,configurable:!0,writable:!0}}L(s,r)};n(e.constructor,e.static,!1),n(e.constructor.prototype,e.instance,!0)}function ui(e,t){const{argStruct:{instance:{members:n}}}=e;return n.length-(t?2:1)}function hi(e,t){const{byteSize:n,align:s,instance:{members:[i]}}=e,{get:o,set:r}=N(i,t),c=["string","number","tagged union"],l=ft(e),a=function(p){if(p&&typeof p=="object"){if(l.call(this,p)===0)throw new mt(e,c,p)}else p!==void 0&&r.call(this,p)},f=function(p){if(typeof p=="string"||typeof p=="number"||typeof p=="bigint"){let w=u[p];return w||u[en]&&typeof p!="string"&&(w=new u(void 0),r.call(w,p,"number"),mn(u,`${p}`,w)),w}else{if(p instanceof u)return p;if((p==null?void 0:p[ke])instanceof u)return p[ke];if(te(e,p,t))return!1;throw new mt(e,c,p)}},u=e.constructor=it(e,{initializer:a,alternateCaster:f},t),d=e.typedArray=At(i),b=function(p){switch(p){case"string":case"default":return this.$[Ke];default:return o.call(this,"number")}},m={$:{get:o,set:r},dataView:ut(e),base64:ht(e),typedArray:d&&It(e),valueOf:{value:Z},toString:{value:Z},toJSON:{value:tt},delete:{value:lt(t)},[Symbol.toPrimitive]:{value:b},[j]:{value:H(n)},[q]:{value:Tt}},h={[_]:{value:s},[J]:{value:n},[G]:{value:e.type}};return st(u,m,h,t)}function mn(e,t,n){if(t!==void 0){if(n instanceof e){L(n,{[Ke]:{value:t}});const s=n[Symbol.toPrimitive]();L(e,{[s]:{value:n},[t]:{value:n}})}}else L(e,{[en]:{value:!0}})}function gn(e,t){const{name:n,type:s,byteSize:i,align:o,instance:{members:[r]},isConst:c}=e,{runtimeSafety:l=!0}=t,{structure:a}=r,{type:f,sentinel:u,byteSize:d=1}=a,b=s===v.SlicePointer,m=b?i/2:i,{get:h,set:p}=N({type:x.Uint,bitOffset:0,bitSize:m*8,byteSize:m,structure:{byteSize:m}},t),{get:w,set:S}=b?N({type:x.Uint,bitOffset:m*8,bitSize:m*8,byteSize:m,structure:{name:"usize",byteSize:m}},t):{},M=function(y=!0,O=!0){if(y||this[g][D])if(O){const C=h.call(this),W=b?w.call(this):u!=null&&u.isRequired?t.findSentinel(C,u.bytes)+1:1;if(C!==this[Ut]||W!==this[pt]){const z=a.constructor,F=t.findMemory(C,W,z[J]),ot=F?z.call(Dt,F):null;return this[I][0]=ot,this[Ut]=C,this[pt]=W,b&&(this[Rt]=void 0),ot}}else return this[I][0]=void 0;return this[I][0]},E=function(y){p.call(this,y),this[Ut]=y},T=b||u?function(y){var O;(O=S==null?void 0:S.call)==null||O.call(S,this,y),this[pt]=y}:null,B=function(){const y=this[St]??this,O=M.call(y,!1);if(!O){if(s===v.CPointer)return null;throw new Jn}return c?wn(O):O},V=function(y){if(y===void 0)return;const O=this[St]??this;if(y){if(y[g][D]){const C=t.getViewAddress(y[g]);E.call(this,C),b&&T.call(this,y.length)}else if(O[g][D])throw new Yn(e,y)}else O[g][D]&&(E.call(this,0),b&&T.call(this,0));O[I][0]=y??null,b&&(O[Rt]=void 0)},Et=Ae(a)?function(){return B.call(this)[Kt]()}:B,ie=c?Ot:function(y){return B.call(this)[Xt](y)},xt=function(){const y=B.call(this);return y?y.length:0},oe=function(y){y=y|0;const O=B.call(this);if(!O){if(y!==0)throw new Me(y,0);return}const C=O[g],W=C[D],z=C.buffer.byteLength-C.byteOffset;let F;if(W||(b?(F=this[Rt],F===void 0&&(F=this[Rt]=O.length)):F=z/d|0),y<0||y>F)throw new Me(y,F);const ot=y*d,ce=ot<=z?t.obtainView(C.buffer,C.byteOffset,ot):t.obtainFixedView(W.address,ot),Vt=a.constructor;this[I][0]=Vt.call(Dt,ce),b&&(T==null||T.call(this,y))},re=function(y,O){const C=a.constructor;if(this===Dt||this===ge||y instanceof et)return!1;if(be(y,C))return new et(C(y["*"]),O);if(Re(y,C,s))return new et(y);if(f===v.Slice)return new et(C(y),O);throw new Wn(e)},A=function(){const y=Pe(f)?{}:mi,O=new Proxy(this,y);return Object.defineProperty(this,Qt,{value:O}),O},$=function(y){var C,W;const O=a.constructor;if(be(y,O)){if(!c&&y.constructor.const)throw new Gn(e,y);y=y[I][0]}else if(s!=v.SinglePointer)Re(y,O,s)&&(y=O(y[I][0][g]));else if(n==="*anyopaque"&&y){if(Pe(y.constructor[G]))y=(C=y["*"])==null?void 0:C[g];else if(y[g])y=y[g];else if((y==null?void 0:y.buffer)instanceof ArrayBuffer&&!(y instanceof Uint8Array||y instanceof DataView)){const{byteOffset:z,byteLength:F}=y;z!==void 0&&F!==void 0&&(y=new DataView(y.buffer,z,F))}}if(y instanceof O){y[U]();const z=y[vt];if(z)if(c)y=z;else throw new Qn(e)}else if(s===v.CPointer&&y instanceof O.child)y=O(y[g]);else if(ks(y,O)){const z=te(a,y,t);y=O(z)}else if(y!=null&&!y[g]){if(s===v.CPointer&&typeof y=="object"&&!y[Symbol.iterator]){let F=!0;const ot=O.prototype[Zt];for(const ce of Object.keys(y)){const Vt=ot[ce];if(Vt!=null&&Vt.special){F=!1;break}}F&&(y=[y])}const z=new O(y,{fixed:!!this[g][D]});if(l&&a.typedArray){const F=(W=y==null?void 0:y.buffer)==null?void 0:W[Symbol.toStringTag];(F==="ArrayBuffer"||F==="SharedArrayBuffer")&&es(a,y)}y=z}else if(y!==void 0&&(s!==v.CPointer||y!==null))throw new Hn(e,y);this[he](y)},R=f===v.Primitive?function(y){return this[K]()[Symbol.toPrimitive](y)}:null,Q=f===v.Slice?function(y,O){const W=this[K]().slice(y,O);return new et(W)}:null,dt=f===v.Slice?function(y,O,C){const z=this[K]().subarray(y,O,C);return new et(z)}:null,et=e.constructor=it(e,{initializer:$,alternateCaster:re,finalizer:A},t),Bt={"*":{get:Et,set:ie},$:{get:xe,set:$},length:{get:xt,set:oe},valueOf:{value:Z},toJSON:{value:tt},delete:{value:yi},slice:Q&&{value:Q},subarray:dt&&{value:dt},[Symbol.toPrimitive]:R&&{value:R},[K]:{value:B},[he]:{value:V},[Ze]:{value:M},[de]:{value:E},[ye]:T&&{value:T},[k]:{value:bi},[j]:{value:H(i)},[q]:{value:di},[Ut]:{value:void 0,writable:!0},[pt]:T&&{value:void 0,writable:!0}},Mn={child:{get:()=>a.constructor},const:{value:c},[_]:{value:o},[J]:{value:i},[G]:{value:e.type}};return st(et,Bt,Mn,t)}function di(){const e=this[St],t=Object.getOwnPropertyDescriptor(e.constructor.prototype,"$");t.set=Ot,Object.defineProperty(e,"$",t),Object.defineProperty(e,vt,{value:e})}function yi(){const e=this[K]();e==null||e.delete()}function xe(){return this[Qt]}function pi({isActive:e}){this[I][0]&&!e(this)&&(this[I][0]=void 0)}function bi(e,t={}){const{source:n,isActive:s=nt,isMutable:i=nt}=t;e.call(this,{source:n,isActive:s,isMutable:i})}function be(e,t){var n;return((n=e==null?void 0:e.constructor)==null?void 0:n.child)===t&&e["*"]}function Re(e,t,n){var s,i;if(n!==v.SinglePointer){if(((i=(s=e==null?void 0:e.constructor)==null?void 0:s.child)==null?void 0:i.child)===t.child&&e["*"])return!0;if(n===v.CPointer&&be(e,t.child))return!0}return!1}function wn(e){let t=e[le];return t||(Object.defineProperty(e,le,{value:void 0,configurable:!0}),t=new Proxy(e,gi),Object.defineProperty(e,le,{value:t})),t}const mi={get(e,t){return t===St?e:t in e?e[t]:e[K]()[t]},set(e,t,n){if(t in e)e[t]=n;else{const s=e[K]();s[t]=n}return!0},deleteProperty(e,t){if(t in e)delete e[t];else{const n=e[K]();delete n[t]}return!0},has(e,t){if(t in e)return!0;{const n=e[K]();return t in n}}},gi={get(e,t){if(t===vt)return e;{const n=e[t];return(n==null?void 0:n[vt])===null?wn(n):n}},set(e,t,n){const s=e[St];return s&&!(t in s)?e[t]=n:Ot(),!0}};function nt(){return!0}function wi(e,t){const{length:n,byteSize:s,align:i,instance:{members:[o]}}=e,{bitSize:r,structure:c}=o,l={};for(let h=0,p=0;h<n;h++,p+=r){const{get:w,set:S}=N({...o,bitOffset:p},t);l[h]={get:w,set:S,configurable:!0}}const a=ft(e),f=function(h){if(h instanceof u)this[j](h);else if(h!=null&&h[Symbol.iterator]){let p=h.length;if(typeof p!="number"&&(h=[...h],p=h.length),p!==n)throw new Ht(e,this,h);let w=0;for(const S of h)this[Zt][w++].call(this,S)}else if(h&&typeof h=="object"){if(a.call(this,h)===0)throw new bt(e,h)}else if(h!==void 0)throw new bt(e,h)},u=e.constructor=it(e,{initializer:f},t),d=e.typedArray=At(o),b={...l,$:{get:dn,set:f},length:{value:n},dataView:ut(e),base64:ht(e),typedArray:d&&It(e),valueOf:{value:Z},toJSON:{value:tt},entries:{value:Gt},delete:{value:lt(e)},[Symbol.iterator]:{value:Sn},[wt]:{value:Gt},[j]:{value:H(s)},[q]:{value:Tt}},m={child:{get:()=>c.constructor},[_t]:{value:ee(e)},[_]:{value:i},[J]:{value:s},[G]:{value:e.type}};return st(u,b,m,t)}function Sn(){const e=this,t=this.length;let n=0;return{next(){let s,i;if(n<t){const o=n++;s=e[o],i=!1}else i=!0;return{value:s,done:i}}}}function Si(){const e=this,t=this.length;let n=0;return{next(){let s,i;if(n<t){const o=n++;s=[o,e[o]],i=!1}else i=!0;return{value:s,done:i}}}}function Gt(){return{[Symbol.iterator]:Si.bind(this),length:this.length}}function vi(e,t){const{byteSize:n,align:s,instance:{members:i},isTuple:o,isIterator:r,hasPointer:c}=e,l={},a=i.filter(T=>!!T.name),f=i.find(T=>!T.name);for(const T of a){const{get:B,set:V}=N(T,t);l[T.name]={get:B,set:V,configurable:!0,enumerable:!0},T.isRequired&&V&&(V.required=!0)}const u=f?N(f,t):null,d=!!i.find(T=>T.type===x.Object),b=ft(e),m=function(T){if(T instanceof h)this[j](T),c&&this[k](zt,{vivificate:!0,source:T});else if(T&&typeof T=="object")b.call(this,T);else if((typeof T=="number"||typeof T=="bigint")&&u)u.set.call(this,T);else if(T!==void 0)throw new mt(e,"object",T)},h=e.constructor=it(e,{initializer:m},t),p=u?function(T){switch(T){case"string":return Object.prototype.toString.call(this);default:return u.get.call(this)}}:null,w=o&&i.length>0?parseInt(i[i.length-1].name)+1:0,S=r?Ai:o?Sn:vn,M={$:{get:dn,set:m},dataView:ut(e),base64:ht(e),length:o&&{value:w},valueOf:{value:Z},toJSON:{value:tt},delete:{value:lt(t)},entries:o&&{value:Gt},...l,[Symbol.iterator]:{value:S},[Symbol.toPrimitive]:u&&{value:p},[wt]:{value:o?Gt:Oe},[j]:{value:H(n)},[X]:d&&{value:Ie(e,t)},[k]:c&&{value:Ve(e,nt)},[q]:{value:Tt},[gt]:{value:a.map(T=>T.name)}},E={[_]:{value:s},[J]:{value:n},[G]:{value:e.type},[Xe]:{value:o}};return st(h,M,E,t)}function Oe(e){return{[Symbol.iterator]:Ti.bind(this,e),length:this[gt].length}}function Ai(){const e=this;return{next(){const t=e.next();return{value:t,done:t===null}}}}function vn(e){return Oe.call(this,e)[Symbol.iterator]()}function Ti(e){const t=this,n=this[gt];let s=0;return{next(){let i,o;if(s<n.length){const r=n[s++];i=[r,Wt(()=>t[r],e)],o=!1}else o=!0;return{value:i,done:o}}}}function Ie(e,t){const{instance:{members:n}}=e,s={};for(const i of n.filter(o=>o.type===x.Object))s[i.slot]=i;return function(o){const r=s[o],{bitOffset:c,byteSize:l,structure:{constructor:a}}=r,f=this[g],d=f.byteOffset+(c>>3);let b=l;if(b===void 0){if(c&7)throw new Xn(r);b=r.bitSize>>3}const m=t.obtainView(f.buffer,d,b);return this[I][o]=a.call(ge,m)}}function Ve(e,t={}){const{isChildActive:n=nt,isChildMutable:s=nt}=t,{instance:{members:i}}=e,o=i.filter(r=>{var c;return(c=r.structure)==null?void 0:c.hasPointer});return function(c,l={}){var m;const{source:a,vivificate:f=!1,isActive:u=nt,isMutable:d=nt}=l,b={...l,isActive:h=>u(this)&&n.call(this,h),isMutable:h=>d(this)&&s.call(this,h)};for(const{slot:h}of o){if(a){const w=(m=a[I])==null?void 0:m[h];if(!w)continue;b.source=w}const p=this[I][h]??(f?this[X](h):null);p&&p[k](c,b)}}}function Ei(e,t){const{type:n,constructor:s,static:{members:i,template:o}}=e,r={};for(const c of i)r[c.name]=N(c,t);if(L(s,{valueOf:{value:Z},toJSON:{value:tt},...r,[Symbol.iterator]:{value:vn},[wt]:{value:Oe},[I]:o&&{value:o[I]},[gt]:!s[gt]&&{value:i.map(c=>c.name)}}),n===v.Enum)for(const{name:c,slot:l}of i)mn(s,c,s[I][l]);else if(n===v.ErrorSet)for(const{name:c,slot:l}of i)ci(s,c,s[I][l])}function xi(e,t){const{byteSize:n,align:s,instance:{members:i},hasPointer:o}=e,r=!!i.find(m=>m.type===x.Object),c=i.slice(1).map(m=>m.name),l=c.length,a=e.constructor=function(m,h,p){const w=t.allocateMemory(n,s);if(this[g]=w,r&&(this[I]={}),m.length!==l)throw new Ln(h,l-p,m.length-p);for(const[S,M]of c.entries())try{this[M]=m[S]}catch(E){throw ts(h,S-p,l-p,E)}},f={};for(const m of i)f[m.name]=N(m,t);const{slot:u,type:d}=i[0],b=d===x.Object?function(m){const h=this[X](u);return m===h}:function(){return!1};return L(a.prototype,{...f,[j]:{value:H(n)},[X]:r&&{value:Ie(e,t)},[k]:o&&{value:Ve(e,{isChildMutable:b})},[U]:{value:Ee(null,t)}}),L(a,{[_]:{value:s},[J]:{value:n}}),a}function Oi(e,t){const{length:n,byteSize:s,align:i,instance:{members:[o]},hasPointer:r}=e,{get:c,set:l}=N(o,t),a=En(o),f=ft(e),u=function(S){if(S instanceof b)this[j](S),r&&this[k](zt,{vivificate:!0,source:S});else if(typeof S=="string"&&a&&(S={string:S}),S!=null&&S[Symbol.iterator]){if(S=Vn(S),S.length!==n)throw new Ht(e,this,S);let M=0;for(const E of S)l.call(this,M++,E)}else if(S&&typeof S=="object"){if(f.call(this,S)===0)throw new bt(e,S)}else if(S!==void 0)throw new bt(e,S)},d=An,b=e.constructor=it(e,{initializer:u,finalizer:d},t),m=e.typedArray=At(o),h=o.type===x.Object,p={$:{get:xe,set:u},length:{value:n},dataView:ut(e),base64:ht(e),string:a&&pn(e),typedArray:m&&It(e),get:{value:c},set:{value:l},entries:{value:qt},valueOf:{value:Z},toJSON:{value:tt},delete:{value:lt(t)},[Symbol.iterator]:{value:xn},[wt]:{value:qt},[j]:{value:H(s)},[X]:h&&{value:On(e,t)},[k]:r&&{value:In()},[q]:{value:Tn}},w={child:{get:()=>o.structure.constructor},[_t]:{value:ee(e)},[_]:{value:i},[J]:{value:s},[G]:{value:e.type}};return st(b,p,w,t)}function An(){const e=new Proxy(this,Vi);return Object.defineProperty(this,Qt,{value:e}),e}function Tn(){Tt.call(this),Object.defineProperty(this,"set",{value:Ot});const e=this.get;Object.defineProperty(this,"get",{value:function(n){var i;const s=e.call(this,n);return(s==null?void 0:s[vt])===null&&((i=s[q])==null||i.call(s)),s}})}function En(e){return e.type===x.Uint&&[8,16].includes(e.bitSize)}function xn(){const e=this[we]??this,t=this.length;let n=0;return{next(){let s,i;if(n<t){const o=n++;s=e.get(o),i=!1}else i=!0;return{value:s,done:i}}}}function Ii(e){const t=this[we]??this,n=this.length;let s=0;return{next(){let i,o;if(s<n){const r=s++;i=[r,Wt(()=>t.get(r),e)],o=!1}else o=!0;return{value:i,done:o}}}}function qt(e){return{[Symbol.iterator]:Ii.bind(this,e),length:this.length}}function On(e,t){const{instance:{members:[n]}}=e,{byteSize:s,structure:i}=n;return function(r){const{constructor:c}=i,l=this[g],f=l.byteOffset+s*r,u=t.obtainView(l.buffer,f,s);return this[I][r]=c.call(ge,u)}}function In(e){return function(n,s={}){const{source:i,vivificate:o=!1,isActive:r=nt,isMutable:c=nt}=s,l={...s,isActive:()=>r(this),isMutable:()=>c(this)};for(let a=0,f=this.length;a<f;a++){i&&(l.source=i==null?void 0:i[I][a]);const u=this[I][a]??(o?this[X](a):null);u&&u[k](n,l)}}}function Vn(e){var i;if(typeof e.length=="number")return e;const t=e[Symbol.iterator](),n=t.next(),s=(i=n.value)==null?void 0:i.length;if(typeof s=="number"&&Object.keys(n.value).join()==="length")return Object.assign(function*(){let o;for(;!(o=t.next()).done;)yield o.value}(),{length:s});{const o=[];let r=n;for(;!r.done;)o.push(r.value),r=t.next();return o}}const Vi={get(e,t){const n=typeof t=="symbol"?0:t|0;if(n!==0||n==t)return e.get(n);switch(t){case"get":return e[Pt]||(e[Pt]=e.get.bind(e)),e[Pt];case"set":return e[Mt]||(e[Mt]=e.set.bind(e)),e[Mt];case we:return e;default:return e[t]}},set(e,t,n){const s=typeof t=="symbol"?0:t|0;if(s!==0||s==t)e.set(s,n);else switch(t){case"get":e[Pt]=n;break;case"set":e[Mt]=n;break;default:e[t]=n}return!0},deleteProperty(e,t){const n=typeof t=="symbol"?0:t|0;if(n!==0||n==t)return!1;switch(t){case"get":delete e[Pt];break;case"set":delete e[Mt];break;default:delete e[t]}return!0},has(e,t){const n=typeof t=="symbol"?0:t|0;return n!==0||n==t?n>=0&&n<e.length:e[t]},ownKeys(e){const t=[];for(let n=0,s=e.length;n<s;n++)t.push(`${n}`);return t.push("length",Qt),t},getOwnPropertyDescriptor(e,t){const n=typeof t=="symbol"?0:t|0;if(n!==0||n==t){if(n>=0&&n<e.length)return{value:e.get(n),enumerable:!0,writable:!0,configurable:!0}}else return Object.getOwnPropertyDescriptor(e,t)}};function Pi(e,t){const{byteSize:n,align:s,instance:{members:i},hasPointer:o}=e,{get:r,set:c}=N(i[0],t),{get:l,set:a}=N(i[1],t),f=function(){if(l.call(this,"number"))throw l.call(this);return r.call(this)},u=i[0].type===x.Void,d=i[1].structure.constructor,b=function(){return!l.call(this,"number")},m=function(){var V;this[_e](),(V=this[k])==null||V.call(this,pi)},h=!!i.find(V=>V.type===x.Object),p=ft(e),w=function(V){if(V instanceof S)this[j](V),o&&b.call(this)&&this[k](zt,{vivificate:!0,source:V});else if(V instanceof d[$t]&&d(V))a.call(this,V),m.call(this);else if(V!==void 0||u)try{c.call(this,V),a.call(this,0,"number")}catch(Et){if(V instanceof Error)throw new Ge(e);if(Ct(V))a.call(this,V),m.call(this);else if(V&&typeof V=="object"){if(p.call(this,V)===0)throw Et}else throw Et}},S=e.constructor=it(e,{initializer:w},t),{bitOffset:M,byteSize:E}=i[0],T={$:{get:f,set:w},dataView:ut(e),base64:ht(e),valueOf:{value:Z},toJSON:{value:tt},delete:{value:lt(t)},[j]:{value:H(n)},[_e]:{value:ms(M/8,E)},[X]:h&&{value:Ie(e,t)},[k]:o&&{value:Ve(e,{isChildActive:b})},[q]:{value:Tt}},B={[_]:{value:s},[J]:{value:n},[G]:{value:e.type}};return st(S,T,B,t)}function Mi(e,t){const{byteSize:n,align:s,instance:{members:[i]}}=e,{get:o,set:r}=N(i,t),c=ft(e),l=function(b){if(b instanceof a)this[j](b);else if(b&&typeof b=="object"){if(c.call(this,b)===0){const m=Le(i);throw new mt(e,m,b)}}else b!==void 0&&r.call(this,b)},a=e.constructor=it(e,{initializer:l},t),f=e.typedArray=At(i),u={$:{get:o,set:r},dataView:ut(e),base64:ht(e),typedArray:f&&It(e),valueOf:{value:Z},toJSON:{value:tt},delete:{value:lt(t)},[Symbol.toPrimitive]:{value:o},[j]:{value:H(n)},[q]:{value:Tt}},d={[_t]:{value:ee(e)},[_]:{value:s},[J]:{value:n},[ns]:{value:i.bitSize},[G]:{value:e.type},[is]:{value:i.type}};return st(a,u,d,t)}function $i(e,t){const{align:n,instance:{members:[s]},byteSize:i,hasPointer:o}=e,{get:r,set:c}=N(s,t),{byteSize:l,structure:a}=s,f=Di(e,t);f&&(e.sentinel=f);const u=En(s),d=function(A,$,R=!1){A||(A=t.allocateMemory($*l,n,R)),this[g]=A,this[pt]=$},b=function(A,$){if($!==this[pt])throw new Ht(e,this,A)},m=ft(e),h=function(A,$=!1){if(A instanceof V)this[g]?b.call(this,A,A.length):d.call(this,null,A.length,$),this[j](A),o&&this[k](zt,{vivificate:!0,source:A});else if(typeof A=="string"&&u)h.call(this,{string:A},$);else if(A!=null&&A[Symbol.iterator]){A=Vn(A),this[g]?b.call(this,A,A.length):d.call(this,null,A.length,$);let R=0;for(const Q of A)f==null||f.validateValue(Q,R,A.length),c.call(this,R++,Q)}else if(typeof A=="number")if(!this[g]&&A>=0&&isFinite(A))d.call(this,null,A,$);else throw new bt(e,A,!this[g]);else if(A&&typeof A=="object"){if(m.call(this,A,$)===0)throw new bt(e,A)}else if(A!==void 0)throw new bt(e,A)},p=function(){return this[pt]},w=function(A,$){return A=A|0,A<0?(A=$+A,A<0&&(A=0)):A>$&&(A=$),A};function S(A,$){A=A===void 0?0:w(A,this.length),$=$===void 0?this.length:w($,this.length);const R=this[g],Q=A*l,dt=$*l-Q;return t.obtainView(R.buffer,R.byteOffset+Q,dt)}function M(A,$){const R=S.call(this,A,$);return V(R)}const E=function(A,$,R={}){const{fixed:Q=!1}=R,dt=S.call(this,A,$),et=t.allocateMemory(dt.byteLength,n,Q),Bt=V(et);return B.call(Bt,{[g]:dt}),Bt},T=An,B=H(l,!0),V=e.constructor=it(e,{initializer:h,shapeDefiner:d,finalizer:T},t),Et=e.typedArray=At(s),ie=s.type===x.Object,xt={shapeDefiner:d},oe={$:{get:xe,set:h},length:{get:p},dataView:ut(e,xt),base64:ht(e,xt),string:u&&pn(e,xt),typedArray:Et&&It(e,xt),get:{value:r},set:{value:c},entries:{value:qt},slice:{value:E},subarray:{value:M},valueOf:{value:Z},toJSON:{value:tt},delete:{value:lt(t)},[Symbol.iterator]:{value:xn},[wt]:{value:qt},[j]:{value:B},[X]:ie&&{value:On(e,t)},[k]:o&&{value:In()},[q]:{value:Tn}},re={child:{get:()=>a.constructor},[_t]:{value:ee(e)},[_]:{value:n},[J]:{value:i},[G]:{value:e.type}};return st(V,oe,re,t)}function Di(e,t){const{runtimeSafety:n=!0}=t,{byteSize:s,instance:{members:[i,o],template:r}}=e;if(!o)return;const{get:c}=N(o,t),l=c.call(r,0),{get:a}=N(i,t),{isRequired:f}=o,u=f?n?function(m,h,p){if(m===l&&h!==p-1)throw new $e(e,m,h,p);if(m!==l&&h===p-1)throw new Nt(e,l,h,p)}:function(m,h,p){if(m!==l&&h===p-1)throw new Nt(e,l,p)}:function(){},d=f?n?function(m,h){for(let p=0;p<h;p++){const w=a.call(m,p);if(w===l&&p!==h-1)throw new $e(e,l,p,h);if(w!==l&&p===h-1)throw new Nt(e,l,h)}}:function(m,h){if(h*s===m[g].byteLength){const p=h-1;if(a.call(m,p)!==l)throw new Nt(e,l,h)}}:function(){},b=r[g];return{value:l,bytes:b,validateValue:u,validateData:d,isRequired:f}}const Y=Array(Object.values(v).length);function Yi(){Y[v.Primitive]=Mi}function Ki(){Y[v.Array]=Oi}function Xi(){Y[v.Struct]=vi}function Zi(){Y[v.ArgStruct]=xi}function Qi(){Y[v.ErrorUnion]=Pi}function to(){Y[v.ErrorSet]=bn,Us()}function eo(){Y[v.Enum]=hi,Rs()}function no(){Y[v.SinglePointer]=gn,ln()}function so(){Y[v.SlicePointer]=gn,ln()}function io(){Y[v.Slice]=$i}function oo(){Y[v.Vector]=wi}function ji(e){return Y[e]}class Ci{constructor(){P(this,"context");P(this,"contextStack",[]);P(this,"consolePending",[]);P(this,"consoleTimeout",0);P(this,"viewMap",new WeakMap);P(this,"emptyBuffer",new ArrayBuffer(0));P(this,"abandoned",!1);P(this,"released",!1);P(this,"littleEndian",!0);P(this,"wordSize",4);P(this,"runtimeSafety",!0);P(this,"comptime",!1);P(this,"variables",[]);P(this,"imports");P(this,"console",globalThis.console)}startContext(){this.context&&this.contextStack.push(this.context),this.context=new ki}endContext(){this.context=this.contextStack.pop()}allocateMemory(t,n=0,s=!1){return s?this.allocateFixedMemory(t,n):this.allocateRelocMemory(t,n)}allocateFixedMemory(t,n,s=fe.Normal){const i=t?this.allocateExternMemory(s,t,n):0,o=this.obtainFixedView(i,t);return o[D].align=n,o[D].type=s,o}freeFixedMemory(t){const{address:n,unalignedAddress:s,len:i,align:o,type:r}=t[D];i&&this.freeExternMemory(r,s??n,i,o)}obtainFixedView(t,n){let s;if(t&&n)s=this.obtainExternView(t,n);else{let i=this.viewMap.get(this.emptyBuffer);i||this.viewMap.set(this.emptyBuffer,i={});const o=`${t}:0`;s=i[o],s||(s=i[o]=new DataView(this.emptyBuffer),s[D]={address:t,len:0})}return s}releaseFixedView(t){var n;((n=t[D])==null?void 0:n.type)!==void 0&&(this.freeFixedMemory(t),t[D]=null)}allocateRelocMemory(t,n){return this.obtainView(new ArrayBuffer(t),0,t)}registerMemory(t,n=null,s=void 0){const{memoryList:i}=this.context,o=this.getViewAddress(t),r=ae(i,o);return i.splice(r,0,{address:o,dv:t,len:t.byteLength,targetDV:n,targetAlign:s}),o}unregisterMemory(t){const{memoryList:n}=this.context,s=ae(n,t),i=n[s-1];if((i==null?void 0:i.address)===t)return n.splice(s-1,1),i.dv}findMemory(t,n,s){if(zi(t))if(!n)t=0;else return null;else if(!t&&n)return null;let i=n*(s??0);if(this.context){const{memoryList:o}=this.context,r=ae(o,t),c=o[r-1];if((c==null?void 0:c.address)===t&&c.len===i)return c.targetDV??c.dv;if((c==null?void 0:c.address)<=t&&t<yt(c.address,c.len)){const l=Number(t-c.address),a=c.targetDV??c.dv,f=s===void 0;f&&(i=a.byteLength-l);const u=this.obtainView(a.buffer,a.byteOffset+l,i);return f&&(u[_]=c.targetAlign),u}}return this.obtainFixedView(t,i)}getViewAddress(t){const n=t[D];if(n)return n.address;{const s=this.getBufferAddress(t.buffer);return yt(s,t.byteOffset)}}findViewAt(t,n,s){let i=this.viewMap.get(t),o;if(i)if(i instanceof DataView)if(i.byteOffset===n&&i.byteLength===s)o=i;else{const r=i;i={[`${r.byteOffset}:${r.byteLength}`]:r},this.viewMap.set(t,i)}else o=i[`${n}:${s}`];return{existing:o,entry:i}}obtainView(t,n,s){const{existing:i,entry:o}=this.findViewAt(t,n,s);let r;if(i)return i;o?r=o[`${n}:${s}`]=new DataView(t,n,s):this.viewMap.set(t,r=new DataView(t,n,s));const c=t[D];return c&&(r[D]={address:yt(c.address,n),len:s}),r}registerView(t){if(!t[D]){const{buffer:n,byteOffset:s,byteLength:i}=t,{existing:o,entry:r}=this.findViewAt(n,s,i);if(o)return o;r?r[`${s}:${i}`]=t:this.viewMap.set(n,t)}return t}captureView(t,n,s){if(s){const i=this.allocateRelocMemory(n,0);return n>0&&this.copyBytes(i,t,n),i}else return this.obtainFixedView(t,n)}castView(t,n,s,i){const{constructor:o,hasPointer:r}=i,c=this.captureView(t,n,s),l=o.call(Dt,c);return r&&this.updatePointerTargets(l),s&&l[q](),l}finalizeShape(t){const s=ji(t.type)(t,this);typeof s=="function"&&(L(s,{name:{value:t.name,configurable:!0}}),s.prototype.hasOwnProperty(Symbol.toStringTag)||L(s.prototype,{[Symbol.toStringTag]:{value:t.name,configurable:!0}}))}finalizeStructure(t){Ei(t,this),fi(t,this)}createCaller(t,n){const{name:s,argStruct:i,thunkId:o}=t,{constructor:r}=i,c=this;let l;return n?l=function(...a){return c.invokeThunk(o,new r([this,...a],s,1))}:l=function(...a){return c.invokeThunk(o,new r(a,s,0))},Object.defineProperty(l,"name",{value:s}),l}recreateStructures(t,n){Object.assign(this,n);const s=(r,c)=>{for(const[l,a]of Object.entries(c))r[l]=i(a);return r},i=r=>{var f;const{memory:c,structure:l,actual:a}=r;if(c){if(a)return a;{const{array:u,offset:d,length:b}=c,m=this.obtainView(u.buffer,d,b),{constructor:h}=l,{reloc:p,const:w}=r,S=r.actual=h.call(Dt,m);return w&&((f=S[q])==null||f.call(S)),r.slots&&s(S[I],r.slots),p!==void 0&&this.variables.push({reloc:p,object:S}),S}}else return l};li();const o=new Map;for(const r of t){for(const c of[r.instance,r.static])if(c.template){const l=c.template,a=c.template={};if(l.memory){const{array:f,offset:u,length:d}=l.memory;a[g]=this.obtainView(f.buffer,u,d)}if(l.slots){const f=a[I]={};o.set(f,l.slots)}}this.finalizeShape(r)}for(const[r,c]of o)s(r,c);for(const r of t)this.finalizeStructure(r)}linkVariables(t){var s;const n=[];for(const{object:i,reloc:o}of this.variables)this.linkObject(i,o,t),i[K]&&i[I][0]&&n.push(i);for(const i of n){const o=i[K](),r=this.getViewAddress(o[g]);i[de](r),(s=i[ye])==null||s.call(i,o.length)}}linkObject(t,n,s){if(t[g][D])return;const i=t[g],o=this.recreateAddress(n),r=this.obtainFixedView(o,i.byteLength);if(s){const l=Object.create(t.constructor.prototype);l[g]=r,l[j](t)}t[g]=r;const c=l=>{if(l[I]){for(const a of Object.values(l[I]))if(a){const f=a[g];if(f.buffer===i.buffer){const u=f.byteOffset-i.byteOffset;a[g]=this.obtainView(r.buffer,u,f.byteLength),c(a)}}}};c(t)}unlinkVariables(){for(const{object:t}of this.variables)this.unlinkObject(t)}unlinkObject(t){if(!t[g][D])return;t[U]();const n=t[g],s=this.allocateMemory(n.byteLength),i=Object.create(t.constructor.prototype);i[g]=s,i[j](t),t[g]=s}releaseFunctions(){const t=()=>{throw new Error("Module was abandoned")};for(const n of Object.keys(this.imports))this[n]&&(this[n]=t)}getSpecialExports(){const t=n=>{if(n===void 0)throw new Error("Not a Zig type");return n};return{init:(...n)=>this.init(...n),abandon:()=>this.abandon(),released:()=>this.released,connect:n=>this.console=n,sizeOf:n=>t(n[J]),alignOf:n=>t(n[_]),typeOf:n=>jn(t(n[G]))}}abandon(){this.abandoned||(this.releaseFunctions(),this.unlinkVariables(),this.abandoned=!0)}updatePointerAddresses(t){var l;const n=new Map,s=new Map,i=[],o=function({isActive:a}){var f;if(a(this)){const u=this[St];if(!n.get(u)){const d=u[I][0];if(d){n.set(u,d);const b=d[g];if(!b[D]){const m=s.get(b.buffer);if(m){const h=Array.isArray(m)?m:[m],p=Pn(h,b.byteOffset,w=>w[g].byteOffset);h.splice(p,0,d),Array.isArray(m)||(s.set(b.buffer,h),i.push(h))}else s.set(b.buffer,d);(f=d[k])==null||f.call(d,o)}}}}};t[k](o);const r=this.findTargetClusters(i),c=new Map;for(const a of r)for(const f of a.targets)c.set(f,a);for(const[a,f]of n){const u=c.get(f),d=this.getTargetAddress(f,u)??this.getShadowAddress(f,u);a[de](d),(l=a[ye])==null||l.call(a,f.length)}}findTargetClusters(t){const n=[];for(const s of t){let i=null,o=0,r=0,c=null;for(const l of s){const a=l[g],{byteOffset:f,byteLength:u}=a,d=f+u;let b=!0;i&&(r>f?(c||(c={targets:[i],start:o,end:r,address:void 0,misaligned:void 0},n.push(c)),c.targets.push(l),d>r?c.end=d:b=!1):c=null),b&&(i=l,o=f,r=d)}}return n}createClusterShadow(t){const{start:n,end:s,targets:i}=t;let o=0,r;for(const w of i){const S=w[g],M=S.byteOffset,E=w.constructor[_]??S[_];(o===void 0||E>o)&&(o=E,r=M)}const c=s-n,l=this.allocateShadowMemory(c+o,1),a=this.getViewAddress(l),f=Fi(yt(a,r-n),o),u=yt(f,n-r),d=l.byteOffset+Number(u-a),b=new DataView(l.buffer,d,c);for(const w of i){const S=w[g],M=S.byteOffset;if(M!==r){const E=w.constructor[_]??S[_];if(_i(yt(u,M-n),E))throw new qn(E,o)}}const m={[j]:H(c)},h=Object.create(m),p=Object.create(m);return h[g]=new DataView(i[0][g].buffer,Number(n),c),p[g]=b,b[D]={address:u,len:c,align:1,unalignedAddress:a,type:fe.Scratch},this.addShadow(p,h,1)}getShadowAddress(t,n){if(n){const s=t[g];if(n.address===void 0){const i=this.createClusterShadow(n);n.address=this.getViewAddress(i[g])}return yt(n.address,s.byteOffset-n.start)}else{const s=this.createShadow(t);return this.getViewAddress(s[g])}}createShadow(t){const n=t[g],s=t.constructor[_]??n[_],i=Object.create(t.constructor.prototype);return i[g]=this.allocateShadowMemory(n.byteLength,s),this.addShadow(i,t,s)}addShadow(t,n,s){let{shadowMap:i}=this.context;if(i||(i=this.context.shadowMap=new Map),!t[g][D])debugger;return t[U]=Ee(null,this),i.set(t,n),this.registerMemory(t[g],n[g],s),t}removeShadow(t){const{shadowMap:n}=this.context;if(n){for(const[s]of n)if(s[g]===t){n.delete(s);break}}}updateShadows(){const{shadowMap:t}=this.context;if(t)for(const[n,s]of t)n[j](s)}updateShadowTargets(){const{shadowMap:t}=this.context;if(t)for(const[n,s]of t)s[j](n)}releaseShadows(){const{shadowMap:t}=this.context;if(t)for(const[n]of t)this.freeShadowMemory(n[g])}updatePointerTargets(t){const n=new Map,s=function({isActive:i,isMutable:o}){var c,l;const r=this[St]??this;if(!n.get(r)){n.set(r,!0);const a=!r.constructor.const,f=r[I][0],u=!f||o(this)?r[Ze](!0,i(this)):f;(c=f==null?void 0:f[k])==null||c.call(f,s,{vivificate:!0,isMutable:()=>a}),u!==f&&((l=u==null?void 0:u[k])==null||l.call(u,s,{vivificate:!0,isMutable:()=>a}))}};t[k](s,{vivificate:!0})}writeToConsole(t){const{console:n}=this;try{const s=new Uint8Array(t.buffer,t.byteOffset,t.byteLength).slice(),i=s.lastIndexOf(10);if(i===-1)this.consolePending.push(s);else{const o=s.subarray(0,i),r=s.subarray(i+1),c=[...this.consolePending,o];n.log(jt(c)),this.consolePending=r.length>0?[r]:[]}clearTimeout(this.consoleTimeout),this.consolePending.length>0&&(this.consoleTimeout=setTimeout(()=>{n.log(jt(this.consolePending)),this.consolePending=[]},250))}catch(s){n.error(s)}}flushConsole(){this.consolePending.length>0&&(console.log(jt(this.consolePending)),this.consolePending=[],clearTimeout(this.consoleTimeout))}}class ki{constructor(){P(this,"pointerProcessed",new Map);P(this,"memoryList",[]);P(this,"shadowMap",null);P(this,"call",0)}}function Pn(e,t,n){let s=0,i=e.length;if(i===0)return 0;for(;s<i;){const o=Math.floor((s+i)/2);n(e[o])<=t?s=o+1:i=o}return i}function ae(e,t){return Pn(e,t,n=>n.address)}function _i(e,t){if(t===void 0)return!1;typeof e=="bigint"&&(e=Number(e&0xFFFFFFFFn));const n=t-1;return(e&n)!==0}function Fi(e,t){let n;return typeof e=="bigint"?(t=BigInt(t),n=~(t-1n)):n=~(t-1),(e&n)+t}function yt(e,t){return e+(typeof e=="bigint"?BigInt(t):t)}function zi(e){return typeof e=="bigint"?e===0xaaaaaaaaaaaaaaaan:e===2863311530}class Bi extends Ci{constructor(){super(...arguments);P(this,"imports",{allocateExternMemory:{argType:"iii",returnType:"i"},freeExternMemory:{argType:"iiii"},runThunk:{argType:"ii",returnType:"v"},runVariadicThunk:{argType:"iiii",returnType:"v"},isRuntimeSafetyActive:{argType:"",returnType:"b"},flushStdout:{argType:"",returnType:""}});P(this,"exports",{allocateHostMemory:{argType:"ii",returnType:"v"},freeHostMemory:{argType:"iii"},captureString:{argType:"ii",returnType:"v"},captureView:{argType:"iib",returnType:"v"},castView:{argType:"iibv",returnType:"v"},readSlot:{argType:"vi",returnType:"v"},writeSlot:{argType:"viv"},getViewAddress:{argType:"v",returnType:"i"},beginDefinition:{returnType:"v"},insertInteger:{argType:"vsi",alias:"insertProperty"},insertBoolean:{argType:"vsb",alias:"insertProperty"},insertString:{argType:"vss",alias:"insertProperty"},insertObject:{argType:"vsv",alias:"insertProperty"},beginStructure:{argType:"v",returnType:"v"},attachMember:{argType:"vvb"},attachMethod:{argType:"vvb"},createTemplate:{argType:"v",returnType:"v"},attachTemplate:{argType:"vvb"},finalizeShape:{argType:"v"},endStructure:{argType:"v"}});P(this,"nextValueIndex",1);P(this,"valueTable",{0:null});P(this,"valueIndices",new Map);P(this,"memory",null);P(this,"initPromise",null);P(this,"customWASI",null);P(this,"hasCodeSource",!1);P(this,"littleEndian",!0)}async init(n){if(n&&this.hasCodeSource)throw new Error("Cannot set WASI interface after compilation has already begun (consider disabling topLevelAwait)");this.customWASI=n,await this.initPromise}allocateHostMemory(n,s){const i={[_]:s},o=H(n),r=this.allocateRelocMemory(n,s),c=this.allocateShadowMemory(n,s),l={constructor:i,[g]:r,[j]:o},a={constructor:i,[g]:c,[j]:o};return this.addShadow(a,l,s),c}freeHostMemory(n,s,i){const o=this.unregisterMemory(n);if(o)this.removeShadow(o),this.freeShadowMemory(o);else throw new _n(n)}allocateShadowMemory(n,s){return this.allocateFixedMemory(n,s,fe.Scratch)}freeShadowMemory(n){return this.freeFixedMemory(n)}getBufferAddress(n){return 0}obtainExternView(n,s){const{buffer:i}=this.memory;return i[D]||(i[D]={address:0,len:i.byteLength}),this.obtainView(i,n,s)}copyBytes(n,s,i){const{memory:o}=this,r=new DataView(o.buffer,s,i);Se(i)(n,r)}findSentinel(n,s){const{memory:i}=this,o=s.byteLength,r=i.buffer.byteLength-o+1;for(let c=n;c<r;c+=o){const l=new DataView(i.buffer,c,o);let a=!0;for(let f=0;f<o;f++){const u=l.getUint8(f),d=s.getUint8(f);if(u!==d){a=!1;break}}if(a)return(c-n)/o}}captureString(n,s){const{buffer:i}=this.memory,o=new Uint8Array(i,n,s);return jt(o)}getTargetAddress(n,s){const i=n[g];if(i[D])return this.getViewAddress(i);if(i.byteLength===0)return 0}clearExchangeTable(){this.nextValueIndex!==1&&(this.nextValueIndex=1,this.valueTable={0:null},this.valueIndices=new Map)}getObjectIndex(n){if(n){let s=this.valueIndices.get(n);return s===void 0&&(s=this.nextValueIndex++,this.valueIndices.set(n,s),this.valueTable[s]=n),s}else return 0}fromWebAssembly(n,s){switch(n){case"v":case"s":return this.valueTable[s];case"i":return s;case"b":return!!s}}toWebAssembly(n,s){switch(n){case"v":case"s":return this.getObjectIndex(s);case"i":return s;case"b":return s?1:0}}exportFunction(n,s="",i=""){return n?(...o)=>{o=o.map((c,l)=>this.fromWebAssembly(s.charAt(l),c));const r=n.apply(this,o);return this.toWebAssembly(i,r)}:()=>{}}importFunction(n,s="",i=""){return(...o)=>{o=o.map((c,l)=>this.toWebAssembly(s.charAt(l),c));const r=n.apply(this,o);return this.fromWebAssembly(i,r)}}exportFunctions(){const n={};for(const[s,{argType:i,returnType:o,alias:r}]of Object.entries(this.exports)){const c=this[r??s];n[`_${s}`]=this.exportFunction(c,i,o)}return n}importFunctions(n){for(const[s,{argType:i,returnType:o}]of Object.entries(this.imports)){const r=n[s];if(!r)throw new Error(`Unable to import function: ${s}`);this[s]=this.importFunction(r,i,o)}}async instantiateWebAssembly(n){const s=await n;this.hasCodeSource=!0;const i={env:this.exportFunctions(),wasi_snapshot_preview1:this.getWASIImport()};return s[Symbol.toStringTag]==="Response"?WebAssembly.instantiateStreaming(s,i):WebAssembly.instantiate(s,i)}loadModule(n){return this.initPromise=(async()=>{var r,c;const{instance:s}=await this.instantiateWebAssembly(n),{memory:i,_initialize:o}=s.exports;this.importFunctions(s.exports),this.trackInstance(s),(c=(r=this.customWASI)==null?void 0:r.initialize)==null||c.call(r,s),this.runtimeSafety=this.isRuntimeSafetyActive(),this.memory=i})()}trackInstance(n){const s=new WeakRef(n);Object.defineProperty(this,"released",{get:()=>!s.deref(),enumerable:!0})}linkVariables(n){this.initPromise&&(this.initPromise=this.initPromise.then(()=>super.linkVariables(n)))}getMemoryOffset(n){return n}recreateAddress(n){return n}invokeThunk(n,s){return this.runThunk?this.invokeThunkForReal(n,s):this.initPromise.then(()=>this.invokeThunkForReal(n,s))}invokeThunkForReal(n,s){try{this.startContext(),s[k]&&this.updatePointerAddresses(s);const i=this.getShadowAddress(s),o=s[ss],r=o?this.getShadowAddress(o):0;this.updateShadows();const c=o?this.runVariadicThunk(n,i,r,o.length):this.runThunk(n,i);if(this.updateShadowTargets(),s[k]&&this.updatePointerTargets(s),this.releaseShadows(),this.endContext(),!this.context&&this.flushConsole&&(this.flushStdout(),this.flushConsole()),c)throw new qe(c);return s.retval}catch(i){if(!(i instanceof je&&i.code===0))throw i}}getWASIImport(){if(this.customWASI)return this.customWASI.wasiImport;{const i=()=>38;return{args_get:i,args_sizes_get:i,clock_res_get:i,clock_time_get:i,environ_get:i,environ_sizes_get:i,fd_advise:i,fd_allocate:i,fd_close:i,fd_datasync:i,fd_pread:i,fd_pwrite:i,fd_read:i,fd_readdir:i,fd_renumber:i,fd_seek:i,fd_sync:i,fd_tell:i,fd_write:(o,r,c,l)=>{if(o===1||o===2){const a=new DataView(this.memory.buffer);let f=0;for(let u=0,d=r;u<c;u++,d+=8){const b=a.getUint32(d,!0),m=a.getUint32(d+4,!0);if(m>0){const h=new DataView(this.memory.buffer,b,m);this.writeToConsole(h),f+=m}}return a.setUint32(l,f,!0),0}else return 38},fd_fdstat_get:i,fd_fdstat_set_flags:i,fd_fdstat_set_rights:i,fd_filestat_get:i,fd_filestat_set_size:i,fd_filestat_set_times:i,fd_prestat_get:()=>8,fd_prestat_dir_name:i,path_create_directory:i,path_filestat_get:i,path_filestat_set_times:i,path_link:i,path_open:i,path_readlink:i,path_remove_directory:i,path_rename:i,path_symlink:i,path_unlink_file:i,poll_oneoff:i,proc_exit:o=>{throw new je(o)},random_get:(o,r)=>{const c=new DataView(this.memory.buffer,o,r);for(let l=0;l<r;l++)c.setUint8(l,Math.floor(256*Math.random()));return 0},sched_yield:i,sock_accept:i,sock_recv:i,sock_send:i,sock_shutdown:i}}}}function ro(e){return new Bi}export{Ki as a,no as b,Xi as c,oo as d,io as e,so as f,eo as g,to as h,Qi as i,Zi as j,ro as k,qi as l,ln as m,Gi as n,Ji as o,Li as p,Ui as q,Wi as r,Ri as s,Yi as u};
