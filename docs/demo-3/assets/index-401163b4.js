var hn=Object.defineProperty;var dn=(t,e,n)=>e in t?hn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var M=(t,e,n)=>(dn(t,typeof e!="symbol"?e+"":e,n),n);const E={Void:0,Bool:1,Int:2,Uint:3,Float:4,Object:5,Type:6,Comptime:7,Static:8,Literal:9,Null:10,Undefined:11},T={Primitive:0,Array:1,Struct:2,ExternStruct:3,PackedStruct:4,ArgStruct:5,ExternUnion:6,BareUnion:7,TaggedUnion:8,ErrorUnion:9,ErrorSet:10,Enum:11,Optional:12,Pointer:13,Slice:14,Vector:15,Opaque:16,Function:17};function Ct(t){const{type:e,bitSize:n,byteSize:s}=t;if(e===E.Int)return`${n<=32?"":"Big"}Int${n}`;if(e===E.Uint)return`${n<=32?"":"Big"}Uint${n}`;if(e===E.Float)return`Float${n}`;if(e===E.Bool)return`Bool${s!==void 0?s*8:1}`;if(e===E.Void)return"Null"}function yn(t){for(const[e,n]of Object.entries(T))if(n===t)return e.replace(/\B[A-Z]/g,s=>` ${s}`).toLowerCase()}function pn(t){const{type:e,bitSize:n}=t,s=e===E.Int;let o=s?n-1:n;if(n<=32){const i=2**o-1;return{min:s?-(2**o):0,max:i}}else{o=BigInt(o);const i=2n**o-1n;return{min:s?-(2n**o):0n,max:i}}}function Ae({type:t,bitSize:e}){if(t===E.Int||t===E.Uint)return e<=32?Number:BigInt;if(t===E.Float)return Number;if(t===E.Bool)return Boolean}function Ee(t){const e=Ae(t);if(e)return typeof e(0)}function Xt({bitOffset:t,bitSize:e,byteSize:n}){return n!==void 0||!(t&7)&&!(e&7)||e===0}function Tt(t){return typeof t=="object"&&typeof t.error=="string"&&Object.keys(t).length===1}class mn extends TypeError{constructor(e){const{name:n}=e;super(`An initializer must be provided to the constructor of ${n}, even when the intended value is undefined`)}}class xe extends TypeError{constructor(e,n,s=null){const{name:o,type:i,byteSize:c}=e,r=n.byteLength,l=c!==1?"s":"";let a;if(i===T.Slice&&!s)a=`${o} has elements that are ${c} byte${l} in length, received ${r}`;else{const u=i===T.Slice?s.length*c:c;a=`${o} has ${u} byte${l}, received ${r}`}super(a)}}class bn extends TypeError{constructor(e){const{type:n,byteSize:s,typedArray:o}=e,i=s!==1?"s":"",c=["ArrayBuffer","DataView"].map(Z);o&&c.push(Z(o.name));let r;n===T.Slice?r=`Expecting ${Jt(c)} that can accommodate items ${s} byte${i} in length`:r=`Expecting ${Jt(c)} that is ${s} byte${i} in length`,super(r)}}class gn extends TypeError{constructor(e,n){const{name:s}=e;let o;typeof n=="number"||typeof n=="bigint"?o=`Value given does not correspond to an item of enum ${s}: ${n}`:o=`Enum item of the type ${s} expected, received ${n}`,super(o)}}class wn extends TypeError{constructor(e,n){const{name:s}=e,o=typeof n;let i;o==="string"||o==="number"||Tt(n)?(Tt(n)&&(n=`{ error: ${JSON.stringify(n.error)} }`),i=`Error ${o} does not corresponds to any error in error set ${s}: ${n}`):i=`Error of the type ${s} expected, received ${n}`,super(i)}}class Oe extends TypeError{constructor(e){const{name:n}=e;super(`Error given is not a part of error set ${n}`)}}class ct extends TypeError{constructor(e,n,s){const{name:o}=e,i=[];if(Array.isArray(n))for(const r of n)i.push(Z(r));else i.push(Z(n));const c=Ve(s);super(`${o} expects ${Jt(i)} as argument, received ${c}`)}}class rt extends ct{constructor(e,n,s=!1){var a;const{instance:{members:[o]},type:i,typedArray:c}=e,r=[],l=Ee(o);if(l){let u;switch((a=o.structure)==null?void 0:a.type){case T.Enum:u="enum item";break;case T.ErrorSet:u="error";break;default:u=l}r.push(`array of ${u}s`)}else r.push("array of objects");c&&r.push(c.name),i===T.Slice&&s&&r.push("length"),super(e,r.join(" or "),n)}}class kt extends TypeError{constructor(e,n,s){const{name:o,length:i,instance:{members:[c]}}=e,{structure:{constructor:r}}=c,{length:l,constructor:a}=s,u=(n==null?void 0:n.length)??i,f=u!==1?"s":"";let d;a===r?d="only a single one":a.child===r?d=`a slice/array that has ${l}`:d=`${l} initializer${l>1?"s":""}`,super(`${o} has ${u} element${f}, received ${d}`)}}class Sn extends TypeError{constructor(e,n){const{name:s}=e;super(`Missing initializers for ${s}: ${n.join(", ")}`)}}class vn extends TypeError{constructor(e,n){const{name:s,instance:{members:o}}=e,i=o.find(r=>r.name===n);let c;i?c=`Comptime value cannot be changed: ${n}`:c=`${s} does not have a property with that name: ${n}`,super(c)}}class Tn extends Error{constructor(e,n,s){const o=n!==1?"s":"";super(`${e}() expects ${n} argument${o}, received ${s}`)}}class An extends TypeError{constructor(e){super("Non-slice pointers can only be created with the help of the new operator")}}class En extends TypeError{constructor(e,n){const{name:s}=e,{constructor:{name:o}}=n;super(`Conversion of ${o} to ${s} requires an explicit cast`)}}class fe extends TypeError{constructor(e,n,s,o){const{name:i}=e;super(`${i} expects the sentinel value ${n} at ${o-1}, found at ${s}`)}}class Mt extends TypeError{constructor(e,n,s){const{name:o}=e;super(`${o} expects the sentinel value ${n} at ${s-1}`)}}class xn extends TypeError{constructor(e,n){super(`Unable to simultaneously align memory to ${n}-byte and ${e}-byte boundary`)}}class _t extends TypeError{constructor(e,n){const s=Ve(n);super(`Expected ${Z(e)}, received ${s}`)}}class he extends TypeError{constructor(){super("Null pointer")}}class On extends TypeError{constructor(e,n){const{name:s}=e;let o;if(n!=null){const i=typeof n,c=i==="object"&&n.constructor!==Object?`${n.constructor.name} object`:i;o=`${$e(c)} ${c}`}else o=n+"";super(`${s} cannot point to ${o}`)}}class In extends TypeError{constructor(e,n){super("Pointers in fixed memory cannot point to garbage-collected object")}}class Mn extends TypeError{constructor(e,n){const s=Ct(e);super(`${s} cannot represent the value given: ${n}`)}}class de extends RangeError{constructor(e,n){const{name:s}=e;super(`Index exceeds the size of ${s??"array"}: ${n}`)}}class Vn extends TypeError{constructor(e){const{name:n,structure:{name:{struct:s}}}=e;super(`Unable to create ${s} as it is not situated on a byte boundary: ${n}`)}}class $n extends TypeError{constructor(){super("Unable to modify read-only object")}}class Pn extends TypeError{constructor(e){const{name:n}=e;super(`${n} cannot point to a read-only object`)}}class Ie extends Error{constructor(e){super(Me(e))}}class ye extends Ie{constructor(e){super("Program exited"),this.code=e}}function jn(t,e,n,s){const o=`args[${e}]`,i=e!==0?"..., ":"",c=e!==n-1?", ...":"",r=i+o+c,l=Object.create(s.constructor.prototype);return l.message=`${t}(${r}): ${s.message}`,l.stack=s.stack,l}function pe(t,e,n){return n instanceof RangeError&&!(n instanceof de)&&(n=new de(t,e)),n}function pt(){throw new $n}function Dn(t,e){const n=Z(t.typedArray.name),s=Z(e.constructor.name);console.warn(`Implicitly creating ${n} from ${s}`)}function Me(t){let e=t.replace(/_/g," ");try{e=e.replace(/(\p{Uppercase}+)(\p{Lowercase}*)/gu,(n,s,o)=>{if(s.length===1)return` ${s.toLocaleLowerCase()}${o}`;if(o){const i=s.substring(0,s.length-1),c=s.charAt(s.length-1).toLocaleLowerCase();return` ${i} ${c}${o}`}else return` ${s}`}).trimStart()}catch{}return e.charAt(0).toLocaleUpperCase()+e.substring(1)}function Ve(t){const e=typeof t;let n;return e==="object"?n=t?Object.prototype.toString.call(t):"null":n=e,Z(n)}function Z(t){return`${$e(t)} ${t}`}function $e(t){return/^\W*[aeiou]/i.test(t)?"an":"a"}function Jt(t,e="or"){const n=` ${e} `;return t.length>2?t.slice(0,-1).join(", ")+n+t[t.length-1]:t.join(n)}const g=Symbol("memory"),x=Symbol("slots"),Zt=Symbol("parent"),Pe=Symbol("name"),B=Symbol("type"),je=Symbol("tuple"),wt=Symbol("class"),me=Symbol("tag"),lt=Symbol("props"),Ft=Symbol("getter"),Nt=Symbol("setter"),bt=Symbol("elementGetter"),gt=Symbol("elementSetter"),Yt=Symbol("addressGetter"),De=Symbol("addressSetter"),it=Symbol("targetGetter"),Ht=Symbol("targetSetter"),at=Symbol("entriesGetter"),yt=Symbol("fixedLocation"),Qt=Symbol("propSetters"),F=Symbol("writeDisabler"),Ce=Symbol("allKeys"),Kt=Symbol("length"),zt=Symbol("proxy"),xt=Symbol("compat"),_=Symbol("size"),j=Symbol("align"),te=Symbol("array"),At=Symbol("pointer"),ut=Symbol("constTarget"),Gt=Symbol("constProxy"),$=Symbol("copier"),be=Symbol("resetter"),W=Symbol("vivificator"),D=Symbol("pointerVisitor"),St=Symbol("environment"),Vt=Symbol("attributes"),ke=Symbol("more");function Q(t){return function(){const e=this[g];this[g]=null,this[x]&&(this[x]={}),t.releaseFixedView(e)}}function ge(t,e,n){if(t+e<=8){const s=2**e-1;if(n)return function(o,i,c){const l=i.getUint8(c)>>t&s;o.setUint8(0,l)};{const o=255^s<<t;return function(i,c,r){const l=c.getUint8(0),u=i.getUint8(r)&o|(l&s)<<t;i.setUint8(r,u)}}}else{const s=8-t,o=2**s-1;if(n){const c=2**(e%8)-1;return function(r,l,a){let u=a,f=0,d=l.getUint8(u++),h,p=d>>t&o,y=s,m=e;do m>y&&(d=l.getUint8(u++),p=p|d<<y),h=m>=8?p&255:p&c,r.setUint8(f++,h),p>>=8,m-=8;while(m>0)}}else{const c=2**((e-s)%8)-1,r=255^o<<t,l=255^c;return function(a,u,f){let d=0,h=f,p=a.getUint8(h),y,m,b=p&r,w=t,S=e+w;do S>w&&(y=u.getUint8(d++),b=b|y<<w,w+=8),S>=8?m=b&255:(p=a.getUint8(h),m=p&l|b&c),a.setUint8(h++,m),b>>=8,w-=8,S-=8;while(S>0)}}}}function N(t,e=!1){const n=_e(t,e);return function(s){R.call(this),R.call(s);const o=s[g],i=this[g];n(i,o)}}function _e(t,e=!1){if(!e){const n=Cn[t];if(n)return n}return t&7?t&3?t&1?kn:_n:Fn:Nn}const Cn={1:zn,2:Bn,4:Un,8:Ln,16:Rn,32:Wn};function kn(t,e){for(let n=0,s=t.byteLength;n<s;n++)t.setInt8(n,e.getInt8(n))}function _n(t,e){for(let n=0,s=t.byteLength;n<s;n+=2)t.setInt16(n,e.getInt16(n,!0),!0)}function Fn(t,e){for(let n=0,s=t.byteLength;n<s;n+=4)t.setInt32(n,e.getInt32(n,!0),!0)}function Nn(t,e){for(let n=0,s=t.byteLength;n<s;n+=8)t.setInt32(n,e.getInt32(n,!0),!0),t.setInt32(n+4,e.getInt32(n+4,!0),!0)}function zn(t,e){t.setInt8(0,e.getInt8(0))}function Bn(t,e){t.setInt16(0,e.getInt16(0,!0),!0)}function Un(t,e){t.setInt32(0,e.getInt32(0,!0),!0)}function Ln(t,e){t.setInt32(0,e.getInt32(0,!0),!0),t.setInt32(4,e.getInt32(4,!0),!0)}function Rn(t,e){t.setInt32(0,e.getInt32(0,!0),!0),t.setInt32(4,e.getInt32(4,!0),!0),t.setInt32(8,e.getInt32(8,!0),!0),t.setInt32(12,e.getInt32(12,!0),!0)}function Wn(t,e){t.setInt32(0,e.getInt32(0,!0),!0),t.setInt32(4,e.getInt32(4,!0),!0),t.setInt32(8,e.getInt32(8,!0),!0),t.setInt32(12,e.getInt32(12,!0),!0),t.setInt32(16,e.getInt32(16,!0),!0),t.setInt32(20,e.getInt32(20,!0),!0),t.setInt32(24,e.getInt32(24,!0),!0),t.setInt32(28,e.getInt32(28,!0),!0)}function Gn(t,e){const n=qn(e);return function(){R.call(this);const s=this[g];n(s,t,e)}}function qn(t){const e=Jn[t];return e||(t&7?t&3?t&1?Yn:Hn:Kn:Xn)}const Jn={1:Zn,2:Qn,4:ts,8:es,16:ns,32:ss};function Yn(t,e,n){for(let s=e,o=e+n;s<o;s++)t.setInt8(s,0)}function Hn(t,e,n){for(let s=e,o=e+n;s<o;s+=2)t.setInt16(s,0,!0)}function Kn(t,e,n){for(let s=e,o=e+n;s<o;s+=4)t.setInt32(s,0,!0)}function Xn(t,e,n){for(let s=e,o=e+n;s<o;s+=8)t.setInt32(s,0,!0),t.setInt32(s+4,0,!0)}function Zn(t,e){t.setInt8(e,0)}function Qn(t,e){t.setInt16(e,0,!0)}function ts(t,e){t.setInt32(e,0,!0)}function es(t,e){t.setInt32(e+0,0,!0),t.setInt32(e+4,0,!0)}function ns(t,e){t.setInt32(e+0,0,!0),t.setInt32(e+4,0,!0),t.setInt32(e+8,0,!0),t.setInt32(e+12,0,!0)}function ss(t,e){t.setInt32(e+0,0,!0),t.setInt32(e+4,0,!0),t.setInt32(e+8,0,!0),t.setInt32(e+12,0,!0),t.setInt32(e+16,0,!0),t.setInt32(e+20,0,!0),t.setInt32(e+24,0,!0),t.setInt32(e+28,0,!0)}function R(){const t=this[g],e=t[g];if(!e||t.buffer.byteLength!==0)return!1;const{memory:n,address:s,len:o}=e,i=new DataView(n.buffer,s,o);return i[g]=e,this[g]=i,!0}function os(t,e){return Ue(t,e,()=>{if(Xt(e)){const{byteSize:n}=e,s=Ct({type:E.Int,bitSize:n*8});if(t==="get"){const o=DataView.prototype[`get${s}`];return function(i,c){return!!o.call(this,i,c)}}else{const o=DataView.prototype[`set${s}`],i=n>4?1n:1,c=n>4?0n:0;return function(r,l,a){o.call(this,r,l?i:c,a)}}}else return Ne(t,e)})}function Et(t,e){return Ue(t,e,n=>DataView.prototype[n]?DataView.prototype[n]:Ne(t,e))}const Fe={};function wo(){Fe[E.Uint]=is}function Ne(t,e){const n=Fe[e.type];return n(t,e)}function is(t,e){return Xt(e)?fs(t,e):hs(t,e)}function Bt(t,e,n){const{type:s,byteSize:o,typedArray:i}=t;let c;const r=e==null?void 0:e[Symbol.toStringTag];if(r==="DataView")c=e;else if(r==="ArrayBuffer"||r==="SharedArrayBuffer")c=n.obtainView(e,0,e.byteLength);else if(i&&r===i.name||r==="Uint8ClampedArray"&&i===Uint8Array)c=n.obtainView(e.buffer,e.byteOffset,e.byteLength);else if(r==="Uint8Array"&&typeof Buffer=="function"&&e instanceof Buffer)c=n.obtainView(e.buffer,e.byteOffset,e.byteLength);else{const l=e==null?void 0:e[g];if(l){const{constructor:a,instance:{members:[u]}}=t;if(e instanceof a)return l;if(s===T.Array||s===T.Slice||s===T.Vector){const{byteSize:f,structure:{constructor:d}}=u,h=Be(e,d);if(h!==void 0){if(s===T.Slice||h*f===o)return l;throw new kt(t,null,e)}}}}return c&&o!==void 0&&ze(c,t),c}function rs(t){if((t==null?void 0:t[Symbol.toStringTag])!=="DataView")throw new _t("a DataView",t);return t}function ze(t,e){const{byteSize:n,type:s}=e;if(s===T.Slice?t.byteLength%n!==0:t.byteLength!==n)throw new xe(e,t)}function Ot(t,e,n,s,o){const{byteSize:i,type:c,sentinel:r}=e,l=c===T.Slice;if(this[g]){const a=l?i*this.length:i;if(t.byteLength!==a)throw new xe(e,t,this);const u={[g]:t};r==null||r.validateData(u,this.length),this[$](u)}else{const{shapeDefiner:a}=o;ze(t,e);const u=t.byteLength/i,f={[g]:t};r==null||r.validateData(f,u),s&&(n=!0),a.call(this,n?null:t,u,s),n&&this[$](f)}}function Be(t,e){const{constructor:n}=t;if(n===e)return 1;if(n.child===e)return t.length}function cs(t,e,n){const s=Bt(t,e,n);if(!s)throw new bn(t);return s}function ft(t){const{type:e,byteSize:n}=t;if(e===E.Int)switch(n){case 1:return Int8Array;case 2:return Int16Array;case 4:return Int32Array;case 8:return BigInt64Array}else if(e===E.Uint)switch(n){case 1:return Uint8Array;case 2:return Uint16Array;case 4:return Uint32Array;case 8:return BigUint64Array}else if(e===E.Float)switch(n){case 4:return Float32Array;case 8:return Float64Array}else if(e===E.Object)return t.structure.typedArray;return null}function ls(t,e){const n=t==null?void 0:t[Symbol.toStringTag];return!!e&&n===e.name}function as(t,e){const n=e[xt];if(n){const s=t==null?void 0:t[Symbol.toStringTag];if(n.includes(s))return!0}return!!(e.child&&Be(t,e.child)!==void 0)}function Ut(t){const{typedArray:e}=t,n=[];return e&&(n.push(e.name),n.push("DataView"),(e===Uint8Array||e===Int8Array)&&(n.push("ArrayBuffer"),n.push("SharedArrayBuffer"),e===Uint8Array&&n.push("Uint8ClampedArray"))),n}function us(t){const e=DataView.prototype.getBigUint64,n=DataView.prototype.setBigUint64,s=Math.ceil(t/64);return{get:function(o,i){let c=0n;if(i)for(let r=0,l=o+(s-1)*8;r<s;r++,l-=8){const a=e.call(this,l,i);c=c<<64n|a}else for(let r=0,l=o;r<s;r++,l+=8){const a=e.call(this,l,i);c=c<<64n|a}return c},set:function(o,i,c){let r=i;const l=0xFFFFFFFFFFFFFFFFn;if(c)for(let a=0,u=o;a<s;a++,u+=8){const f=r&l;n.call(this,u,f,c),r>>=64n}else{r<<=BigInt(s*64-t);for(let a=0,u=o+(s-1)*8;a<s;a++,u-=8){const f=r&l;n.call(this,u,f,c),r>>=64n}}return r}}}function fs(t,e){const{bitSize:n,byteSize:s}=e;if(n<64){const o=Ct({...e,bitSize:s*8}),i=DataView.prototype[`get${o}`],c=DataView.prototype[`set${o}`],r=n<=32?2**n-1:2n**BigInt(n)-1n;return t==="get"?function(l,a){return i.call(this,l,a)&r}:function(l,a,u){const f=a&r;c.call(this,l,f,u)}}else{const{get:o,set:i}=us(n),c=2n**BigInt(n)-1n;return t==="get"?function(r,l){return o.call(this,r,l)&c}:function(r,l,a){const u=l&c;i.call(this,r,u,a)}}}function hs(t,e){const{bitSize:n,bitOffset:s}=e,o=s&7;if(o+n<=8){const i=DataView.prototype.setUint8,c=DataView.prototype.getUint8,r=2**n-1;if(t==="get")return function(l){return c.call(this,l)>>>o&r};{const l=255^r<<o;return function(a,u){const d=c.call(this,a)&l|(u&r)<<o;i.call(this,a,d)}}}return ds(t,e)}function ds(t,e){const{bitSize:n,bitOffset:s}=e,o=s&7,i=[1,2,4,8].find(r=>r*8>=n)??Math.ceil(n/64)*64,c=new DataView(new ArrayBuffer(i));if(t==="get"){const r=Et("get",{...e,byteSize:i}),l=ge(o,n,!0);return function(a,u){return l(c,this,a),r.call(c,0,u)}}else{const r=Et("set",{...e,byteSize:i}),l=ge(o,n,!1);return function(a,u,f){r.call(c,0,u,f),l(this,c,a)}}}const we={};function Ue(t,e,n){const{type:s,bitOffset:o,bitSize:i,structure:c}=e,r=o&7,l=Ct(e),a=Xt(e)?"":`Bit${r}`,u=s===E.Int||s===E.Uint;let f=`${t}${l}${a}`,d=!1,h=f;if(u&&i===64){const y=c==null?void 0:c.name;(y==="usize"||y==="isize")&&(f+="Size",d=!0)}let p=we[f];if(!p){if(u&&t==="set"){const y=Ae(e),m=n(h);p=function(b,w,S){m.call(this,b,y(w),S)}}else if(d&&t==="get"){const y=n(h),m=BigInt(Number.MIN_SAFE_INTEGER),b=BigInt(Number.MAX_SAFE_INTEGER);p=function(w,S){const P=y.call(this,w,S);return m<=P&&P<=b?Number(P):P}}else p=n(f);p&&p.name!==f&&Object.defineProperty(p,"name",{value:f,configurable:!0,writable:!1}),we[f]=p}return p}function ys({type:t}){switch(t){case E.Type:case E.Comptime:case E.Literal:return!0;default:return!1}}const tt={};function So(){tt[E.Bool]=gs}function vo(){tt[E.Int]=ws}function ps(){tt[E.Uint]=Ss}function To(){tt[E.Float]=vs}function Ao(){tt[E.Object]=xs}function Eo(){tt[E.Type]=Is}function xo(){tt[E.Comptime]=Ms}const ee={};function ms(){ee[T.Enum]=Ts}function bs(){ee[T.ErrorSet]=As}function C(t,e){const n=tt[t.type];return n(t,e)}function Le(t,e){const{structure:n}=e,s=ee[n==null?void 0:n.type];return s?s(t,n):t}function gs(t,e){return Lt(t,e,os)}function ws(t,e){const n=Re(e,Et),s=Lt(t,e,n);return Le(s,t)}function Ss(t,e){const n=Re(e,Et),s=Lt(t,e,n);return Le(s,t)}function Re(t,e){return function(n,s){const{runtimeSafety:o=!0}=t,i=e(n,s);if(o&&n==="set"){const{min:c,max:r}=pn(s);return function(l,a,u){if(a<c||a>r)throw new Mn(s,a);i.call(this,l,a,u)}}return i}}function vs(t,e){return Lt(t,e,Et)}function Ts(t,e){const n=function(s){const{constructor:o}=e,i=o(s);if(!i)throw new gn(e,s);return i};return{get:t.get.length===0?function(o){const i=t.get.call(this);return o==="number"?i:n(i)}:function(o){const i=t.get.call(this,o);return n(i)},set:t.set.length===1?function(o,i){i!=="number"&&(o=n(o)[Symbol.toPrimitive]()),t.set.call(this,o)}:function(o,i){const c=n(i);t.set.call(this,o,c[Symbol.toPrimitive]())}}}function As(t,e){const n=function(s){const{constructor:o}=e,i=o(s);if(!i)throw s instanceof Error?new Oe(e):new wn(e,s);return i};return{get:t.get.length===0?function(o){const i=t.get.call(this);return o==="number"?i:n(i)}:function(o){const i=t.get.call(this,o);return n(i)},set:t.set.length===1?function(o,i){if(i!=="number"){const c=n(o);o=Number(c)}t.set.call(this,o)}:function(o,i){const c=n(i);i=Number(c),t.set.call(this,o,i)}}}function ne(t){switch(t.type){case T.Primitive:case T.ErrorUnion:case T.Optional:case T.Enum:case T.ErrorSet:return!0;default:return!1}}function We(t){return(this[x][t]??this[W](t))[Ft]()}function Ge(t){return this[x][t]??this[W](t)}function Es(t,e){(this[x][t]??this[W](t))[Nt](e)}function se(t,{get:e,set:n}){return t!==void 0?{get:function(){return e.call(this,t)},set:n?function(s){return n.call(this,t,s)}:void 0}:{get:e,set:n}}function xs(t,e){const{structure:n,slot:s}=t;return se(s,{get:ne(n)?We:Ge,set:Es})}function Os(t){const e=this[x][t];return e==null?void 0:e.constructor}function Is(t,e){const{slot:n}=t;return se(n,{get:Os})}function Ms(t,e){const{slot:n,structure:s}=t;return se(n,{get:ne(s)?We:Ge})}function Lt(t,e,n){const{littleEndian:s=!0}=e,{bitOffset:o,byteSize:i}=t,c=n("get",t),r=n("set",t);if(o!==void 0){const l=o>>3;return{get:function(){try{return c.call(this[g],l,s)}catch(u){if(u instanceof TypeError&&R.call(this))return c.call(this[g],l,s);throw u}},set:function(u){try{return r.call(this[g],l,u,s)}catch(f){if(f instanceof TypeError&&R.call(this))return r.call(this[g],l,u,s);throw f}}}}else return{get:function(a){try{return c.call(this[g],a*i,s)}catch(u){if(u instanceof TypeError&&R.call(this))return c.call(this[g],a*i,s);throw pe(t,a,u)}},set:function(a,u){try{return r.call(this[g],a*i,u,s)}catch(f){if(f instanceof TypeError&&R.call(this))return r.call(this[g],a*i,u,s);throw pe(t,a,f)}}}}function k(t,e){for(const[n,s]of Object.entries(e))if(s){const{set:o,get:i,value:c,enumerable:r,configurable:l=!0,writable:a=!0}=s;Object.defineProperty(t,n,i?{get:i,set:o,configurable:l,enumerable:r}:{value:c,configurable:l,enumerable:r,writable:a})}for(const n of Object.getOwnPropertySymbols(e)){const s=e[n];s&&Object.defineProperty(t,n,s)}}function Y(t,e,n){const s={};for(const[c,r]of Object.entries(e))r!=null&&r.set&&c!=="$"&&(s[c]=r.set);const{get:o,set:i}=e.$;return k(t.prototype,{[Ce]:{value:Object.keys(s)},[Nt]:{value:i},[Ft]:{value:o},[Qt]:{value:s},[ut]:{value:null},...e}),k(t,n),t}function ht(){const t=Object.getOwnPropertyDescriptors(this.constructor.prototype);for(const[e,n]of Object.entries(t))n.set&&(n.set=pt,Object.defineProperty(this,e,n));Object.defineProperty(this,Nt,{value:pt}),Object.defineProperty(this,ut,{value:this})}function H(t,e,n){const{byteSize:s,align:o,instance:{members:i,template:c},hasPointer:r}=t,{modifier:l,initializer:a,finalizer:u,alternateCaster:f,shapeDefiner:d}=e,h=Vs(i);let p;if(c!=null&&c[x]){const b=i.filter(w=>ys(w));b.length>0&&(p=b.map(w=>w.slot))}const y=new $s,m=function(b,w={}){const{fixed:S=!1}=w,P=this instanceof m;let I,A;if(P){if(arguments.length===0)throw new mn(t);I=this,h&&(I[x]={}),d?(a.call(I,b,S),A=I[g]):I[g]=A=n.allocateMemory(s,o,S)}else{if(f&&(I=f.call(this,b,w),I!==!1)||(A=cs(t,b,n),I=y.find(A)))return I;I=Object.create(m.prototype),d?Ot.call(I,A,t,!1,!1,{shapeDefiner:d}):I[g]=A,h&&(I[x]={})}if(p)for(const O of p)I[x][O]=c[x][O];return l&&l.call(I),P&&(d||a.call(I,b)),u&&(I=u.call(I)),y.save(A,I)};return m}function It({source:t}){const e=t[x][0];e&&this[Ht](e)}function et(t){const{instance:{template:e}}=t;return function(n,s){var f;const o=Object.keys(n),i=this[Qt],c=this[Ce];for(const d of o)if(!(d in i))throw new vn(t,d);let r=0,l=0,a=0,u=0;for(const d of c){const h=i[d];h.special?d in n&&u++:(r++,d in n?l++:h.required&&a++)}if(a!==0&&u===0){const d=c.filter(h=>i[h].required&&!(h in n));throw new Sn(t,d)}if(u+l>o.length)for(const d of c)d in n&&(o.includes(d)||o.push(d));l<r&&u===0&&e&&(e[g]&&this[$](e),(f=this[D])==null||f.call(this,It,{vivificate:!0,source:e}));for(const d of o)i[d].call(this,n[d],s);return o.length}}function Vs(t){for(const{type:e}of t)switch(e){case E.Object:case E.Comptime:case E.Type:case E.Literal:return!0}return!1}function qe(){return this}class $s{constructor(){M(this,"map",new WeakMap)}find(e){return this.map.get(e)}save(e,n){return this.map.set(e,n),n}}const Se={},ve={};function vt(t,e="utf-8"){let n=Se[e];n||(n=Se[e]=new TextDecoder(e));let s;if(Array.isArray(t))if(t.length===1)s=t[0];else{let o=0;for(const r of t)o+=r.length;const{constructor:i}=t[0];s=new i(o);let c=0;for(const r of t)s.set(r,c),c+=r.length}else s=t;return n.decode(s)}function Ps(t,e="utf-8"){switch(e){case"utf-16":{const{length:n}=t,s=new Uint16Array(n);for(let o=0;o<n;o++)s[o]=t.charCodeAt(o);return s}default:{let n=ve[e];return n||(n=ve[e]=new TextEncoder),n.encode(t)}}}function js(t){const e=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=String.fromCharCode.apply(null,e);return btoa(n)}function Ds(t){const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<n.byteLength;s++)n[s]=e.charCodeAt(s);return new DataView(n.buffer)}function z(){return Je(this,!1)}function G(){return Je(this,!0)}const Cs=BigInt(Number.MAX_SAFE_INTEGER),ks=BigInt(Number.MIN_SAFE_INTEGER);function Je(t,e){const n=e?"return":"throw",s=new Map,o=function(i){var l,a,u;const c=typeof i=="function"?T.Struct:(l=i==null?void 0:i.constructor)==null?void 0:l[B];if(c===void 0){if(e){if(typeof i=="bigint"&&ks<=i&&i<=Cs)return Number(i);if(i instanceof Error)return{error:i.message}}return i}let r=s.get(i);if(r===void 0){let f;switch(c){case T.Struct:case T.PackedStruct:case T.ExternStruct:case T.TaggedUnion:case T.BareUnion:case T.ExternUnion:f=(a=i[at])==null?void 0:a.call(i,{error:n}),r=i.constructor[je]?[]:{};break;case T.Array:case T.Vector:case T.Slice:f=(u=i[at])==null?void 0:u.call(i,{error:n}),r=[];break;case T.Pointer:try{r=i["*"]}catch{r=Symbol.for("inaccessible")}break;case T.Enum:r=Pt(()=>String(i),{error:n});break;case T.Opaque:r={};break;default:r=Pt(()=>i.$,{error:n})}if(r=o(r),s.set(i,r),f)for(const[d,h]of f)r[d]=o(h)}return r};return o(t)}function Pt(t,e={}){const{error:n="throw"}=e;try{return t()}catch(s){debugger;if(n==="return")return s;throw s}}function nt(t,e={}){return Rt({get(){return R.call(this),this[g]},set(n,s){rs(n),Ot.call(this,n,t,!0,s,e)}})}function st(t,e={}){return Rt({get(){return js(this.dataView)},set(n,s){if(typeof n!="string")throw new _t("string",n);const o=Ds(n);Ot.call(this,o,t,!1,s,e)}})}function Ye(t,e={}){const{sentinel:n,instance:{members:s}}=t,{byteSize:o}=s[0];return Rt({get(){const i=this.dataView,c=o===1?Int8Array:Int16Array,r=new c(i.buffer,i.byteOffset,this.length),l=vt(r,`utf-${o*8}`);return(n==null?void 0:n.value)===void 0?l:l.slice(0,-1)},set(i,c){if(typeof i!="string")throw new _t("a string",i);(n==null?void 0:n.value)!==void 0&&i.charCodeAt(i.length-1)!==n.value&&(i=i+String.fromCharCode(n.value));const r=Ps(i,`utf-${o*8}`),l=new DataView(r.buffer);Ot.call(this,l,t,!1,c,e)}})}function mt(t,e={}){const{typedArray:n}=t;return Rt({get(){const s=this.dataView,o=s.byteLength/n.BYTES_PER_ELEMENT;return new n(s.buffer,s.byteOffset,o)},set(s,o){if(!ls(s,n))throw new _t(n.name,s);const i=new DataView(s.buffer,s.byteOffset,s.byteLength);Ot.call(this,i,t,!0,o,e)}})}function Rt({get:t,set:e}){return t.special=e.special=!0,{get:t,set:e}}let X,$t;function He(t,e){const{name:n,byteSize:s,align:o,instance:{members:[i]}}=t;if($t||($t=class extends Ns{},X=He({...t,name:"anyerror"},e)),X&&n==="anyerror")return t.constructor=X,t.typedArray=ft(i),X;const c=$t,{get:r,set:l}=C(i,e),a=["string","number"],u=et(t),f=function(b){if(b instanceof h[wt])l.call(this,b);else if(b&&typeof b=="object"&&!Tt(b)){if(u.call(this,b)===0)throw new ct(t,a,b)}else b!==void 0&&l.call(this,b)},d=function(b){if(typeof b=="number"||typeof b=="string")return h[b];if(b instanceof h[wt])return h[Number(b)];if(Tt(b))return h[`Error: ${b.error}`];if(Bt(t,b,e))return!1;throw new ct(t,a,b)},h=t.constructor=H(t,{initializer:f,alternateCaster:d},e),p=t.typedArray=ft(i),y={$:{get:r,set:l},dataView:nt(t),base64:st(t),typedArray:p&&mt(t),valueOf:{value:z},toJSON:{value:G},delete:{value:Q(e)},[$]:{value:N(s)},[F]:{value:ht}},m={[j]:{value:o},[_]:{value:s},[wt]:{value:c},[lt]:n==="anyerror"?{value:[]}:void 0,[B]:{value:t.type}};return Y(h,y,m)}function _s(t,e,n){const s=n[Ft]("number");let o=X[s];if(!o){const r=t[wt];o=new r(e,s)}const i=String(o),c={[s]:{value:o},[i]:{value:o},[e]:{value:o}};k(t,c),k(X,c),X[lt].push(e)}function Fs(){$t=X=void 0}class Ns extends Error{constructor(e,n){super(Me(e)),this.number=n,this.stack=void 0}[Symbol.toPrimitive](e){switch(e){case"string":case"default":return Error.prototype.toString.call(this,e);default:return this.number}}toJSON(){return{error:this.message}}}function zs(t,e){const n=(s,{methods:o},i)=>{const c={},r=/^(get|set)\s+([\s\S]+)/;for(const l of o){const a=e.createCaller(l,i),u=r.exec(a.name);if(u){const f=u[1],d=u[2],h=f==="get"?0:1;if(Bs(l,i)===h){let y=c[d];y||(y=c[d]={configurable:!0,enumerable:!0}),y[f]=a}}else c[a.name]={value:a,configurable:!0,writable:!0}}k(s,c)};n(t.constructor,t.static,!1),n(t.constructor.prototype,t.instance,!0)}function Bs(t,e){const{argStruct:{instance:{members:n}}}=t;return n.length-(e?2:1)}function Us(t,e){const{byteSize:n,align:s,instance:{members:[o]}}=t,{get:i,set:c}=C(o,e),r=["string","number","tagged union"],l=et(t),a=function(m){if(m&&typeof m=="object"){if(l.call(this,m)===0)throw new ct(t,r,m)}else m!==void 0&&c.call(this,m)},u=function(m){if(typeof m=="string"||typeof m=="number"||typeof m=="bigint"){let b=f[m];if(!b&&f[ke]&&typeof m!="string"){b=new f(void 0);debugger;c.call(b,m,"number"),Ke(f,`${m}`,b)}return b}else{if(m instanceof f)return m;if((m==null?void 0:m[me])instanceof f)return m[me];if(Bt(t,m,e))return!1;throw new ct(t,r,m)}},f=t.constructor=H(t,{initializer:a,alternateCaster:u},e),d=t.typedArray=ft(o),h=function(m){switch(m){case"string":case"default":return this.$[Pe];default:return i.call(this,"number")}},p={$:{get:i,set:c},dataView:nt(t),base64:st(t),typedArray:d&&mt(t),valueOf:{value:z},toString:{value:z},toJSON:{value:G},delete:{value:Q(e)},[Symbol.toPrimitive]:{value:h},[$]:{value:N(n)},[F]:{value:ht}},y={[j]:{value:s},[_]:{value:n},[B]:{value:t.type}};return Y(f,p,y)}function Ke(t,e,n){if(e!==void 0){if(n instanceof t){k(n,{[Pe]:{value:e}});const s=n[Symbol.toPrimitive]();k(t,{[s]:{value:n},[e]:{value:n}})}}else k(t,{[ke]:{value:!0}})}function Ls(t,e){const{byteSize:n,align:s,instance:{members:[o]},isConst:i}=t,{runtimeSafety:c=!0}=e,{structure:r}=o,{type:l,sentinel:a,length:u}=r,f=l===T.Slice&&r.length===void 0&&!a,d=f?n/2:n,{get:h,set:p}=C({type:E.Uint,bitOffset:0,bitSize:d*8,byteSize:d,structure:{byteSize:d}},e),{get:y,set:m}=f?C({type:E.Uint,bitOffset:d*8,bitSize:d*8,byteSize:d,structure:{name:"usize",byteSize:d}},e):{},b=function(){const v=this[yt];if(v){const V=this[Yt]();if(V.address!==v.address||V.length!==v.length){const{constructor:q}=r,K=e.findMemory(V.address,V.length,q[_]),Wt=q.call(St,K);this[x][0]=Wt,this[yt]=V}}},w=function(){b.call(this);const v=this[x][0];if(!v)throw new he;return i?Xe(v):v},S=function(v){if(e.inFixedMemory(this))if(e.inFixedMemory(v)){const V={address:e.getViewAddress(v[g]),length:f?v.length:ae};le.call(this,V),this[yt]=V}else throw new In(t,v);this[x][0]=v},P=ne(r)?function(){return w.call(this)[Ft]()}:w,I=i?pt:function(v){b.call(this);const V=this[x][0];if(!V)throw new he;return V[Nt](v)},A=function(v,V){const q=r.constructor;if(this===St||this===Zt||v instanceof ot)return!1;if(Te(v,q))return new ot(q(v["*"]),V);if(l===T.Slice)return new ot(q(v),V);throw new An(t)},O=function(){const v=l===T.Pointer?{}:Ys,V=new Proxy(this,v);return Object.defineProperty(this,zt,{value:V}),V},L=function(v){var q;const V=r.constructor;if(Te(v,V)){if(!i&&v.constructor.const)throw new En(t,v);v=v[x][0]}if(v instanceof V){R.call(v);const K=v[ut];if(K)if(i)v=K;else throw new Pn(t)}else if(as(v,V)){const K=Bt(r,v,e);v=V(K)}else if(v!==void 0&&!v[g]){const K=e.inFixedMemory(this),Wt=new V(v,{fixed:K});if(c&&r.typedArray){const ue=(q=v==null?void 0:v.buffer)==null?void 0:q[Symbol.toStringTag];(ue==="ArrayBuffer"||ue==="SharedArrayBuffer")&&Dn(r,v)}v=Wt}else if(v!==void 0)throw new On(t,v);this[Ht](v)},ot=t.constructor=H(t,{initializer:L,alternateCaster:A,finalizer:O},e),le=function({address:v,length:V}){p.call(this,v),m==null||m.call(this,V)},ae=l!=T.Slice?1:u,an=function(){const v=h.call(this),V=y?y.call(this):a?v?e.findSentinel(v,a.bytes)+1:0:ae;return{address:v,length:V}},un={"*":{get:P,set:I},$:{get:oe,set:L},valueOf:{value:z},toJSON:{value:G},delete:{value:Ws},[Symbol.toPrimitive]:l===T.Primitive&&{value:Gs},[it]:{value:w},[Ht]:{value:S},[Yt]:{value:an},[De]:{value:le},[D]:{value:Js},[$]:{value:N(n)},[yt]:{value:void 0,writable:!0},[F]:{value:Rs}},fn={child:{get:()=>r.constructor},const:{value:i},[j]:{value:s},[_]:{value:n},[B]:{value:t.type}};return Y(ot,un,fn)}function Rs(){const t=this[At],e=Object.getOwnPropertyDescriptor(t.constructor.prototype,"$");e.set=pt,Object.defineProperty(t,"$",e),Object.defineProperty(t,ut,{value:t})}function Ws(){const t=this[x][0];t==null||t.delete()}function Gs(t){return this[x][0][Symbol.toPrimitive](t)}function oe(){return this[zt]}function qs({isActive:t}){this[x][0]&&!t(this)&&(this[x][0]=void 0)}function Js(t,e={}){const{source:n,isActive:s=J,isMutable:o=J}=e;t.call(this,{source:n,isActive:s,isMutable:o})}function Te(t,e){var n;return((n=t==null?void 0:t.constructor)==null?void 0:n.child)===e&&t["*"]}function Xe(t){let e=t[Gt];return e||(Object.defineProperty(t,Gt,{value:void 0,configurable:!0}),e=new Proxy(t,Hs),Object.defineProperty(t,Gt,{value:e})),e}const Ys={get(t,e){return e===At?t:e in t?t[e]:t[it]()[e]},set(t,e,n){if(e in t)t[e]=n;else{const s=t[it]();s[e]=n}return!0},deleteProperty(t,e){if(e in t)delete t[e];else{const n=t[it]();delete n[e]}return!0},has(t,e){if(e in t)return!0;{const n=t[it]();return e in n}}},Hs={get(t,e){if(e===ut)return t;{const n=t[e];return(n==null?void 0:n[ut])===null?Xe(n):n}},set(t,e,n){const s=t[At];if(s&&!(e in s))return t[e]=n,!0;pt()}};function J(){return!0}function Ks(t,e){const{length:n,byteSize:s,align:o,instance:{members:[i]}}=t,{bitSize:c,structure:r}=i,l={};for(let y=0,m=0;y<n;y++,m+=c){const{get:b,set:w}=C({...i,bitOffset:m},e);l[y]={get:b,set:w,configurable:!0}}const a=et(t),u=function(y){if(y instanceof f)this[$](y);else if(y!=null&&y[Symbol.iterator]){let m=y.length;if(typeof m!="number"&&(y=[...y],m=y.length),m!==n)throw new kt(t,this,y);let b=0;for(const w of y)this[Qt][b++].call(this,w)}else if(y&&typeof y=="object"){if(a.call(this,y)===0)throw new rt(t,y)}else if(y!==void 0)throw new rt(t,y)},f=t.constructor=H(t,{initializer:u},e),d=t.typedArray=ft(i),h={...l,$:{get:qe,set:u},length:{value:n},dataView:nt(t),base64:st(t),typedArray:d&&mt(t),valueOf:{value:z},toJSON:{value:G},entries:{value:jt},delete:{value:Q(t)},[Symbol.iterator]:{value:Ze},[at]:{value:jt},[$]:{value:N(s)},[F]:{value:ht}},p={child:{get:()=>r.constructor},[xt]:{value:Ut(t)},[j]:{value:o},[_]:{value:s},[B]:{value:t.type}};return Y(f,h,p)}function Ze(){const t=this,e=this.length;let n=0;return{next(){let s,o;if(n<e){const i=n++;s=t[i],o=!1}else o=!0;return{value:s,done:o}}}}function Xs(){const t=this,e=this.length;let n=0;return{next(){let s,o;if(n<e){const i=n++;s=[i,t[i]],o=!1}else o=!0;return{value:s,done:o}}}}function jt(){return{[Symbol.iterator]:Xs.bind(this),length:this.length}}function Zs(t,e){const{byteSize:n,align:s,instance:{members:o},isTuple:i,hasPointer:c}=t,r={},l=o.filter(S=>!!S.name),a=o.find(S=>!S.name);for(const S of l){const{get:P,set:I}=C(S,e);r[S.name]={get:P,set:I,configurable:!0,enumerable:!0},S.isRequired&&I&&(I.required=!0)}const u=a?C(a,e):null,f=!!o.find(S=>S.type===E.Object),d=et(t),h=function(S){if(S instanceof p)this[$](S),c&&this[D](It,{vivificate:!0,source:S});else if(S&&typeof S=="object")d.call(this,S);else if((typeof S=="number"||typeof S=="bigint")&&u)u.set.call(this,S);else if(S!==void 0)throw new ct(t,"object",S)},p=t.constructor=H(t,{initializer:h},e),y=u?function(S){switch(S){case"string":return Object.prototype.toString.call(this);default:return u.get.call(this)}}:null,m=i&&o.length>0?parseInt(o[o.length-1].name)+1:0,b={$:{get:qe,set:h},dataView:nt(t),base64:st(t),length:i&&{value:m},valueOf:{value:z},toJSON:{value:G},delete:{value:Q(e)},entries:i&&{value:jt},...r,[Symbol.iterator]:{value:i?Ze:Qe},[Symbol.toPrimitive]:u&&{value:y},[at]:{value:i?jt:ie},[$]:{value:N(n)},[W]:f&&{value:re(t)},[D]:c&&{value:ce(t,J)},[F]:{value:ht},[lt]:{value:l.map(S=>S.name)}},w={[j]:{value:s},[_]:{value:n},[B]:{value:t.type},[je]:{value:i}};return Y(p,b,w)}function ie(t){return{[Symbol.iterator]:Qs.bind(this,t),length:this[lt].length}}function Qe(t){return ie.call(this,t)[Symbol.iterator]()}function Qs(t){const e=this,n=this[lt];let s=0;return{next(){let o,i;if(s<n.length){const c=n[s++];o=[c,Pt(()=>e[c],t)],i=!1}else i=!0;return{value:o,done:i}}}}function re(t){const{instance:{members:e}}=t,n={};for(const s of e.filter(o=>o.type===E.Object))n[s.slot]=s;return function(o){const i=n[o],{bitOffset:c,byteSize:r,structure:{constructor:l}}=i,a=this[g],f=a.byteOffset+(c>>3);let d=r;if(d===void 0){if(c&7)throw new Vn(i);d=i.bitSize>>3}const h=new DataView(a.buffer,f,d);return this[x][o]=l.call(Zt,h)}}function ce(t,e={}){const{isChildActive:n=J,isChildMutable:s=J}=e,{instance:{members:o}}=t,i=o.filter(c=>c.structure.hasPointer);return function(r,l={}){var p;const{source:a,vivificate:u=!1,isActive:f=J,isMutable:d=J}=l,h={...l,isActive:y=>f(this)&&n.call(this,y),isMutable:y=>d(this)&&s.call(this,y)};for(const{slot:y}of i){if(a){const b=(p=a[x])==null?void 0:p[y];if(!b)continue;h.source=b}const m=this[x][y]??(u?this[W](y):null);m&&m[D](r,h)}}}function to(t,e){const{type:n,constructor:s,static:{members:o,template:i}}=t,c={};for(const r of o)c[r.name]=C(r,e);if(k(s,{valueOf:{value:z},toJSON:{value:G},...c,[Symbol.iterator]:{value:Qe},[at]:{value:ie},[x]:i&&{value:i[x]},[lt]:!s[lt]&&{value:o.map(r=>r.name)}}),n===T.Enum)for(const{name:r,slot:l}of o)Ke(s,r,s[x][l]);else if(n===T.ErrorSet)for(const{name:r,slot:l}of o)_s(s,r,s[x][l])}function eo(t,e){const{byteSize:n,align:s,instance:{members:o},hasPointer:i,name:c}=t,r=!!o.find(h=>h.type===E.Object),l=o.slice(0,-1).map(h=>h.name),a=l.length,u=t.constructor=function(h,p,y){const m=e.allocateMemory(n,s);if(this[g]=m,r&&(this[x]={}),h.length!==a)throw new Tn(p,a-y,h.length-y);for(const[b,w]of l.entries())try{this[w]=h[b]}catch(S){throw jn(p,b-y,a-y,S)}},f={};for(const h of o)f[h.name]=C(h,e);const d=function(h){return h===this.retval};return k(u.prototype,{...f,[$]:{value:N(n)},[W]:r&&{value:re(t)},[D]:i&&{value:ce(t,{isChildMutable:d})}}),k(u,{[j]:{value:s},[_]:{value:n}}),u}function no(t,e){const{length:n,byteSize:s,align:o,instance:{members:[i]},hasPointer:c}=t,{get:r,set:l}=C(i,e),a=nn(i),u=et(t),f=function(w){if(w instanceof h)this[$](w),c&&this[D](It,{vivificate:!0,source:w});else if(typeof w=="string"&&a&&(w={string:w}),w!=null&&w[Symbol.iterator]){if(w=cn(w),w.length!==n)throw new kt(t,this,w);let S=0;for(const P of w)l.call(this,S++,P)}else if(w&&typeof w=="object"){if(u.call(this,w)===0)throw new rt(t,w)}else if(w!==void 0)throw new rt(t,w)},d=tn,h=t.constructor=H(t,{initializer:f,finalizer:d},e),p=t.typedArray=ft(i),y=i.type===E.Object,m={$:{get:oe,set:f},length:{value:n},dataView:nt(t),base64:st(t),string:a&&Ye(t),typedArray:p&&mt(t),get:{value:r},set:{value:l},entries:{value:Dt},valueOf:{value:z},toJSON:{value:G},delete:{value:Q(e)},[Symbol.iterator]:{value:sn},[at]:{value:Dt},[$]:{value:N(s)},[W]:y&&{value:on(t)},[D]:c&&{value:rn()},[F]:{value:en}},b={child:{get:()=>i.structure.constructor},[xt]:{value:Ut(t)},[j]:{value:o},[_]:{value:s},[B]:{value:t.type}};return Y(h,m,b)}function tn(){const t=new Proxy(this,oo);return Object.defineProperty(this,zt,{value:t}),t}function en(){ht.call(this),Object.defineProperty(this,"set",{value:pt});const t=this.get;Object.defineProperty(this,"get",{value:function(n){var o;const s=t.call(this,n);return(s==null?void 0:s[ut])===null&&((o=s[F])==null||o.call(s)),s}})}function nn(t){return t.type===E.Uint&&[8,16].includes(t.bitSize)}function sn(){const t=this[te]??this,e=this.length;let n=0;return{next(){let s,o;if(n<e){const i=n++;s=t.get(i),o=!1}else o=!0;return{value:s,done:o}}}}function so(t){const e=this[te]??this,n=this.length;let s=0;return{next(){let o,i;if(s<n){const c=s++;o=[c,Pt(()=>e.get(c),t)],i=!1}else i=!0;return{value:o,done:i}}}}function Dt(t){return{[Symbol.iterator]:so.bind(this,t),length:this.length}}function on(t){const{instance:{members:[e]}}=t,{byteSize:n,structure:s}=e;return function(i){const{constructor:c}=s,r=this[g],a=r.byteOffset+n*i,u=new DataView(r.buffer,a,n);return this[x][i]=c.call(Zt,u)}}function rn(t){return function(n,s={}){const{source:o,vivificate:i=!1,isActive:c=J,isMutable:r=J}=s,l={...s,isActive:()=>c(this),isMutable:()=>r(this)};for(let a=0,u=this.length;a<u;a++){o&&(l.source=o==null?void 0:o[x][a]);const f=this[x][a]??(i?this[W](a):null);f&&f[D](n,l)}}}function cn(t){var o;if(typeof t.length=="number")return t;const e=t[Symbol.iterator](),n=e.next(),s=(o=n.value)==null?void 0:o.length;if(typeof s=="number"&&Object.keys(n.value).join()==="length")return Object.assign(function*(){let i;for(;!(i=e.next()).done;)yield i.value}(),{length:s});{const i=[];let c=n;for(;!c.done;)i.push(c.value),c=e.next();return i}}const oo={get(t,e){const n=typeof e=="symbol"?0:e|0;if(n!==0||n==e)return t.get(n);switch(e){case"get":return t[bt]||(t[bt]=t.get.bind(t)),t[bt];case"set":return t[gt]||(t[gt]=t.set.bind(t)),t[gt];case te:return t;default:return t[e]}},set(t,e,n){const s=typeof e=="symbol"?0:e|0;if(s!==0||s==e)t.set(s,n);else switch(e){case"get":t[bt]=n;break;case"set":t[gt]=n;break;default:t[e]=n}return!0},deleteProperty(t,e){const n=typeof e=="symbol"?0:e|0;if(n!==0||n==e)return!1;switch(e){case"get":delete t[bt];break;case"set":delete t[gt];break;default:delete t[e]}return!0},has(t,e){const n=typeof e=="symbol"?0:e|0;return n!==0||n==e?n>=0&&n<t.length:t[e]},ownKeys(t){const e=[];for(let n=0,s=t.length;n<s;n++)e.push(`${n}`);return e.push("length",zt),e},getOwnPropertyDescriptor(t,e){const n=typeof e=="symbol"?0:e|0;if(n!==0||n==e){if(n>=0&&n<t.length)return{value:t.get(n),enumerable:!0,writable:!0,configurable:!0}}else return Object.getOwnPropertyDescriptor(t,e)}};function io(t,e){const{byteSize:n,align:s,instance:{members:o},hasPointer:i}=t,{get:c,set:r}=C(o[0],e),{get:l,set:a}=C(o[1],e),u=function(){if(l.call(this,"number"))throw l.call(this);return c.call(this)},f=o[0].type===E.Void,d=o[1].structure.constructor,h=function(){return!l.call(this,"number")},p=function(){var O;this[be](),(O=this[D])==null||O.call(this,qs)},y=!!o.find(O=>O.type===E.Object),m=et(t),b=function(O){if(O instanceof w)this[$](O),i&&h.call(this)&&this[D](It,{vivificate:!0,source:O});else if(O instanceof d[wt]&&d(O))a.call(this,O),p.call(this);else if(O!==void 0||f)try{r.call(this,O),a.call(this,0,"number")}catch(L){if(O instanceof Error)throw new Oe(t);if(Tt(O))a.call(this,O),p.call(this);else if(O&&typeof O=="object"){if(m.call(this,O)===0)throw L}else throw L}},w=t.constructor=H(t,{initializer:b},e),{bitOffset:S,byteSize:P}=o[0],I={$:{get:u,set:b},dataView:nt(t),base64:st(t),valueOf:{value:z},toJSON:{value:G},delete:{value:Q(e)},[$]:{value:N(n)},[be]:{value:Gn(S/8,P)},[W]:y&&{value:re(t)},[D]:i&&{value:ce(t,{isChildActive:h})},[F]:{value:ht}},A={[j]:{value:s},[_]:{value:n},[B]:{value:t.type}};return Y(w,I,A)}function ro(t,e){const{byteSize:n,align:s,instance:{members:[o]}}=t,{get:i,set:c}=C(o,e),r=et(t),l=function(h){if(h instanceof a)this[$](h);else if(h&&typeof h=="object"){if(r.call(this,h)===0){const p=Ee(o);throw new ct(t,p,h)}}else h!==void 0&&c.call(this,h)},a=t.constructor=H(t,{initializer:l},e),u=t.typedArray=ft(o),f={$:{get:i,set:c},dataView:nt(t),base64:st(t),typedArray:u&&mt(t),valueOf:{value:z},toJSON:{value:G},delete:{value:Q(e)},[Symbol.toPrimitive]:{value:i},[$]:{value:N(n)},[F]:{value:ht}},d={[xt]:{value:Ut(t)},[j]:{value:s},[_]:{value:n},[B]:{value:t.type}};return Y(a,f,d)}function co(t,e){const{align:n,instance:{members:[s]},hasPointer:o}=t,{get:i,set:c}=C(s,e),{byteSize:r,structure:l}=s,a=ao(t,e);a&&(t.sentinel=a);const u=nn(s),f=function(A,O,L=!1){A||(A=e.allocateMemory(O*r,n,L)),this[g]=A,this[Kt]=O},d=function(A,O){if(O!==this[Kt])throw new kt(t,this,A)},h=et(t),p=function(A,O=!1){if(A instanceof m)this[g]?d.call(this,A,A.length):f.call(this,null,A.length,O),this[$](A),o&&this[D](It,{vivificate:!0,source:A});else if(typeof A=="string"&&u)p.call(this,{string:A},O);else if(A!=null&&A[Symbol.iterator]){A=cn(A),this[g]?d.call(this,A,A.length):f.call(this,null,A.length,O);let L=0;for(const ot of A)a==null||a.validateValue(ot,L,A.length),c.call(this,L++,ot)}else if(typeof A=="number")if(!this[g]&&A>=0&&isFinite(A))f.call(this,null,A);else throw new rt(t,A,!this[g]);else if(A&&typeof A=="object"){if(h.call(this,A,O)===0)throw new rt(t,A)}else if(A!==void 0)throw new rt(t,A)},y=tn,m=t.constructor=H(t,{initializer:p,shapeDefiner:f,finalizer:y},e),b=t.typedArray=ft(s),w=s.type===E.Object,S={shapeDefiner:f},P={$:{get:oe,set:p},length:{get:lo},dataView:nt(t,S),base64:st(t,S),string:u&&Ye(t,S),typedArray:b&&mt(t,S),get:{value:i},set:{value:c},entries:{value:Dt},valueOf:{value:z},toJSON:{value:G},delete:{value:Q(e)},[Symbol.iterator]:{value:sn},[at]:{value:Dt},[$]:{value:N(r,!0)},[W]:w&&{value:on(t)},[D]:o&&{value:rn()},[F]:{value:en}},I={child:{get:()=>l.constructor},[xt]:{value:Ut(t)},[j]:{value:n},[_]:{value:r},[B]:{value:t.type}};return Y(m,P,I)}function lo(){return this[Kt]}function ao(t,e){const{runtimeSafety:n=!0}=e,{byteSize:s,instance:{members:[o,i],template:c}}=t;if(!i)return;const{get:r}=C(i,e),l=r.call(c,0),{get:a}=C(o,e),u=n?function(h,p,y){if(h===l&&p!==y-1)throw new fe(t,h,p,y);if(h!==l&&p===y-1)throw new Mt(t,l,p,y)}:function(h,p,y){if(h!==l&&p===y-1)throw new Mt(t,l,y)},f=n?function(h,p){for(let y=0;y<p;y++){const m=a.call(h,y);if(m===l&&y!==p-1)throw new fe(t,l,y,p);if(m!==l&&y===p-1)throw new Mt(t,l,p)}}:function(h,p){if(p*s===h[g].byteLength){const y=p-1;if(a.call(h,y)!==l)throw new Mt(t,l,p)}},d=c[g];return{value:l,bytes:d,validateValue:u,validateData:f}}const U=Array(Object.values(T).length);function Io(){U[T.Primitive]=ro}function Mo(){U[T.Array]=no}function Vo(){U[T.Struct]=Zs}function $o(){U[T.ArgStruct]=eo}function Po(){U[T.ErrorUnion]=io}function jo(){U[T.ErrorSet]=He,bs()}function Do(){U[T.Enum]=Us,ms()}function Co(){U[T.Pointer]=Ls,ps()}function ko(){U[T.Slice]=co}function _o(){U[T.Vector]=Ks}function uo(t){return U[t]}class fo{constructor(){M(this,"context");M(this,"contextStack",[]);M(this,"consolePending",[]);M(this,"consoleTimeout",0);M(this,"viewMap",new WeakMap);M(this,"abandoned",!1);M(this,"released",!1);M(this,"littleEndian",!0);M(this,"runtimeSafety",!0);M(this,"comptime",!1);M(this,"variables",[]);M(this,"imports");M(this,"console",globalThis.console)}startContext(){this.context&&this.contextStack.push(this.context),this.context=new ho}endContext(){this.context=this.contextStack.pop()}allocateMemory(e,n=0,s=!1){return s?this.allocateFixedMemory(e,n):this.allocateRelocMemory(e,n)}allocateRelocMemory(e,n){return this.obtainView(new ArrayBuffer(e),0,e)}registerMemory(e,n=null,s=void 0){const{memoryList:o}=this.context,i=this.getViewAddress(e),c=qt(o,i);return o.splice(c,0,{address:i,dv:e,len:e.byteLength,targetDV:n,targetAlign:s}),i}unregisterMemory(e){const{memoryList:n}=this.context,s=qt(n,e),o=n[s-1];(o==null?void 0:o.address)===e&&n.splice(s-1,1)}findMemory(e,n,s){if(mo(e))if(!n)e=0;else return null;else if(!e&&n)return null;let o=n*(s??0);if(this.context){const{memoryList:i}=this.context,c=qt(i,e),r=i[c-1];if((r==null?void 0:r.address)===e&&r.len===o)return r.targetDV??r.dv;if((r==null?void 0:r.address)<=e&&e<dt(r.address,r.len)){const l=Number(e-r.address),a=r.targetDV??r.dv,u=s===void 0;u&&(o=a.byteLength-l);const f=this.obtainView(a.buffer,a.byteOffset+l,o);return u&&(f[j]=r.targetAlign),f}}return this.obtainFixedView(e,o)}getViewAddress(e){const n=this.getBufferAddress(e.buffer);return dt(n,e.byteOffset)}obtainView(e,n,s){let o=this.viewMap.get(e);if(!o){const r=new DataView(e,n,s);return this.viewMap.set(e,r),r}if(o instanceof DataView){if(o.byteOffset===n&&o.byteLength===s)return o;{const r=o;o={[`${r.byteOffset}:${r.byteLength}`]:r},this.viewMap.set(e,o)}}const i=`${n}:${s}`;let c=o[i];return c||(c=o[i]=new DataView(e,n,s)),c}captureView(e,n,s){if(s){const o=this.allocateRelocMemory(n,0);return n>0&&this.copyBytes(o,e,n),o}else return this.obtainFixedView(e,n)}castView(e,n,s,o){const{constructor:i,hasPointer:c}=o,r=this.captureView(e,n,s),l=i.call(St,r);return c&&this.acquirePointerTargets(l),s&&l[F](),l}finalizeShape(e){const s=uo(e.type)(e,this);typeof s=="function"&&(k(s,{name:{value:e.name,configurable:!0}}),s.prototype.hasOwnProperty(Symbol.toStringTag)||k(s.prototype,{[Symbol.toStringTag]:{value:e.name,configurable:!0}}))}finalizeStructure(e){to(e,this),zs(e,this)}createCaller(e,n){const{name:s,argStruct:o,thunkId:i}=e,{constructor:c}=o,r=this;let l;return n?l=function(...a){return r.invokeThunk(i,new c([this,...a],s,1))}:l=function(...a){return r.invokeThunk(i,new c(a,s,0))},Object.defineProperty(l,"name",{value:s}),l}recreateStructures(e,n){Object.assign(this,n);const s=(c,r)=>{for(const[l,a]of Object.entries(r))c[l]=o(a);return c},o=c=>{var u;const{memory:r,structure:l,actual:a}=c;if(r){if(a)return a;{const{array:f,offset:d,length:h}=r,p=this.obtainView(f.buffer,d,h),{constructor:y}=l,{reloc:m,const:b}=c,w=c.actual=y.call(St,p);return b&&((u=w[F])==null||u.call(w)),c.slots&&s(w[x],c.slots),m!==void 0&&this.variables.push({reloc:m,object:w}),w}}else return l};Fs();const i=new Map;for(const c of e){for(const r of[c.instance,c.static])if(r.template){const l=r.template,a=r.template={};if(l.memory){const{array:u,offset:f,length:d}=l.memory;a[g]=this.obtainView(u.buffer,f,d)}if(l.slots){const u=a[x]={};i.set(u,l.slots)}}this.finalizeShape(c)}for(const[c,r]of i)s(c,r);for(const c of e)this.finalizeStructure(c)}linkVariables(e){const n=[];for(const{object:s,reloc:o}of this.variables)this.linkObject(s,o,e),s[it]&&s[x][0]&&n.push(s);for(const s of n){const o=s[it](),i=this.getViewAddress(o[g]),{length:c=1}=o;s[yt]={address:i,length:c}}}linkObject(e,n,s){if(this.inFixedMemory(e))return;const o=e[g],i=this.recreateAddress(n),c=this.obtainFixedView(i,o.byteLength);if(s){const l=Object.create(e.constructor.prototype);l[g]=c,l[$](e)}e[g]=c;const r=l=>{if(l[x]){for(const a of Object.values(l[x]))if(a){const u=a[g];if(u.buffer===o.buffer){const f=u.byteOffset-o.byteOffset;a[g]=this.obtainView(c.buffer,f,u.byteLength),r(a)}}}};r(e)}unlinkVariables(){for(const{object:e}of this.variables)this.unlinkObject(e)}unlinkObject(e){if(!this.inFixedMemory(e))return;const n=e[g],s=this.allocateMemory(n.byteLength),o=Object.create(e.constructor.prototype);o[g]=s,o[$](e),e[g]=s}releaseFunctions(){const e=()=>{throw new Error("Module was abandoned")};for(const n of Object.keys(this.imports))this[n]&&(this[n]=e)}getSpecialExports(){const e=n=>{if(n===void 0)throw new Error("Not a Zig type");return n};return{init:(...n)=>this.init(...n),abandon:()=>this.abandon(),released:()=>this.released,connect:n=>this.console=n,sizeOf:n=>e(n[_]),alignOf:n=>e(n[j]),typeOf:n=>yn(e(n[B]))}}abandon(){this.abandoned||(this.releaseFunctions(),this.unlinkVariables(),this.abandoned=!0)}writeToConsole(e){const{console:n}=this;try{const s=new Uint8Array(e.buffer,e.byteOffset,e.byteLength).slice(),o=s.lastIndexOf(10);if(o===-1)this.consolePending.push(s);else{const i=s.subarray(0,o),c=s.subarray(o+1),r=[...this.consolePending,i];n.log(vt(r)),this.consolePending=c.length>0?[c]:[]}clearTimeout(this.consoleTimeout),this.consolePending.length>0&&(this.consoleTimeout=setTimeout(()=>{n.log(vt(this.consolePending)),this.consolePending=[]},250))}catch(s){n.error(s)}}flushConsole(){this.consolePending.length>0&&(console.log(vt(this.consolePending)),this.consolePending=[],clearTimeout(this.consoleTimeout))}updatePointerAddresses(e){const n=new Map,s=new Map,o=[],i=this,c=function({isActive:a}){var d;if(!a(this))return;const u=this[At];if(n.get(u))return;const f=u[x][0];if(f&&(n.set(u,f),!i.inFixedMemory(f))){const h=f[g],p=s.get(h.buffer);if(p){const y=Array.isArray(p)?p:[p],m=ln(y,h.byteOffset,b=>b[g].byteOffset);y.splice(m,0,f),Array.isArray(p)||(s.set(h.buffer,y),o.push(y))}else s.set(h.buffer,f);(d=f[D])==null||d.call(f,c)}};e[D](c);const r=this.findTargetClusters(o),l=new Map;for(const a of r)for(const u of a.targets)l.set(u,a);for(const[a,u]of n){const f=l.get(u),{length:d=1}=u;let h=this.getTargetAddress(u,f);h===!1&&(h=this.getShadowAddress(u,f)),a[De]({address:h,length:d})}}findTargetClusters(e){const n=[];for(const s of e){let o=null,i=0,c=0,r=null;for(const l of s){const a=l[g],{byteOffset:u,byteLength:f}=a,d=u+f;let h=!0;o&&(c>u?(r||(r={targets:[o],start:i,end:c,address:void 0,misaligned:void 0},n.push(r)),r.targets.push(l),d>c?r.end=d:h=!1):r=null),h&&(o=l,i=u,c=d)}}return n}createClusterShadow(e){const{start:n,end:s,targets:o}=e;let i=0,c;for(const b of o){const w=b[g],S=w.byteOffset,P=b.constructor[j]??w[j];(i===void 0||P>i)&&(i=P,c=S)}const r=s-n,l=this.allocateShadowMemory(r+i,1),a=this.getViewAddress(l),u=po(dt(a,c-n),i),f=dt(u,n-c),d=l.byteOffset+Number(f-a),h=new DataView(l.buffer,d,r);for(const b of o){const w=b[g],S=w.byteOffset;if(S!==c){const P=b.constructor[j]??w[j];if(yo(dt(f,S-n),P))throw new xn(P,i)}}const p={[$]:N(r)},y=Object.create(p),m=Object.create(p);return y[g]=new DataView(o[0][g].buffer,Number(n),r),m[g]=h,m[Vt]={address:a,len:l.byteLength,align:1},this.addShadow(m,y,1)}getShadowAddress(e,n){if(n){const s=e[g];if(n.address===void 0){const o=this.createClusterShadow(n);n.address=this.getViewAddress(o[g])}return dt(n.address,s.byteOffset-n.start)}else{const s=this.createShadow(e);return this.getViewAddress(s[g])}}createShadow(e){const n=e[g],s=e.constructor[j]??n[j],o=Object.create(e.constructor.prototype),i=o[g]=this.allocateShadowMemory(n.byteLength,s);return o[Vt]={address:this.getViewAddress(i),len:i.byteLength,align:s},this.addShadow(o,e,s)}addShadow(e,n,s){let{shadowMap:o}=this.context;return o||(o=this.context.shadowMap=new Map),o.set(e,n),this.registerMemory(e[g],n[g],s),e}removeShadow(e){const{shadowMap:n}=this.context;if(n){for(const[s]of n)if(s[g]===e){n.delete(s);break}}}updateShadows(){const{shadowMap:e}=this.context;if(e)for(const[n,s]of e)n[$](s)}updateShadowTargets(){const{shadowMap:e}=this.context;if(e)for(const[n,s]of e)s[$](n)}releaseShadows(){const{shadowMap:e}=this.context;if(e)for(const[n]of e){const{address:s,len:o,align:i}=n[Vt];this.freeShadowMemory(s,o,i)}}acquirePointerTargets(e){const n=this,s=new Map,o=function({isActive:i,isMutable:c}){var d,h;const r=this[At];if(s.get(r))return;s.set(r,!0);const l=!r.constructor.const,a=r[x][0];let u,f;if(i(this)){const p=r.constructor.child;if(!a||c(this)){f=r[Yt]();const y=n.findMemory(f.address,f.length,p[_]);u=y?p.call(St,y):null}else u=a}(d=a==null?void 0:a[D])==null||d.call(a,o,{vivificate:!0,isMutable:()=>l}),u!==a&&((h=u==null?void 0:u[D])==null||h.call(u,o,{vivificate:!0,isMutable:()=>l}),r[x][0]=u,n.inFixedMemory(r)&&(r[yt]=f))};e[D](o,{vivificate:!0})}}class ho{constructor(){M(this,"pointerProcessed",new Map);M(this,"memoryList",[]);M(this,"shadowMap",null);M(this,"call",0)}}function ln(t,e,n){let s=0,o=t.length;if(o===0)return 0;for(;s<o;){const i=Math.floor((s+o)/2);n(t[i])<=e?s=i+1:o=i}return o}function qt(t,e){return ln(t,e,n=>n.address)}function yo(t,e){if(e===void 0)return!1;typeof t=="bigint"&&(t=Number(t&0xFFFFFFFFn));const n=e-1;return(t&n)!==0}function po(t,e){let n;return typeof t=="bigint"?(e=BigInt(e),n=~(e-1n)):n=~(e-1),(t&n)+e}function dt(t,e){return t+(typeof t=="bigint"?BigInt(e):e)}function mo(t){return typeof t=="bigint"?t===0xaaaaaaaaaaaaaaaan:t===2863311530}class bo extends fo{constructor(){super(...arguments);M(this,"imports",{getFactoryThunk:{argType:"",returnType:"i"},allocateExternMemory:{argType:"ii",returnType:"i"},freeExternMemory:{argType:"iii"},allocateShadowMemory:{argType:"cii",returnType:"v"},freeShadowMemory:{argType:"ciii"},runThunk:{argType:"iv",returnType:"v"},isRuntimeSafetyActive:{argType:"",returnType:"b"},flushStdout:{argType:"",returnType:""}});M(this,"exports",{allocateHostMemory:{argType:"ii",returnType:"v"},freeHostMemory:{argType:"iii"},captureString:{argType:"ii",returnType:"v"},captureView:{argType:"iib",returnType:"v"},castView:{argType:"iibv",returnType:"v"},readSlot:{argType:"vi",returnType:"v"},writeSlot:{argType:"viv"},getViewAddress:{argType:"v",returnType:"i"},beginDefinition:{returnType:"v"},insertInteger:{argType:"vsi",alias:"insertProperty"},insertBoolean:{argType:"vsb",alias:"insertProperty"},insertString:{argType:"vss",alias:"insertProperty"},insertObject:{argType:"vsv",alias:"insertProperty"},beginStructure:{argType:"v",returnType:"v"},attachMember:{argType:"vvb"},attachMethod:{argType:"vvb"},createTemplate:{argType:"v",returnType:"v"},attachTemplate:{argType:"vvb"},finalizeShape:{argType:"v"},endStructure:{argType:"v"},startCall:{argType:"iv",returnType:"i"},endCall:{argType:"iv",returnType:"i"}});M(this,"nextValueIndex",1);M(this,"valueTable",{0:null});M(this,"valueIndices",new Map);M(this,"memory",null);M(this,"initPromise",null);M(this,"customWASI",null);M(this,"hasCodeSource",!1);M(this,"littleEndian",!0)}async init(n){if(n&&this.hasCodeSource)throw new Error("Cannot set WASI interface after compilation has already begun (consider disabling topLevelAwait)");this.customWASI=n,await this.initPromise}allocateHostMemory(n,s){const o={[j]:s},i=N(n),c=this.allocateRelocMemory(n,s),r=this.allocateShadowMemory(n,s),l={constructor:o,[g]:c,[$]:i},a={constructor:o,[g]:r,[$]:i};return a[Vt]={address:this.getViewAddress(r),len:n,align:s},this.addShadow(a,l,s),r}freeHostMemory(n,s,o){const i=this.findMemory(n,s,1);this.removeShadow(i),this.unregisterMemory(n),this.freeShadowMemory(n,s,o)}getBufferAddress(n){return 0}allocateFixedMemory(n,s){const o=n?this.allocateExternMemory(n,s):0,i=this.obtainFixedView(o,n);return i[j]=s,i}freeFixedMemory(n,s,o){s&&this.freeExternMemory(n,s,o)}obtainFixedView(n,s){n<0&&(n=0);const{memory:o}=this,i=this.obtainView(o.buffer,n,s);return i[g]={memory:o,address:n,len:s},i}releaseFixedView(n){n.buffer;const s=n.byteOffset,o=n.byteLength,i=n[j];i!==void 0&&this.freeFixedMemory(s,o,i)}inFixedMemory(n){return this.memory?(R.call(n),n[g].buffer===this.memory.buffer):!1}copyBytes(n,s,o){const{memory:i}=this,c=new DataView(i.buffer,s,o);_e(o)(n,c)}findSentinel(n,s){const{memory:o}=this,i=s.byteLength,c=o.buffer.byteLength-i+1;for(let r=n;r<c;r+=i){const l=new DataView(o.buffer,r,i);let a=!0;for(let u=0;u<i;u++){const f=l.getUint8(u),d=s.getUint8(u);if(f!==d){a=!1;break}}if(a)return(r-n)/i}}captureString(n,s){const{buffer:o}=this.memory,i=new Uint8Array(o,n,s);return vt(i)}getTargetAddress(n,s){return this.inFixedMemory(n)?this.getViewAddress(n[g]):n[g].byteLength===0?0:!1}clearExchangeTable(){this.nextValueIndex!==1&&(this.nextValueIndex=1,this.valueTable={0:null},this.valueIndices=new Map)}getObjectIndex(n){if(n){let s=this.valueIndices.get(n);return s===void 0&&(s=this.nextValueIndex++,this.valueIndices.set(n,s),this.valueTable[s]=n),s}else return 0}fromWebAssembly(n,s){switch(n){case"v":case"s":return this.valueTable[s];case"i":return s;case"b":return!!s}}toWebAssembly(n,s){switch(n){case"v":case"s":return this.getObjectIndex(s);case"i":return s;case"b":return s?1:0}}exportFunction(n,s="",o=""){return n?(...i)=>{i=i.map((r,l)=>this.fromWebAssembly(s.charAt(l),r));const c=n.apply(this,i);return this.toWebAssembly(o,c)}:()=>{}}importFunction(n,s="",o=""){let i=!1;return s.startsWith("c")&&(i=!0,s=s.slice(1)),(...c)=>{c=c.map((l,a)=>this.toWebAssembly(s.charAt(a),l)),i&&(c=[this.context.call,...c]);const r=n.apply(this,c);return this.fromWebAssembly(o,r)}}exportFunctions(){const n={};for(const[s,{argType:o,returnType:i,alias:c}]of Object.entries(this.exports)){const r=this[c??s];n[`_${s}`]=this.exportFunction(r,o,i)}return n}importFunctions(n){for(const[s,o]of Object.entries(n)){const i=this.imports[s];if(i){const{argType:c,returnType:r}=i;this[s]=this.importFunction(o,c,r)}}}async instantiateWebAssembly(n){const s=await n;this.hasCodeSource=!0;const o={env:this.exportFunctions(),wasi_snapshot_preview1:this.getWASIImport()};return s[Symbol.toStringTag]==="Response"?WebAssembly.instantiateStreaming(s,o):WebAssembly.instantiate(s,o)}loadModule(n){return this.initPromise=(async()=>{var c,r;const{instance:s}=await this.instantiateWebAssembly(n),{memory:o,_initialize:i}=s.exports;this.importFunctions(s.exports),this.trackInstance(s),(r=(c=this.customWASI)==null?void 0:c.initialize)==null||r.call(c,s),this.runtimeSafety=this.isRuntimeSafetyActive(),this.memory=o,i==null||i()})()}trackInstance(n){const s=new WeakRef(n);Object.defineProperty(this,"released",{get:()=>!s.deref(),enumerable:!0})}linkVariables(n){this.initPromise&&(this.initPromise=this.initPromise.then(()=>super.linkVariables(n)))}getMemoryOffset(n){return n}recreateAddress(n){return n}startCall(n,s){this.startContext(),this.context.call=n,s[D]&&this.updatePointerAddresses(s);const o=this.getShadowAddress(s);return this.updateShadows(),o}endCall(n,s){this.updateShadowTargets(),s[D]&&this.acquirePointerTargets(s),this.releaseShadows(),this.endContext(),!this.context&&this.flushConsole&&(this.flushStdout(),this.flushConsole())}async runThunk(n,s){return await this.initPromise,this.runThunk(n,s)}invokeThunk(n,s){try{const o=this.runThunk(n,s);if(o){if(o[Symbol.toStringTag]==="Promise")return o.then(i=>(i&&this.handleError(i),s.retval),i=>{this.handleError(i)});throw o}return s.retval}catch(o){this.handleError(o)}}handleError(n){if(typeof n=="string")throw new Ie(n);if(n instanceof ye&&n.code===0)return;throw n}getWASIImport(){if(this.customWASI)return this.customWASI.wasiImport;{const o=()=>38;return{args_get:o,args_sizes_get:o,clock_res_get:o,clock_time_get:o,environ_get:o,environ_sizes_get:o,fd_advise:o,fd_allocate:o,fd_close:o,fd_datasync:o,fd_pread:o,fd_pwrite:o,fd_read:o,fd_readdir:o,fd_renumber:o,fd_seek:o,fd_sync:o,fd_tell:o,fd_write:(i,c,r,l)=>{if(i===1||i===2){const a=new DataView(this.memory.buffer);let u=0;for(let f=0,d=c;f<r;f++,d+=8){const h=a.getUint32(d,!0),p=a.getUint32(d+4,!0);if(p>0){const y=new DataView(this.memory.buffer,h,p);this.writeToConsole(y),u+=p}}return a.setUint32(l,u,!0),0}else return 38},fd_fdstat_get:o,fd_fdstat_set_flags:o,fd_fdstat_set_rights:o,fd_filestat_get:o,fd_filestat_set_size:o,fd_filestat_set_times:o,fd_prestat_get:()=>8,fd_prestat_dir_name:o,path_create_directory:o,path_filestat_get:o,path_filestat_set_times:o,path_link:o,path_open:o,path_readlink:o,path_remove_directory:o,path_rename:o,path_symlink:o,path_unlink_file:o,poll_oneoff:o,proc_exit:i=>{throw new ye(i)},random_get:(i,c)=>{const r=new DataView(this.memory.buffer,i,c);for(let l=0;l<c;l++)r.setUint8(l,Math.floor(256*Math.random()));return 0},sched_yield:o,sock_accept:o,sock_recv:o,sock_send:o,sock_shutdown:o}}}}function Fo(t){return new bo}export{Mo as a,Co as b,Vo as c,_o as d,ko as e,Do as f,jo as g,Po as h,$o as i,Fo as j,Eo as k,ps as l,Ao as m,xo as n,To as o,wo as p,vo as q,So as r,Io as u};
