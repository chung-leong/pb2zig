var In=Object.defineProperty;var Vn=(e,t,n)=>t in e?In(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var P=(e,t,n)=>(Vn(e,typeof t!="symbol"?t+"":t,n),n);const O={Void:0,Bool:1,Int:2,Uint:3,Float:4,Object:5,Type:6,Comptime:7,Static:8,Literal:9,Null:10,Undefined:11,Unsupported:12},v={Primitive:0,Array:1,Struct:2,ExternStruct:3,PackedStruct:4,ArgStruct:5,VariadicStruct:6,ExternUnion:7,BareUnion:8,TaggedUnion:9,ErrorUnion:10,ErrorSet:11,Enum:12,Optional:13,SinglePointer:14,SlicePointer:15,MultiPointer:16,CPointer:17,Slice:18,Vector:19,Opaque:20,Function:21},le={Normal:0,Scratch:1};function pe(e){const{type:t,bitSize:n,byteSize:s}=e;if(t===O.Int)return`${n<=32?"":"Big"}Int${n}`;if(t===O.Uint)return`${n<=32?"":"Big"}Uint${n}`;if(t===O.Float)return`Float${n}`;if(t===O.Bool)return`Bool${s!==void 0?s*8:1}`;if(t===O.Void)return"Null"}function Pn(e){for(const[t,n]of Object.entries(v))if(n===e)return t.replace(/\B[A-Z]/g,s=>` ${s}`).toLowerCase()}function Mn(e){const{type:t,bitSize:n}=e,s=t===O.Int;let i=s?n-1:n;if(n<=32){const o=2**i-1;return{min:s?-(2**i):0,max:o}}else{i=BigInt(i);const o=2n**i-1n;return{min:s?-(2n**i):0n,max:o}}}function Re({type:e,bitSize:t}){if(e===O.Int||e===O.Uint)return t<=32?Number:BigInt;if(e===O.Float)return Number;if(e===O.Bool)return Boolean}function Be(e){const t=Re(e);if(t)return typeof t(0)}function Ie(e){switch(e){case v.SinglePointer:case v.SlicePointer:case v.MultiPointer:case v.CPointer:return!0;default:return!1}}function $n(e){return e===v.Array||e===v.Vector||e===v.Slice}function Ue({bitOffset:e,bitSize:t,byteSize:n}){return n!==void 0||!(e&7)&&!(t&7)||t===0}function Ct(e){return typeof e=="object"&&typeof e.error=="string"&&Object.keys(e).length===1}class jn extends ReferenceError{constructor(t){super(`Invalid memory deallocation: @${t.toString(16)}`)}}class Dn extends TypeError{constructor(t){const{name:n}=t;super(`An initializer must be provided to the constructor of ${n}, even when the intended value is undefined`)}}class Le extends TypeError{constructor(t,n,s=null){const{name:i,type:o,byteSize:r}=t,c=n.byteLength,l=r!==1?"s":"";let a;if(o===v.Slice&&!s)a=`${i} has elements that are ${r} byte${l} in length, received ${c}`;else{const f=o===v.Slice?s.length*r:r;a=`${i} has ${f} byte${l}, received ${c}`}super(a)}}class Cn extends TypeError{constructor(t){const{type:n,byteSize:s,typedArray:i}=t,o=s!==1?"s":"",r=["ArrayBuffer","DataView"].map(ct);i&&r.push(ct(i.name));let c;n===v.Slice?c=`Expecting ${ae(r)} that can accommodate items ${s} byte${o} in length`:c=`Expecting ${ae(r)} that is ${s} byte${o} in length`,super(c)}}class kn extends TypeError{constructor(t,n){const{name:s}=t;let i;typeof n=="number"||typeof n=="bigint"?i=`Value given does not correspond to an item of enum ${s}: ${n}`:i=`Enum item of the type ${s} expected, received ${n}`,super(i)}}class _n extends TypeError{constructor(t,n){const{name:s}=t,i=typeof n;let o;i==="string"||i==="number"||Ct(n)?(Ct(n)&&(n=`{ error: ${JSON.stringify(n.error)} }`),o=`Error ${i} does not corresponds to any error in error set ${s}: ${n}`):o=`Error of the type ${s} expected, received ${n}`,super(o)}}class We extends TypeError{constructor(t){const{name:n}=t;super(`Error given is not a part of error set ${n}`)}}class bt extends TypeError{constructor(t,n,s){const{name:i}=t,o=[];if(Array.isArray(n))for(const c of n)o.push(ct(c));else o.push(ct(n));const r=Je(s);super(`${i} expects ${ae(o)} as argument, received ${r}`)}}class pt extends bt{constructor(t,n,s=!1){var a;const{instance:{members:[i]},type:o,typedArray:r}=t,c=[],l=Be(i);if(l){let f;switch((a=i.structure)==null?void 0:a.type){case v.Enum:f="enum item";break;case v.ErrorSet:f="error";break;default:f=l}c.push(`array of ${f}s`)}else c.push("array of objects");r&&c.push(r.name),o===v.Slice&&s&&c.push("length"),super(t,c.join(" or "),n)}}class Jt extends TypeError{constructor(t,n,s){const{name:i,length:o,instance:{members:[r]}}=t,{structure:{constructor:c}}=r,{length:l,constructor:a}=s,f=(n==null?void 0:n.length)??o,u=f!==1?"s":"";let d;a===c?d="only a single one":a.child===c?d=`a slice/array that has ${l}`:d=`${l} initializer${l>1?"s":""}`,super(`${i} has ${f} element${u}, received ${d}`)}}class Ve extends TypeError{constructor(t,n){t<0?super("Length of slice cannot be negative"):super(`Length of slice can be ${n} or less, received ${t}`)}}class Fn extends TypeError{constructor(t,n){const{name:s}=t;super(`Missing initializers for ${s}: ${n.join(", ")}`)}}class zn extends TypeError{constructor(t,n){const{name:s,instance:{members:i}}=t,o=i.find(c=>c.name===n);let r;o?r=`Comptime value cannot be changed: ${n}`:r=`${s} does not have a property with that name: ${n}`,super(r)}}class Nn extends Error{constructor(t,n,s){const i=n!==1?"s":"";super(`${t}() expects ${n} argument${i}, received ${s}`)}}class Rn extends TypeError{constructor(t){super("Non-slice pointers can only be created with the help of the new operator")}}class Bn extends TypeError{constructor(t,n){const{name:s}=t,{constructor:{name:i}}=n;super(`Conversion of ${i} to ${s} requires an explicit cast`)}}class Pe extends TypeError{constructor(t,n,s,i){const{name:o}=t;super(`${o} expects the sentinel value ${n} at ${i-1}, found at ${s}`)}}class Nt extends TypeError{constructor(t,n,s){const{name:i}=t;super(`${i} expects the sentinel value ${n} at ${s-1}`)}}class Un extends TypeError{constructor(t,n){super(`Unable to simultaneously align memory to ${n}-byte and ${t}-byte boundary`)}}class Ht extends TypeError{constructor(t,n){const s=Je(n);super(`Expected ${ct(t)}, received ${s}`)}}class Ln extends TypeError{constructor(){super("Null pointer")}}class Wn extends TypeError{constructor(t,n){const{name:s}=t;let i;if(n!=null){const o=typeof n,r=o==="object"&&n.constructor!==Object?`${n.constructor.name} object`:o;i=`${He(r)} ${r}`}else i=n+"";super(`${s} cannot point to ${i}`)}}class Gn extends TypeError{constructor(t,n){super("Pointers in fixed memory cannot point to garbage-collected object")}}class qn extends TypeError{constructor(t,n){const s=pe(t);super(`${s} cannot represent the value given: ${n}`)}}class Me extends RangeError{constructor(t,n){const{name:s}=t;super(`Index exceeds the size of ${s??"array"}: ${n}`)}}class Jn extends TypeError{constructor(t){const{name:n,structure:{name:{struct:s}}}=t;super(`Unable to create ${s} as it is not situated on a byte boundary: ${n}`)}}class Hn extends TypeError{constructor(){super("Unable to modify read-only object")}}class Yn extends TypeError{constructor(t){const{name:n}=t;super(`${n} cannot point to a read-only object`)}}class Ge extends Error{constructor(t){super(qe(t))}}class $e extends Ge{constructor(t){super("Program exited"),this.code=t}}function Kn(e,t,n,s){const i=`args[${t}]`,o=t!==0?"..., ":"",r=t!==n-1?", ...":"",c=o+i+r,l=Object.create(s.constructor.prototype);return l.message=`${e}(${c}): ${s.message}`,l.stack=s.stack,l}function je(e,t,n){return n instanceof RangeError&&!(n instanceof Me)&&(n=new Me(e,t)),n}function xt(){throw new Hn}function Xn(e,t){const n=ct(e.typedArray.name),s=ct(t.constructor.name);console.warn(`Implicitly creating ${n} from ${s}`)}function qe(e){let t=e.replace(/_/g," ");try{t=t.replace(/(\p{Uppercase}+)(\p{Lowercase}*)/gu,(n,s,i)=>s.length===1?` ${s.toLocaleLowerCase()}${i}`:i?n:` ${s}`).trimStart()}catch{}return t.charAt(0).toLocaleUpperCase()+t.substring(1)}function Je(e){const t=typeof e;let n;return t==="object"?n=e?Object.prototype.toString.call(e):"null":n=t,ct(n)}function ct(e){return`${He(e)} ${e}`}function He(e){return/^\W*[aeiou]/i.test(e)?"an":"a"}function ae(e,t="or"){const n=` ${t} `;return e.length>2?e.slice(0,-1).join(", ")+n+e[e.length-1]:e.join(n)}const g=Symbol("memory"),I=Symbol("slots"),be=Symbol("parent"),j=Symbol("fixed"),Ye=Symbol("name"),G=Symbol("type"),Ke=Symbol("tuple"),$t=Symbol("class"),De=Symbol("tag"),mt=Symbol("props"),Yt=Symbol("getter"),Kt=Symbol("setter"),Pt=Symbol("elementGetter"),Mt=Symbol("elementSetter"),K=Symbol("targetGetter"),fe=Symbol("targetSetter"),gt=Symbol("entriesGetter"),ue=Symbol("addressSetter"),he=Symbol("lengthSetter"),Xe=Symbol("targetUpdater"),Rt=Symbol("maxLength"),Xt=Symbol("propSetters"),U=Symbol("memoryRestorer"),q=Symbol("writeDisabler"),Ze=Symbol("allKeys"),Bt=Symbol("address"),yt=Symbol("length"),Zt=Symbol("proxy"),kt=Symbol("compat"),Qe=Symbol("cache"),J=Symbol("size"),Zn=Symbol("bitSize"),_=Symbol("align"),me=Symbol("array"),wt=Symbol("pointer"),St=Symbol("constTarget"),re=Symbol("constProxy"),D=Symbol("copier"),Ce=Symbol("resetter"),X=Symbol("vivificator"),k=Symbol("pointerVisitor"),jt=Symbol("environment"),Qn=Symbol("attributes"),tn=Symbol("more"),ts=Symbol("primitive");function lt(e){return function(){const t=this[g];this[g]=null,this[I]&&(this[I]={}),e.releaseFixedView(t)}}function ke(e,t,n){if(e+t<=8){const s=2**t-1;if(n)return function(i,o,r){const l=o.getUint8(r)>>e&s;i.setUint8(0,l)};{const i=255^s<<e;return function(o,r,c){const l=r.getUint8(0),f=o.getUint8(c)&i|(l&s)<<e;o.setUint8(c,f)}}}else{const s=8-e,i=2**s-1;if(n){const r=2**(t%8)-1;return function(c,l,a){let f=a,u=0,d=l.getUint8(f++),b,m=d>>e&i,h=s,p=t;do p>h&&(d=l.getUint8(f++),m=m|d<<h),b=p>=8?m&255:m&r,c.setUint8(u++,b),m>>=8,p-=8;while(p>0)}}else{const r=2**((t-s)%8)-1,c=255^i<<e,l=255^r;return function(a,f,u){let d=0,b=u,m=a.getUint8(b),h,p,w=m&c,S=e,M=t+S;do M>S&&(h=f.getUint8(d++),w=w|h<<S,S+=8),M>=8?p=w&255:(m=a.getUint8(b),p=m&l|w&r),a.setUint8(b++,p),w>>=8,S-=8,M-=8;while(M>0)}}}}function H(e,t=!1){const n=ge(e,t);return function(s){var r,c;(r=this[U])==null||r.call(this),(c=s[U])==null||c.call(s);const i=s[g],o=this[g];n(o,i)}}function ge(e,t=!1){if(e!==void 0){if(!t){const n=ns[e];if(n)return n}return e&7?e&3?e&1?ss:is:os:rs}else return es}function es(e,t){ge(e.byteLength)(e,t)}const ns={1:cs,2:ls,4:as,8:fs,16:us,32:hs};function ss(e,t){for(let n=0,s=e.byteLength;n<s;n++)e.setInt8(n,t.getInt8(n))}function is(e,t){for(let n=0,s=e.byteLength;n<s;n+=2)e.setInt16(n,t.getInt16(n,!0),!0)}function os(e,t){for(let n=0,s=e.byteLength;n<s;n+=4)e.setInt32(n,t.getInt32(n,!0),!0)}function rs(e,t){for(let n=0,s=e.byteLength;n<s;n+=8)e.setInt32(n,t.getInt32(n,!0),!0),e.setInt32(n+4,t.getInt32(n+4,!0),!0)}function cs(e,t){e.setInt8(0,t.getInt8(0))}function ls(e,t){e.setInt16(0,t.getInt16(0,!0),!0)}function as(e,t){e.setInt32(0,t.getInt32(0,!0),!0)}function fs(e,t){e.setInt32(0,t.getInt32(0,!0),!0),e.setInt32(4,t.getInt32(4,!0),!0)}function us(e,t){e.setInt32(0,t.getInt32(0,!0),!0),e.setInt32(4,t.getInt32(4,!0),!0),e.setInt32(8,t.getInt32(8,!0),!0),e.setInt32(12,t.getInt32(12,!0),!0)}function hs(e,t){e.setInt32(0,t.getInt32(0,!0),!0),e.setInt32(4,t.getInt32(4,!0),!0),e.setInt32(8,t.getInt32(8,!0),!0),e.setInt32(12,t.getInt32(12,!0),!0),e.setInt32(16,t.getInt32(16,!0),!0),e.setInt32(20,t.getInt32(20,!0),!0),e.setInt32(24,t.getInt32(24,!0),!0),e.setInt32(28,t.getInt32(28,!0),!0)}function ds(e,t){const n=ys(t);return function(){var i;(i=this[U])==null||i.call(this);const s=this[g];n(s,e,t)}}function ys(e){const t=ps[e];return t||(e&7?e&3?e&1?bs:ms:gs:ws)}const ps={1:Ss,2:vs,4:As,8:Ts,16:Es,32:xs};function bs(e,t,n){for(let s=t,i=t+n;s<i;s++)e.setInt8(s,0)}function ms(e,t,n){for(let s=t,i=t+n;s<i;s+=2)e.setInt16(s,0,!0)}function gs(e,t,n){for(let s=t,i=t+n;s<i;s+=4)e.setInt32(s,0,!0)}function ws(e,t,n){for(let s=t,i=t+n;s<i;s+=8)e.setInt32(s,0,!0),e.setInt32(s+4,0,!0)}function Ss(e,t){e.setInt8(t,0)}function vs(e,t){e.setInt16(t,0,!0)}function As(e,t){e.setInt32(t,0,!0)}function Ts(e,t){e.setInt32(t+0,0,!0),e.setInt32(t+4,0,!0)}function Es(e,t){e.setInt32(t+0,0,!0),e.setInt32(t+4,0,!0),e.setInt32(t+8,0,!0),e.setInt32(t+12,0,!0)}function xs(e,t){e.setInt32(t+0,0,!0),e.setInt32(t+4,0,!0),e.setInt32(t+8,0,!0),e.setInt32(t+12,0,!0),e.setInt32(t+16,0,!0),e.setInt32(t+20,0,!0),e.setInt32(t+24,0,!0),e.setInt32(t+28,0,!0)}function Lt(e,t){return _s(e,t,n=>DataView.prototype[n]?DataView.prototype[n]:Os(e,t))}const en={};function zi(){en[O.Uint]=Is}function Os(e,t){const n=en[t.type];return n(e,t)}function Is(e,t){return Ue(t)?Ds(e,t):Cs(e,t)}function Qt(e,t,n){const{type:s,byteSize:i,typedArray:o}=e;let r;const c=t==null?void 0:t[Symbol.toStringTag];if(c==="DataView")r=n.registerView(t);else if(c==="ArrayBuffer"||c==="SharedArrayBuffer")r=n.obtainView(t,0,t.byteLength);else if(o&&c===o.name||c==="Uint8ClampedArray"&&o===Uint8Array)r=n.obtainView(t.buffer,t.byteOffset,t.byteLength);else if(c==="Uint8Array"&&typeof Buffer=="function"&&t instanceof Buffer)r=n.obtainView(t.buffer,t.byteOffset,t.byteLength);else{const l=t==null?void 0:t[g];if(l){const{constructor:a,instance:{members:[f]}}=e;if(t instanceof a)return l;if($n(s)){const{byteSize:u,structure:{constructor:d}}=f,b=sn(t,d);if(b!==void 0){if(s===v.Slice||b*u===i)return l;throw new Jt(e,null,t)}}}}return r&&i!==void 0&&nn(r,e),r}function Vs(e){if((e==null?void 0:e[Symbol.toStringTag])!=="DataView")throw new Ht("a DataView",e);return e}function nn(e,t){const{byteSize:n,type:s}=t;if(!(s===v.Slice?e.byteLength%n===0:e.byteLength===n))throw new Le(t,e)}function _t(e,t,n,s,i){const{byteSize:o,type:r,sentinel:c}=t,l=o??1;if(this[g]){const a=r===v.Slice?l*this.length:l;if(e.byteLength!==a)throw new Le(t,e,this);const f={[g]:e};c==null||c.validateData(f,this.length),this[D](f)}else{const{shapeDefiner:a}=i;o!==void 0&&nn(e,t);const f=e.byteLength/l,u={[g]:e};c==null||c.validateData(u,f),s&&(n=!0),a.call(this,n?null:e,f,s),n&&this[D](u)}}function sn(e,t){const{constructor:n}=e;if(n===t)return 1;if(n.child===t)return e.length}function Ps(e,t,n){const s=Qt(e,t,n);if(!s)throw new Cn(e);return s}function vt(e){const{type:t,byteSize:n}=e;if(t===O.Int)switch(n){case 1:return Int8Array;case 2:return Int16Array;case 4:return Int32Array;case 8:return BigInt64Array}else if(t===O.Uint)switch(n){case 1:return Uint8Array;case 2:return Uint16Array;case 4:return Uint32Array;case 8:return BigUint64Array}else if(t===O.Float)switch(n){case 4:return Float32Array;case 8:return Float64Array}else if(t===O.Object)return e.structure.typedArray;return null}function Ms(e,t){const n=e==null?void 0:e[Symbol.toStringTag];return!!t&&n===t.name}function $s(e,t){if(e){const n=t[kt];if(n){const s=e==null?void 0:e[Symbol.toStringTag];if(n.includes(s))return!0}if(t.child&&sn(e,t.child)!==void 0)return!0}return!1}function te(e){const{typedArray:t}=e,n=[];return t&&(n.push(t.name),n.push("DataView"),(t===Uint8Array||t===Int8Array)&&(n.push("ArrayBuffer"),n.push("SharedArrayBuffer"),t===Uint8Array&&n.push("Uint8ClampedArray"))),n}function js(e){const t=DataView.prototype.getBigUint64,n=DataView.prototype.setBigUint64,s=Math.ceil(e/64);return{get:function(i,o){let r=0n;if(o)for(let c=0,l=i+(s-1)*8;c<s;c++,l-=8){const a=t.call(this,l,o);r=r<<64n|a}else for(let c=0,l=i;c<s;c++,l+=8){const a=t.call(this,l,o);r=r<<64n|a}return r},set:function(i,o,r){let c=o;const l=0xFFFFFFFFFFFFFFFFn;if(r)for(let a=0,f=i;a<s;a++,f+=8){const u=c&l;n.call(this,f,u,r),c>>=64n}else{c<<=BigInt(s*64-e);for(let a=0,f=i+(s-1)*8;a<s;a++,f-=8){const u=c&l;n.call(this,f,u,r),c>>=64n}}return c}}}function Ds(e,t){const{bitSize:n,byteSize:s}=t;if(n<64){const i=pe({...t,bitSize:s*8}),o=DataView.prototype[`get${i}`],r=DataView.prototype[`set${i}`],c=n<=32?2**n-1:2n**BigInt(n)-1n;return e==="get"?function(l,a){return o.call(this,l,a)&c}:function(l,a,f){const u=a&c;r.call(this,l,u,f)}}else{const{get:i,set:o}=js(n),r=2n**BigInt(n)-1n;return e==="get"?function(c,l){return i.call(this,c,l)&r}:function(c,l,a){const f=l&r;o.call(this,c,f,a)}}}function Cs(e,t){const{bitSize:n,bitOffset:s}=t,i=s&7;if(i+n<=8){const o=DataView.prototype.setUint8,r=DataView.prototype.getUint8,c=2**n-1;if(e==="get")return function(l){return r.call(this,l)>>>i&c};{const l=255^c<<i;return function(a,f){const d=r.call(this,a)&l|(f&c)<<i;o.call(this,a,d)}}}return ks(e,t)}function ks(e,t){const{bitSize:n,bitOffset:s}=t,i=s&7,o=[1,2,4,8].find(c=>c*8>=n)??Math.ceil(n/64)*64,r=new DataView(new ArrayBuffer(o));if(e==="get"){const c=Lt("get",{...t,byteSize:o}),l=ke(i,n,!0);return function(a,f){return l(r,this,a),c.call(r,0,f)}}else{const c=Lt("set",{...t,byteSize:o}),l=ke(i,n,!1);return function(a,f,u){c.call(r,0,f,u),l(this,r,a)}}}const _e={};function _s(e,t,n){const{type:s,bitOffset:i,bitSize:o,structure:r}=t,c=i&7,l=pe(t),a=Ue(t)?"":`Bit${c}`,f=s===O.Int||s===O.Uint;let u=`${e}${l}${a}`,d=!1,b=u;if(f&&o===64){const h=r==null?void 0:r.name;(h==="usize"||h==="isize")&&(u+="Size",d=!0)}let m=_e[u];if(!m){if(f&&e==="set"){const h=Re(t),p=n(b);m=function(w,S,M){p.call(this,w,h(S),M)}}else if(d&&e==="get"){const h=n(b),p=BigInt(Number.MIN_SAFE_INTEGER),w=BigInt(Number.MAX_SAFE_INTEGER);m=function(S,M){const E=h.call(this,S,M);return p<=E&&E<=w?Number(E):E}}else m=n(u);m&&m.name!==u&&Object.defineProperty(m,"name",{value:u,configurable:!0,writable:!1}),_e[u]=m}return m}function Fs({type:e}){switch(e){case O.Type:case O.Comptime:case O.Literal:return!0;default:return!1}}const Ot={};function on(){Ot[O.Uint]=Bs}function Ni(){Ot[O.Float]=Ls}function Ri(){Ot[O.Object]=Js}function Bi(){Ot[O.Type]=Ys}function Ui(){Ot[O.Comptime]=Ks}const we={};function zs(){we[v.Enum]=Ws}function Ns(){we[v.ErrorSet]=Gs}function R(e,t){const n=Ot[e.type];return n(e,t)}function Rs(e,t){const{structure:n}=t,s=we[n==null?void 0:n.type];return s?s(e,n):e}function Bs(e,t){const n=Us(t,Lt),s=ln(e,t,n);return Rs(s,e)}function Us(e,t){return function(n,s){const{runtimeSafety:i=!0}=e,o=t(n,s);if(i&&n==="set"){const{min:r,max:c}=Mn(s);return function(l,a,f){if(a<r||a>c)throw new qn(s,a);o.call(this,l,a,f)}}return o}}function Ls(e,t){return ln(e,t,Lt)}function Ws(e,t){const n=function(s){const{constructor:i}=t,o=i(s);if(!o)throw new kn(t,s);return o};return{get:e.get.length===0?function(i){const o=e.get.call(this);return i==="number"?o:n(o)}:function(i){const o=e.get.call(this,i);return n(o)},set:e.set.length===1?function(i,o){o!=="number"&&(i=n(i)[Symbol.toPrimitive]()),e.set.call(this,i)}:function(i,o){const r=n(o);e.set.call(this,i,r[Symbol.toPrimitive]())}}}function Gs(e,t){const n=function(s){const{constructor:i}=t,o=i(s);if(!o)throw s instanceof Error?new We(t):new _n(t,s);return o};return{get:e.get.length===0?function(i){const o=e.get.call(this);return i==="number"?o:n(o)}:function(i){const o=e.get.call(this,i);return n(o)},set:e.set.length===1?function(i,o){if(o!=="number"){const r=n(i);i=Number(r)}e.set.call(this,i)}:function(i,o){const r=n(o);o=Number(r),e.set.call(this,i,o)}}}function Se(e){switch(e==null?void 0:e.type){case v.Primitive:case v.ErrorUnion:case v.Optional:case v.Enum:case v.ErrorSet:return!0;default:return!1}}function rn(e){return(this[I][e]??this[X](e))[Yt]()}function cn(e){return this[I][e]??this[X](e)}function qs(e,t){(this[I][e]??this[X](e))[Kt](t)}function ve(e,{get:t,set:n}){return e!==void 0?{get:function(){return t.call(this,e)},set:n?function(s){return n.call(this,e,s)}:void 0}:{get:t,set:n}}function Js(e,t){const{structure:n,slot:s}=e;return ve(s,{get:Se(n)?rn:cn,set:qs})}function Hs(e){const t=this[I][e];return t==null?void 0:t.constructor}function Ys(e,t){const{slot:n}=e;return ve(n,{get:Hs})}function Ks(e,t){const{slot:n,structure:s}=e;return ve(n,{get:Se(s)?rn:cn})}function ln(e,t,n){const{littleEndian:s=!0}=t,{bitOffset:i,byteSize:o}=e,r=n("get",e),c=n("set",e);if(i!==void 0){const l=i>>3;return{get:function(){try{return r.call(this[g],l,s)}catch(f){if(f instanceof TypeError&&this[U]())return r.call(this[g],l,s);throw f}},set:function(f){try{return c.call(this[g],l,f,s)}catch(u){if(u instanceof TypeError&&this[U]())return c.call(this[g],l,f,s);throw u}}}}else return{get:function(a){try{return r.call(this[g],a*o,s)}catch(f){if(f instanceof TypeError&&this[U]())return r.call(this[g],a*o,s);throw je(e,a,f)}},set:function(a,f){try{return c.call(this[g],a*o,f,s)}catch(u){if(u instanceof TypeError&&this[U]())return c.call(this[g],a*o,f,s);throw je(e,a,u)}}}}function de(e,t,n){if(n){const{set:s,get:i,value:o,enumerable:r,configurable:c=!0,writable:l=!0}=n;Object.defineProperty(e,t,i?{get:i,set:s,configurable:c,enumerable:r}:{value:o,configurable:c,enumerable:r,writable:l})}}function L(e,t){for(const[n,s]of Object.entries(t))de(e,n,s);for(const n of Object.getOwnPropertySymbols(t)){const s=t[n];de(e,n,s)}}function st(e,t,n,s){const i={};for(const[c,l]of Object.entries(t))l!=null&&l.set&&c!=="$"&&(i[c]=l.set);const{get:o,set:r}=t.$;return L(e.prototype,{[Ze]:{value:Object.keys(i)},[Kt]:{value:r},[Yt]:{value:o},[Xt]:{value:i},[St]:{value:null},[U]:{value:Ae(e[Qe],s)},...t}),L(e,n),e}function At(){const e=Object.getOwnPropertyDescriptors(this.constructor.prototype);for(const[t,n]of Object.entries(e))n.set&&(n.set=xt,Object.defineProperty(this,t,n));Object.defineProperty(this,Kt,{value:xt}),Object.defineProperty(this,St,{value:this})}function it(e,t,n){const{byteSize:s,align:i,instance:{members:o,template:r}}=e,{modifier:c,initializer:l,finalizer:a,alternateCaster:f,shapeDefiner:u}=t,d=Xs(o);let b;if(r!=null&&r[I]){const p=o.filter(w=>Fs(w));p.length>0&&(b=p.map(w=>w.slot))}const m=new Zs,h=function(p,w={}){const{fixed:S=!1}=w,M=this instanceof h;let E,T;if(M){if(arguments.length===0)throw new Dn(e);E=this,d&&(E[I]={}),u?(l.call(E,p,S),T=E[g]):E[g]=T=n.allocateMemory(s,i,S)}else{if(f&&(E=f.call(this,p,w),E!==!1)||(T=Ps(e,p,n),E=m.find(T)))return E;E=Object.create(h.prototype),u?_t.call(E,T,e,!1,!1,{shapeDefiner:u}):E[g]=T,d&&(E[I]={})}if(b)for(const N of b)E[I][N]=r[I][N];return c&&c.call(E),M&&(u||l.call(E,p)),a&&(E=a.call(E)),m.save(T,E)};return de(h,Qe,{value:m}),h}function Ae(e,t){return function(){const n=this[g],s=n[j];if(s&&n.buffer.byteLength===0){const i=t.obtainFixedView(s.address,s.len);return s.align&&(i[j].align=s.align),this[g]=i,e==null||e.save(i,this),!0}else return!1}}function Ft({source:e}){const t=e[I][0];t&&this[fe](t)}function at(e){const{instance:{template:t}}=e;return function(n,s){var u;const i=Object.keys(n),o=this[Xt],r=this[Ze];for(const d of i)if(!(d in o))throw new zn(e,d);let c=0,l=0,a=0,f=0;for(const d of r){const b=o[d];b.special?d in n&&f++:(c++,d in n?l++:b.required&&a++)}if(a!==0&&f===0){const d=r.filter(b=>o[b].required&&!(b in n));throw new Fn(e,d)}if(f+l>i.length)for(const d of r)d in n&&(i.includes(d)||i.push(d));l<c&&f===0&&t&&(t[g]&&this[D](t),(u=this[k])==null||u.call(this,Ft,{vivificate:!0,source:t}));for(const d of i)o[d].call(this,n[d],s);return i.length}}function Xs(e){for(const{type:t}of e)switch(t){case O.Object:case O.Comptime:case O.Type:case O.Literal:return!0}return!1}function an(){return this}class Zs{constructor(){P(this,"map",new WeakMap)}find(t){return this.map.get(t)}save(t,n){return this.map.set(t,n),n}}const Fe={},ze={};function Dt(e,t="utf-8"){let n=Fe[t];n||(n=Fe[t]=new TextDecoder(t));let s;if(Array.isArray(e))if(e.length===1)s=e[0];else{let i=0;for(const c of e)i+=c.length;const{constructor:o}=e[0];s=new o(i);let r=0;for(const c of e)s.set(c,r),r+=c.length}else s=e;return n.decode(s)}function Qs(e,t="utf-8"){switch(t){case"utf-16":{const{length:n}=e,s=new Uint16Array(n);for(let i=0;i<n;i++)s[i]=e.charCodeAt(i);return s}default:{let n=ze[t];return n||(n=ze[t]=new TextEncoder),n.encode(e)}}}function ti(e){const t=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=String.fromCharCode.apply(null,t);return btoa(n)}function ei(e){const t=atob(e),n=new Uint8Array(t.length);for(let s=0;s<n.byteLength;s++)n[s]=t.charCodeAt(s);return new DataView(n.buffer)}function Z(){return fn(this,!1)}function tt(){return fn(this,!0)}const ni=BigInt(Number.MAX_SAFE_INTEGER),si=BigInt(Number.MIN_SAFE_INTEGER);function fn(e,t){const n=t?"return":"throw",s=new Map,i=function(o){var l,a,f;const r=typeof o=="function"?v.Struct:(l=o==null?void 0:o.constructor)==null?void 0:l[G];if(r===void 0){if(t){if(typeof o=="bigint"&&si<=o&&o<=ni)return Number(o);if(o instanceof Error)return{error:o.message}}return o}let c=s.get(o);if(c===void 0){let u;switch(r){case v.Struct:case v.PackedStruct:case v.ExternStruct:case v.TaggedUnion:case v.BareUnion:case v.ExternUnion:u=(a=o[gt])==null?void 0:a.call(o,{error:n}),c=o.constructor[Ke]?[]:{};break;case v.Array:case v.Vector:case v.Slice:u=(f=o[gt])==null?void 0:f.call(o,{error:n}),c=[];break;case v.SinglePointer:case v.SlicePointer:case v.MultiPointer:case v.CPointer:try{c=o["*"]}catch{c=Symbol.for("inaccessible")}break;case v.Enum:c=Wt(()=>String(o),{error:n});break;case v.Opaque:c={};break;default:c=Wt(()=>o.$,{error:n})}if(c=i(c),s.set(o,c),u)for(const[d,b]of u)c[d]=i(b)}return c};return i(e)}function Wt(e,t={}){const{error:n="throw"}=t;try{return e()}catch(s){if(n==="return")return s;throw s}}function ft(e,t={}){return ee({get(){return this[U](),this[g]},set(n,s){Vs(n),_t.call(this,n,e,!0,s,t)}})}function ut(e,t={}){return ee({get(){return ti(this.dataView)},set(n,s){if(typeof n!="string")throw new Ht("string",n);const i=ei(n);_t.call(this,i,e,!1,s,t)}})}function un(e,t={}){const{sentinel:n,instance:{members:s}}=e,{byteSize:i}=s[0];return ee({get(){const o=this.dataView,r=i===1?Int8Array:Int16Array,c=new r(o.buffer,o.byteOffset,this.length);let l=Dt(c,`utf-${i*8}`);return(n==null?void 0:n.value)!==void 0&&l.charCodeAt(l.length-1)===n.value&&(l=l.slice(0,-1)),l},set(o,r){if(typeof o!="string")throw new Ht("a string",o);(n==null?void 0:n.value)!==void 0&&o.charCodeAt(o.length-1)!==n.value&&(o=o+String.fromCharCode(n.value));const c=Qs(o,`utf-${i*8}`),l=new DataView(c.buffer);_t.call(this,l,e,!1,r,t)}})}function It(e,t={}){const{typedArray:n}=e;return ee({get(){const s=this.dataView,i=s.byteLength/n.BYTES_PER_ELEMENT;return new n(s.buffer,s.byteOffset,i)},set(s,i){if(!Ms(s,n))throw new Ht(n.name,s);const o=new DataView(s.buffer,s.byteOffset,s.byteLength);_t.call(this,o,e,!0,i,t)}})}function ee({get:e,set:t}){return e.special=t.special=!0,{get:e,set:t}}let rt,Ut;function hn(e,t){const{name:n,byteSize:s,align:i,instance:{members:[o]}}=e;if(Ut||(Ut=class extends ri{},rt=hn({...e,name:"anyerror"},t)),rt&&n==="anyerror")return e.constructor=rt,e.typedArray=vt(o),rt;const r=Ut,{get:c,set:l}=R(o,t),a=["string","number"],f=at(e),u=function(w){if(w instanceof b[$t])l.call(this,w);else if(w&&typeof w=="object"&&!Ct(w)){if(f.call(this,w)===0)throw new bt(e,a,w)}else w!==void 0&&l.call(this,w)},d=function(w){if(typeof w=="number"||typeof w=="string")return b[w];if(w instanceof b[$t])return b[Number(w)];if(Ct(w))return b[`Error: ${w.error}`];if(Qt(e,w,t))return!1;throw new bt(e,a,w)},b=e.constructor=it(e,{initializer:u,alternateCaster:d},t),m=e.typedArray=vt(o),h={$:{get:c,set:l},dataView:ft(e),base64:ut(e),typedArray:m&&It(e),valueOf:{value:Z},toJSON:{value:tt},delete:{value:lt(t)},[D]:{value:H(s)},[q]:{value:At}},p={[_]:{value:i},[J]:{value:s},[$t]:{value:r},[mt]:n==="anyerror"?{value:[]}:void 0,[G]:{value:e.type}};return st(b,h,p,t)}function ii(e,t,n){const s=n[Yt]("number");let i=rt[s];if(!i){const c=e[$t];i=new c(t,s)}const o=String(i),r={[s]:{value:i},[o]:{value:i},[t]:{value:i}};L(e,r),L(rt,r),rt[mt].push(t)}function oi(){Ut=rt=void 0}class ri extends Error{constructor(t,n){super(qe(t)),this.number=n,this.stack=void 0}[Symbol.toPrimitive](t){switch(t){case"string":case"default":return Error.prototype.toString.call(this,t);default:return this.number}}toJSON(){return{error:this.message}}}function ci(e,t){const n=(s,{methods:i},o)=>{const r={},c=/^(get|set)\s+([\s\S]+)/;for(const l of i){const a=t.createCaller(l,o),f=c.exec(a.name);if(f){const u=f[1],d=f[2],b=u==="get"?0:1;if(li(l,o)===b){let h=r[d];h||(h=r[d]={configurable:!0,enumerable:!0}),h[u]=a}}else r[a.name]={value:a,configurable:!0,writable:!0}}L(s,r)};n(e.constructor,e.static,!1),n(e.constructor.prototype,e.instance,!0)}function li(e,t){const{argStruct:{instance:{members:n}}}=e;return n.length-(t?2:1)}function ai(e,t){const{byteSize:n,align:s,instance:{members:[i]}}=e,{get:o,set:r}=R(i,t),c=["string","number","tagged union"],l=at(e),a=function(p){if(p&&typeof p=="object"){if(l.call(this,p)===0)throw new bt(e,c,p)}else p!==void 0&&r.call(this,p)},f=function(p){if(typeof p=="string"||typeof p=="number"||typeof p=="bigint"){let w=u[p];return w||u[tn]&&typeof p!="string"&&(w=new u(void 0),r.call(w,p,"number"),dn(u,`${p}`,w)),w}else{if(p instanceof u)return p;if((p==null?void 0:p[De])instanceof u)return p[De];if(Qt(e,p,t))return!1;throw new bt(e,c,p)}},u=e.constructor=it(e,{initializer:a,alternateCaster:f},t),d=e.typedArray=vt(i),b=function(p){switch(p){case"string":case"default":return this.$[Ye];default:return o.call(this,"number")}},m={$:{get:o,set:r},dataView:ft(e),base64:ut(e),typedArray:d&&It(e),valueOf:{value:Z},toString:{value:Z},toJSON:{value:tt},delete:{value:lt(t)},[Symbol.toPrimitive]:{value:b},[D]:{value:H(n)},[q]:{value:At}},h={[_]:{value:s},[J]:{value:n},[G]:{value:e.type}};return st(u,m,h,t)}function dn(e,t,n){if(t!==void 0){if(n instanceof e){L(n,{[Ye]:{value:t}});const s=n[Symbol.toPrimitive]();L(e,{[s]:{value:n},[t]:{value:n}})}}else L(e,{[tn]:{value:!0}})}function yn(e,t){const{name:n,type:s,byteSize:i,align:o,instance:{members:[r]},isConst:c}=e,{runtimeSafety:l=!0}=t,{structure:a}=r,{type:f,sentinel:u,byteSize:d=1}=a,b=s===v.SlicePointer,m=b?i/2:i,{get:h,set:p}=R({type:O.Uint,bitOffset:0,bitSize:m*8,byteSize:m,structure:{byteSize:m}},t),{get:w,set:S}=b?R({type:O.Uint,bitOffset:m*8,bitSize:m*8,byteSize:m,structure:{name:"usize",byteSize:m}},t):{},M=function(y=!0,x=!0){if(y||this[g][j])if(x){const C=h.call(this),W=b?w.call(this):u!=null&&u.isRequired?t.findSentinel(C,u.bytes)+1:1;if(C!==this[Bt]||W!==this[yt]){const z=a.constructor,F=t.findMemory(C,W,z[J]),ot=F?z.call(jt,F):null;return this[I][0]=ot,this[Bt]=C,this[yt]=W,b&&(this[Rt]=void 0),ot}}else return this[I][0]=void 0;return this[I][0]},E=function(y){p.call(this,y),this[Bt]=y},T=b||u?function(y){var x;(x=S==null?void 0:S.call)==null||x.call(S,this,y),this[yt]=y}:null,N=function(){const y=this[wt]??this,x=M.call(y,!1);if(!x){if(s===v.CPointer)return null;throw new Ln}return c?pn(x):x},V=function(y){if(y===void 0)return;const x=this[wt]??this;if(y){if(y[g][j]){const C=t.getViewAddress(y[g]);E.call(this,C),b&&T.call(this,y.length)}else if(x[g][j])throw new Gn(e,y)}else x[g][j]&&(E.call(this,0),b&&T.call(this,0));x[I][0]=y??null,b&&(x[Rt]=void 0)},Tt=Se(a)?function(){return N.call(this)[Yt]()}:N,ne=c?xt:function(y){return N.call(this)[Kt](y)},Et=function(){const y=N.call(this);return y?y.length:0},se=function(y){y=y|0;const x=N.call(this);if(!x){if(y!==0)throw new Ve(y,0);return}const C=x[g],W=C[j],z=C.buffer.byteLength-C.byteOffset;let F;if(W||(b?(F=this[Rt],F===void 0&&(F=this[Rt]=x.length)):F=z/d|0),y<0||y>F)throw new Ve(y,F);const ot=y*d,oe=ot<=z?t.obtainView(C.buffer,C.byteOffset,ot):t.obtainFixedView(W.address,ot),Vt=a.constructor;this[I][0]=Vt.call(jt,oe),b&&(T==null||T.call(this,y))},ie=function(y,x){const C=a.constructor;if(this===jt||this===be||y instanceof et)return!1;if(ye(y,C))return new et(C(y["*"]),x);if(Ne(y,C,s))return new et(y);if(f===v.Slice)return new et(C(y),x);throw new Rn(e)},A=function(){const y=Ie(f)?{}:yi,x=new Proxy(this,y);return Object.defineProperty(this,Zt,{value:x}),x},$=function(y){var C,W;const x=a.constructor;if(ye(y,x)){if(!c&&y.constructor.const)throw new Bn(e,y);y=y[I][0]}else if(s!=v.SinglePointer)Ne(y,x,s)&&(y=x(y[I][0][g]));else if(n==="*anyopaque"&&y){if(Ie(y.constructor[G]))y=(C=y["*"])==null?void 0:C[g];else if(y[g])y=y[g];else if((y==null?void 0:y.buffer)instanceof ArrayBuffer&&!(y instanceof Uint8Array||y instanceof DataView)){const{byteOffset:z,byteLength:F}=y;z!==void 0&&F!==void 0&&(y=new DataView(y.buffer,z,F))}}if(y instanceof x){y[U]();const z=y[St];if(z)if(c)y=z;else throw new Yn(e)}else if(s===v.CPointer&&y instanceof x.child)y=x(y[g]);else if($s(y,x)){const z=Qt(a,y,t);y=x(z)}else if(y!=null&&!y[g]){if(s===v.CPointer&&typeof y=="object"&&!y[Symbol.iterator]){let F=!0;const ot=x.prototype[Xt];for(const oe of Object.keys(y)){const Vt=ot[oe];if(Vt!=null&&Vt.special){F=!1;break}}F&&(y=[y])}const z=new x(y,{fixed:!!this[g][j]});if(l&&a.typedArray){const F=(W=y==null?void 0:y.buffer)==null?void 0:W[Symbol.toStringTag];(F==="ArrayBuffer"||F==="SharedArrayBuffer")&&Xn(a,y)}y=z}else if(y!==void 0&&(s!==v.CPointer||y!==null))throw new Wn(e,y);this[fe](y)},B=f===v.Primitive?function(y){return this[K]()[Symbol.toPrimitive](y)}:null,Q=f===v.Slice?function(y,x){const W=this[K]().slice(y,x);return new et(W)}:null,ht=f===v.Slice?function(y,x,C){const z=this[K]().subarray(y,x,C);return new et(z)}:null,et=e.constructor=it(e,{initializer:$,alternateCaster:ie,finalizer:A},t),zt={"*":{get:Tt,set:ne},$:{get:Te,set:$},length:{get:Et,set:se},valueOf:{value:Z},toJSON:{value:tt},delete:{value:ui},slice:Q&&{value:Q},subarray:ht&&{value:ht},[Symbol.toPrimitive]:B&&{value:B},[K]:{value:N},[fe]:{value:V},[Xe]:{value:M},[ue]:{value:E},[he]:T&&{value:T},[k]:{value:di},[D]:{value:H(i)},[q]:{value:fi},[Bt]:{value:void 0,writable:!0},[yt]:T&&{value:void 0,writable:!0}},On={child:{get:()=>a.constructor},const:{value:c},[_]:{value:o},[J]:{value:i},[G]:{value:e.type}};return st(et,zt,On,t)}function fi(){const e=this[wt],t=Object.getOwnPropertyDescriptor(e.constructor.prototype,"$");t.set=xt,Object.defineProperty(e,"$",t),Object.defineProperty(e,St,{value:e})}function ui(){const e=this[K]();e==null||e.delete()}function Te(){return this[Zt]}function hi({isActive:e}){this[I][0]&&!e(this)&&(this[I][0]=void 0)}function di(e,t={}){const{source:n,isActive:s=nt,isMutable:i=nt}=t;e.call(this,{source:n,isActive:s,isMutable:i})}function ye(e,t){var n;return((n=e==null?void 0:e.constructor)==null?void 0:n.child)===t&&e["*"]}function Ne(e,t,n){var s,i;if(n!==v.SinglePointer){if(((i=(s=e==null?void 0:e.constructor)==null?void 0:s.child)==null?void 0:i.child)===t.child&&e["*"])return!0;if(n===v.CPointer&&ye(e,t.child))return!0}return!1}function pn(e){let t=e[re];return t||(Object.defineProperty(e,re,{value:void 0,configurable:!0}),t=new Proxy(e,pi),Object.defineProperty(e,re,{value:t})),t}const yi={get(e,t){return t===wt?e:t in e?e[t]:e[K]()[t]},set(e,t,n){if(t in e)e[t]=n;else{const s=e[K]();s[t]=n}return!0},deleteProperty(e,t){if(t in e)delete e[t];else{const n=e[K]();delete n[t]}return!0},has(e,t){if(t in e)return!0;{const n=e[K]();return t in n}}},pi={get(e,t){if(t===St)return e;{const n=e[t];return(n==null?void 0:n[St])===null?pn(n):n}},set(e,t,n){const s=e[wt];return s&&!(t in s)?e[t]=n:xt(),!0}};function nt(){return!0}function bi(e,t){const{length:n,byteSize:s,align:i,instance:{members:[o]}}=e,{bitSize:r,structure:c}=o,l={};for(let h=0,p=0;h<n;h++,p+=r){const{get:w,set:S}=R({...o,bitOffset:p},t);l[h]={get:w,set:S,configurable:!0}}const a=at(e),f=function(h){if(h instanceof u)this[D](h);else if(h!=null&&h[Symbol.iterator]){let p=h.length;if(typeof p!="number"&&(h=[...h],p=h.length),p!==n)throw new Jt(e,this,h);let w=0;for(const S of h)this[Xt][w++].call(this,S)}else if(h&&typeof h=="object"){if(a.call(this,h)===0)throw new pt(e,h)}else if(h!==void 0)throw new pt(e,h)},u=e.constructor=it(e,{initializer:f},t),d=e.typedArray=vt(o),b={...l,$:{get:an,set:f},length:{value:n},dataView:ft(e),base64:ut(e),typedArray:d&&It(e),valueOf:{value:Z},toJSON:{value:tt},entries:{value:Gt},delete:{value:lt(e)},[Symbol.iterator]:{value:bn},[gt]:{value:Gt},[D]:{value:H(s)},[q]:{value:At}},m={child:{get:()=>c.constructor},[kt]:{value:te(e)},[_]:{value:i},[J]:{value:s},[G]:{value:e.type}};return st(u,b,m,t)}function bn(){const e=this,t=this.length;let n=0;return{next(){let s,i;if(n<t){const o=n++;s=e[o],i=!1}else i=!0;return{value:s,done:i}}}}function mi(){const e=this,t=this.length;let n=0;return{next(){let s,i;if(n<t){const o=n++;s=[o,e[o]],i=!1}else i=!0;return{value:s,done:i}}}}function Gt(){return{[Symbol.iterator]:mi.bind(this),length:this.length}}function gi(e,t){const{byteSize:n,align:s,instance:{members:i},isTuple:o,isIterator:r,hasPointer:c}=e,l={},a=i.filter(T=>!!T.name),f=i.find(T=>!T.name);for(const T of a){const{get:N,set:V}=R(T,t);l[T.name]={get:N,set:V,configurable:!0,enumerable:!0},T.isRequired&&V&&(V.required=!0)}const u=f?R(f,t):null,d=!!i.find(T=>T.type===O.Object),b=at(e),m=function(T){if(T instanceof h)this[D](T),c&&this[k](Ft,{vivificate:!0,source:T});else if(T&&typeof T=="object")b.call(this,T);else if((typeof T=="number"||typeof T=="bigint")&&u)u.set.call(this,T);else if(T!==void 0)throw new bt(e,"object",T)},h=e.constructor=it(e,{initializer:m},t),p=u?function(T){switch(T){case"string":return Object.prototype.toString.call(this);default:return u.get.call(this)}}:null,w=o&&i.length>0?parseInt(i[i.length-1].name)+1:0,S=r?wi:o?bn:mn,M={$:{get:an,set:m},dataView:ft(e),base64:ut(e),length:o&&{value:w},valueOf:{value:Z},toJSON:{value:tt},delete:{value:lt(t)},entries:o&&{value:Gt},...l,[Symbol.iterator]:{value:S},[Symbol.toPrimitive]:u&&{value:p},[gt]:{value:o?Gt:Ee},[D]:{value:H(n)},[X]:d&&{value:xe(e,t)},[k]:c&&{value:Oe(e,nt)},[q]:{value:At},[mt]:{value:a.map(T=>T.name)}},E={[_]:{value:s},[J]:{value:n},[G]:{value:e.type},[Ke]:{value:o}};return st(h,M,E,t)}function Ee(e){return{[Symbol.iterator]:Si.bind(this,e),length:this[mt].length}}function wi(){const e=this;return{next(){const t=e.next();return{value:t,done:t===null}}}}function mn(e){return Ee.call(this,e)[Symbol.iterator]()}function Si(e){const t=this,n=this[mt];let s=0;return{next(){let i,o;if(s<n.length){const r=n[s++];i=[r,Wt(()=>t[r],e)],o=!1}else o=!0;return{value:i,done:o}}}}function xe(e,t){const{instance:{members:n}}=e,s={};for(const i of n.filter(o=>o.type===O.Object))s[i.slot]=i;return function(o){const r=s[o],{bitOffset:c,byteSize:l,structure:{constructor:a}}=r,f=this[g],d=f.byteOffset+(c>>3);let b=l;if(b===void 0){if(c&7)throw new Jn(r);b=r.bitSize>>3}const m=t.obtainView(f.buffer,d,b);return this[I][o]=a.call(be,m)}}function Oe(e,t={}){const{isChildActive:n=nt,isChildMutable:s=nt}=t,{instance:{members:i}}=e,o=i.filter(r=>{var c;return(c=r.structure)==null?void 0:c.hasPointer});return function(c,l={}){var m;const{source:a,vivificate:f=!1,isActive:u=nt,isMutable:d=nt}=l,b={...l,isActive:h=>u(this)&&n.call(this,h),isMutable:h=>d(this)&&s.call(this,h)};for(const{slot:h}of o){if(a){const w=(m=a[I])==null?void 0:m[h];if(!w)continue;b.source=w}const p=this[I][h]??(f?this[X](h):null);p&&p[k](c,b)}}}function vi(e,t){const{type:n,constructor:s,static:{members:i,template:o}}=e,r={};for(const c of i)r[c.name]=R(c,t);if(L(s,{valueOf:{value:Z},toJSON:{value:tt},...r,[Symbol.iterator]:{value:mn},[gt]:{value:Ee},[I]:o&&{value:o[I]},[mt]:!s[mt]&&{value:i.map(c=>c.name)}}),n===v.Enum)for(const{name:c,slot:l}of i)dn(s,c,s[I][l]);else if(n===v.ErrorSet)for(const{name:c,slot:l}of i)ii(s,c,s[I][l])}function Ai(e,t){const{byteSize:n,align:s,instance:{members:i},hasPointer:o}=e,r=!!i.find(m=>m.type===O.Object),c=i.slice(1).map(m=>m.name),l=c.length,a=e.constructor=function(m,h,p){const w=t.allocateMemory(n,s);if(this[g]=w,r&&(this[I]={}),m.length!==l)throw new Nn(h,l-p,m.length-p);for(const[S,M]of c.entries())try{this[M]=m[S]}catch(E){throw Kn(h,S-p,l-p,E)}},f={};for(const m of i)f[m.name]=R(m,t);const{slot:u,type:d}=i[0],b=d===O.Object?function(m){const h=this[X](u);return m===h}:function(){return!1};return L(a.prototype,{...f,[D]:{value:H(n)},[X]:r&&{value:xe(e,t)},[k]:o&&{value:Oe(e,{isChildMutable:b})},[U]:{value:Ae(null,t)}}),L(a,{[_]:{value:s},[J]:{value:n}}),a}function Ti(e,t){const{length:n,byteSize:s,align:i,instance:{members:[o]},hasPointer:r}=e,{get:c,set:l}=R(o,t),a=Sn(o),f=at(e),u=function(S){if(S instanceof b)this[D](S),r&&this[k](Ft,{vivificate:!0,source:S});else if(typeof S=="string"&&a&&(S={string:S}),S!=null&&S[Symbol.iterator]){if(S=En(S),S.length!==n)throw new Jt(e,this,S);let M=0;for(const E of S)l.call(this,M++,E)}else if(S&&typeof S=="object"){if(f.call(this,S)===0)throw new pt(e,S)}else if(S!==void 0)throw new pt(e,S)},d=gn,b=e.constructor=it(e,{initializer:u,finalizer:d},t),m=e.typedArray=vt(o),h=o.type===O.Object,p={$:{get:Te,set:u},length:{value:n},dataView:ft(e),base64:ut(e),string:a&&un(e),typedArray:m&&It(e),get:{value:c},set:{value:l},entries:{value:qt},valueOf:{value:Z},toJSON:{value:tt},delete:{value:lt(t)},[Symbol.iterator]:{value:vn},[gt]:{value:qt},[D]:{value:H(s)},[X]:h&&{value:An(e,t)},[k]:r&&{value:Tn()},[q]:{value:wn}},w={child:{get:()=>o.structure.constructor},[kt]:{value:te(e)},[_]:{value:i},[J]:{value:s},[G]:{value:e.type}};return st(b,p,w,t)}function gn(){const e=new Proxy(this,xi);return Object.defineProperty(this,Zt,{value:e}),e}function wn(){At.call(this),Object.defineProperty(this,"set",{value:xt});const e=this.get;Object.defineProperty(this,"get",{value:function(n){var i;const s=e.call(this,n);return(s==null?void 0:s[St])===null&&((i=s[q])==null||i.call(s)),s}})}function Sn(e){return e.type===O.Uint&&[8,16].includes(e.bitSize)}function vn(){const e=this[me]??this,t=this.length;let n=0;return{next(){let s,i;if(n<t){const o=n++;s=e.get(o),i=!1}else i=!0;return{value:s,done:i}}}}function Ei(e){const t=this[me]??this,n=this.length;let s=0;return{next(){let i,o;if(s<n){const r=s++;i=[r,Wt(()=>t.get(r),e)],o=!1}else o=!0;return{value:i,done:o}}}}function qt(e){return{[Symbol.iterator]:Ei.bind(this,e),length:this.length}}function An(e,t){const{instance:{members:[n]}}=e,{byteSize:s,structure:i}=n;return function(r){const{constructor:c}=i,l=this[g],f=l.byteOffset+s*r,u=t.obtainView(l.buffer,f,s);return this[I][r]=c.call(be,u)}}function Tn(e){return function(n,s={}){const{source:i,vivificate:o=!1,isActive:r=nt,isMutable:c=nt}=s,l={...s,isActive:()=>r(this),isMutable:()=>c(this)};for(let a=0,f=this.length;a<f;a++){i&&(l.source=i==null?void 0:i[I][a]);const u=this[I][a]??(o?this[X](a):null);u&&u[k](n,l)}}}function En(e){var i;if(typeof e.length=="number")return e;const t=e[Symbol.iterator](),n=t.next(),s=(i=n.value)==null?void 0:i.length;if(typeof s=="number"&&Object.keys(n.value).join()==="length")return Object.assign(function*(){let o;for(;!(o=t.next()).done;)yield o.value}(),{length:s});{const o=[];let r=n;for(;!r.done;)o.push(r.value),r=t.next();return o}}const xi={get(e,t){const n=typeof t=="symbol"?0:t|0;if(n!==0||n==t)return e.get(n);switch(t){case"get":return e[Pt]||(e[Pt]=e.get.bind(e)),e[Pt];case"set":return e[Mt]||(e[Mt]=e.set.bind(e)),e[Mt];case me:return e;default:return e[t]}},set(e,t,n){const s=typeof t=="symbol"?0:t|0;if(s!==0||s==t)e.set(s,n);else switch(t){case"get":e[Pt]=n;break;case"set":e[Mt]=n;break;default:e[t]=n}return!0},deleteProperty(e,t){const n=typeof t=="symbol"?0:t|0;if(n!==0||n==t)return!1;switch(t){case"get":delete e[Pt];break;case"set":delete e[Mt];break;default:delete e[t]}return!0},has(e,t){const n=typeof t=="symbol"?0:t|0;return n!==0||n==t?n>=0&&n<e.length:e[t]},ownKeys(e){const t=[];for(let n=0,s=e.length;n<s;n++)t.push(`${n}`);return t.push("length",Zt),t},getOwnPropertyDescriptor(e,t){const n=typeof t=="symbol"?0:t|0;if(n!==0||n==t){if(n>=0&&n<e.length)return{value:e.get(n),enumerable:!0,writable:!0,configurable:!0}}else return Object.getOwnPropertyDescriptor(e,t)}};function Oi(e,t){const{byteSize:n,align:s,instance:{members:i},hasPointer:o}=e,{get:r,set:c}=R(i[0],t),{get:l,set:a}=R(i[1],t),f=function(){if(l.call(this,"number"))throw l.call(this);return r.call(this)},u=i[0].type===O.Void,d=i[1].structure.constructor,b=function(){return!l.call(this,"number")},m=function(){var V;this[Ce](),(V=this[k])==null||V.call(this,hi)},h=!!i.find(V=>V.type===O.Object),p=at(e),w=function(V){if(V instanceof S)this[D](V),o&&b.call(this)&&this[k](Ft,{vivificate:!0,source:V});else if(V instanceof d[$t]&&d(V))a.call(this,V),m.call(this);else if(V!==void 0||u)try{c.call(this,V),a.call(this,0,"number")}catch(Tt){if(V instanceof Error)throw new We(e);if(Ct(V))a.call(this,V),m.call(this);else if(V&&typeof V=="object"){if(p.call(this,V)===0)throw Tt}else throw Tt}},S=e.constructor=it(e,{initializer:w},t),{bitOffset:M,byteSize:E}=i[0],T={$:{get:f,set:w},dataView:ft(e),base64:ut(e),valueOf:{value:Z},toJSON:{value:tt},delete:{value:lt(t)},[D]:{value:H(n)},[Ce]:{value:ds(M/8,E)},[X]:h&&{value:xe(e,t)},[k]:o&&{value:Oe(e,{isChildActive:b})},[q]:{value:At}},N={[_]:{value:s},[J]:{value:n},[G]:{value:e.type}};return st(S,T,N,t)}function Ii(e,t){const{byteSize:n,align:s,instance:{members:[i]}}=e,{get:o,set:r}=R(i,t),c=at(e),l=function(b){if(b instanceof a)this[D](b);else if(b&&typeof b=="object"){if(c.call(this,b)===0){const m=Be(i);throw new bt(e,m,b)}}else b!==void 0&&r.call(this,b)},a=e.constructor=it(e,{initializer:l},t),f=e.typedArray=vt(i),u={$:{get:o,set:r},dataView:ft(e),base64:ut(e),typedArray:f&&It(e),valueOf:{value:Z},toJSON:{value:tt},delete:{value:lt(t)},[Symbol.toPrimitive]:{value:o},[D]:{value:H(n)},[q]:{value:At}},d={[kt]:{value:te(e)},[_]:{value:s},[J]:{value:n},[Zn]:{value:i.bitSize},[G]:{value:e.type},[ts]:{value:i.type}};return st(a,u,d,t)}function Vi(e,t){const{align:n,instance:{members:[s]},byteSize:i,hasPointer:o}=e,{get:r,set:c}=R(s,t),{byteSize:l,structure:a}=s,f=Pi(e,t);f&&(e.sentinel=f);const u=Sn(s),d=function(A,$,B=!1){A||(A=t.allocateMemory($*l,n,B)),this[g]=A,this[yt]=$},b=function(A,$){if($!==this[yt])throw new Jt(e,this,A)},m=at(e),h=function(A,$=!1){if(A instanceof V)this[g]?b.call(this,A,A.length):d.call(this,null,A.length,$),this[D](A),o&&this[k](Ft,{vivificate:!0,source:A});else if(typeof A=="string"&&u)h.call(this,{string:A},$);else if(A!=null&&A[Symbol.iterator]){A=En(A),this[g]?b.call(this,A,A.length):d.call(this,null,A.length,$);let B=0;for(const Q of A)f==null||f.validateValue(Q,B,A.length),c.call(this,B++,Q)}else if(typeof A=="number")if(!this[g]&&A>=0&&isFinite(A))d.call(this,null,A,$);else throw new pt(e,A,!this[g]);else if(A&&typeof A=="object"){if(m.call(this,A,$)===0)throw new pt(e,A)}else if(A!==void 0)throw new pt(e,A)},p=function(){return this[yt]},w=function(A,$){return A=A|0,A<0?(A=$+A,A<0&&(A=0)):A>$&&(A=$),A};function S(A,$){A=A===void 0?0:w(A,this.length),$=$===void 0?this.length:w($,this.length);const B=this[g],Q=A*l,ht=$*l-Q;return t.obtainView(B.buffer,B.byteOffset+Q,ht)}function M(A,$){const B=S.call(this,A,$);return V(B)}const E=function(A,$,B={}){const{fixed:Q=!1}=B,ht=S.call(this,A,$),et=t.allocateMemory(ht.byteLength,n,Q),zt=V(et);return N.call(zt,{[g]:ht}),zt},T=gn,N=H(l,!0),V=e.constructor=it(e,{initializer:h,shapeDefiner:d,finalizer:T},t),Tt=e.typedArray=vt(s),ne=s.type===O.Object,Et={shapeDefiner:d},se={$:{get:Te,set:h},length:{get:p},dataView:ft(e,Et),base64:ut(e,Et),string:u&&un(e,Et),typedArray:Tt&&It(e,Et),get:{value:r},set:{value:c},entries:{value:qt},slice:{value:E},subarray:{value:M},valueOf:{value:Z},toJSON:{value:tt},delete:{value:lt(t)},[Symbol.iterator]:{value:vn},[gt]:{value:qt},[D]:{value:N},[X]:ne&&{value:An(e,t)},[k]:o&&{value:Tn()},[q]:{value:wn}},ie={child:{get:()=>a.constructor},[kt]:{value:te(e)},[_]:{value:n},[J]:{value:i},[G]:{value:e.type}};return st(V,se,ie,t)}function Pi(e,t){const{runtimeSafety:n=!0}=t,{byteSize:s,instance:{members:[i,o],template:r}}=e;if(!o)return;const{get:c}=R(o,t),l=c.call(r,0),{get:a}=R(i,t),{isRequired:f}=o,u=f?n?function(m,h,p){if(m===l&&h!==p-1)throw new Pe(e,m,h,p);if(m!==l&&h===p-1)throw new Nt(e,l,h,p)}:function(m,h,p){if(m!==l&&h===p-1)throw new Nt(e,l,p)}:function(){},d=f?n?function(m,h){for(let p=0;p<h;p++){const w=a.call(m,p);if(w===l&&p!==h-1)throw new Pe(e,l,p,h);if(w!==l&&p===h-1)throw new Nt(e,l,h)}}:function(m,h){if(h*s===m[g].byteLength){const p=h-1;if(a.call(m,p)!==l)throw new Nt(e,l,h)}}:function(){},b=r[g];return{value:l,bytes:b,validateValue:u,validateData:d,isRequired:f}}const Y=Array(Object.values(v).length);function Wi(){Y[v.Primitive]=Ii}function Gi(){Y[v.Array]=Ti}function qi(){Y[v.Struct]=gi}function Ji(){Y[v.ArgStruct]=Ai}function Hi(){Y[v.ErrorUnion]=Oi}function Yi(){Y[v.ErrorSet]=hn,Ns()}function Ki(){Y[v.Enum]=ai,zs()}function Xi(){Y[v.SinglePointer]=yn,on()}function Zi(){Y[v.SlicePointer]=yn,on()}function Qi(){Y[v.Slice]=Vi}function to(){Y[v.Vector]=bi}function Mi(e){return Y[e]}class $i{constructor(){P(this,"context");P(this,"contextStack",[]);P(this,"consolePending",[]);P(this,"consoleTimeout",0);P(this,"viewMap",new WeakMap);P(this,"emptyBuffer",new ArrayBuffer(0));P(this,"abandoned",!1);P(this,"released",!1);P(this,"littleEndian",!0);P(this,"wordSize",4);P(this,"runtimeSafety",!0);P(this,"comptime",!1);P(this,"variables",[]);P(this,"imports");P(this,"console",globalThis.console)}startContext(){this.context&&this.contextStack.push(this.context),this.context=new ji}endContext(){this.context=this.contextStack.pop()}allocateMemory(t,n=0,s=!1){return s?this.allocateFixedMemory(t,n):this.allocateRelocMemory(t,n)}allocateFixedMemory(t,n,s=le.Normal){const i=t?this.allocateExternMemory(s,t,n):0,o=this.obtainFixedView(i,t);return o[j].align=n,o[j].type=s,o}freeFixedMemory(t){const{address:n,unalignedAddress:s,len:i,align:o,type:r}=t[j];i&&this.freeExternMemory(r,s??n,i,o)}obtainFixedView(t,n){let s;if(t&&n)s=this.obtainExternView(t,n);else{let i=this.viewMap.get(this.emptyBuffer);i||this.viewMap.set(this.emptyBuffer,i={});const o=`${t}:0`;s=i[o],s||(s=i[o]=new DataView(this.emptyBuffer),s[j]={address:t,len:0})}return s}releaseFixedView(t){var n;((n=t[j])==null?void 0:n.type)!==void 0&&(this.freeFixedMemory(t),t[j]=null)}allocateRelocMemory(t,n){return this.obtainView(new ArrayBuffer(t),0,t)}registerMemory(t,n=null,s=void 0){const{memoryList:i}=this.context,o=this.getViewAddress(t),r=ce(i,o);return i.splice(r,0,{address:o,dv:t,len:t.byteLength,targetDV:n,targetAlign:s}),o}unregisterMemory(t){const{memoryList:n}=this.context,s=ce(n,t),i=n[s-1];if((i==null?void 0:i.address)===t)return n.splice(s-1,1),i.dv}findMemory(t,n,s){if(ki(t))if(!n)t=0;else return null;else if(!t&&n)return null;let i=n*(s??0);if(this.context){const{memoryList:o}=this.context,r=ce(o,t),c=o[r-1];if((c==null?void 0:c.address)===t&&c.len===i)return c.targetDV??c.dv;if((c==null?void 0:c.address)<=t&&t<dt(c.address,c.len)){const l=Number(t-c.address),a=c.targetDV??c.dv,f=s===void 0;f&&(i=a.byteLength-l);const u=this.obtainView(a.buffer,a.byteOffset+l,i);return f&&(u[_]=c.targetAlign),u}}return this.obtainFixedView(t,i)}getViewAddress(t){const n=t[j];if(n)return n.address;{const s=this.getBufferAddress(t.buffer);return dt(s,t.byteOffset)}}findViewAt(t,n,s){let i=this.viewMap.get(t),o;if(i)if(i instanceof DataView)if(i.byteOffset===n&&i.byteLength===s)o=i;else{const r=i;i={[`${r.byteOffset}:${r.byteLength}`]:r},this.viewMap.set(t,i)}else o=i[`${n}:${s}`];return{existing:o,entry:i}}obtainView(t,n,s){const{existing:i,entry:o}=this.findViewAt(t,n,s);let r;if(i)return i;o?r=o[`${n}:${s}`]=new DataView(t,n,s):this.viewMap.set(t,r=new DataView(t,n,s));const c=t[j];return c&&(r[j]={address:dt(c.address,n),len:s}),r}registerView(t){if(!t[j]){const{buffer:n,byteOffset:s,byteLength:i}=t,{existing:o,entry:r}=this.findViewAt(n,s,i);if(o)return o;r?r[`${s}:${i}`]=t:this.viewMap.set(n,t)}return t}captureView(t,n,s){if(s){const i=this.allocateRelocMemory(n,0);return n>0&&this.copyBytes(i,t,n),i}else return this.obtainFixedView(t,n)}castView(t,n,s,i){const{constructor:o,hasPointer:r}=i,c=this.captureView(t,n,s),l=o.call(jt,c);return r&&this.updatePointerTargets(l),s&&l[q](),l}finalizeShape(t){const s=Mi(t.type)(t,this);typeof s=="function"&&(L(s,{name:{value:t.name,configurable:!0}}),s.prototype.hasOwnProperty(Symbol.toStringTag)||L(s.prototype,{[Symbol.toStringTag]:{value:t.name,configurable:!0}}))}finalizeStructure(t){vi(t,this),ci(t,this)}createCaller(t,n){const{name:s,argStruct:i,thunkId:o}=t,{constructor:r}=i,c=this;let l;return n?l=function(...a){return c.invokeThunk(o,new r([this,...a],s,1))}:l=function(...a){return c.invokeThunk(o,new r(a,s,0))},Object.defineProperty(l,"name",{value:s}),l}recreateStructures(t,n){Object.assign(this,n);const s=(r,c)=>{for(const[l,a]of Object.entries(c))r[l]=i(a);return r},i=r=>{var f;const{memory:c,structure:l,actual:a}=r;if(c){if(a)return a;{const{array:u,offset:d,length:b}=c,m=this.obtainView(u.buffer,d,b),{constructor:h}=l,{reloc:p,const:w}=r,S=r.actual=h.call(jt,m);return w&&((f=S[q])==null||f.call(S)),r.slots&&s(S[I],r.slots),p!==void 0&&this.variables.push({reloc:p,object:S}),S}}else return l};oi();const o=new Map;for(const r of t){for(const c of[r.instance,r.static])if(c.template){const l=c.template,a=c.template={};if(l.memory){const{array:f,offset:u,length:d}=l.memory;a[g]=this.obtainView(f.buffer,u,d)}if(l.slots){const f=a[I]={};o.set(f,l.slots)}}this.finalizeShape(r)}for(const[r,c]of o)s(r,c);for(const r of t)this.finalizeStructure(r)}linkVariables(t){var s;const n=[];for(const{object:i,reloc:o}of this.variables)this.linkObject(i,o,t),i[K]&&i[I][0]&&n.push(i);for(const i of n){const o=i[K](),r=this.getViewAddress(o[g]);i[ue](r),(s=i[he])==null||s.call(i,o.length)}}linkObject(t,n,s){if(t[g][j])return;const i=t[g],o=this.recreateAddress(n),r=this.obtainFixedView(o,i.byteLength);if(s){const l=Object.create(t.constructor.prototype);l[g]=r,l[D](t)}t[g]=r;const c=l=>{if(l[I]){for(const a of Object.values(l[I]))if(a){const f=a[g];if(f.buffer===i.buffer){const u=f.byteOffset-i.byteOffset;a[g]=this.obtainView(r.buffer,u,f.byteLength),c(a)}}}};c(t)}unlinkVariables(){for(const{object:t}of this.variables)this.unlinkObject(t)}unlinkObject(t){if(!t[g][j])return;t[U]();const n=t[g],s=this.allocateMemory(n.byteLength),i=Object.create(t.constructor.prototype);i[g]=s,i[D](t),t[g]=s}releaseFunctions(){const t=()=>{throw new Error("Module was abandoned")};for(const n of Object.keys(this.imports))this[n]&&(this[n]=t)}getSpecialExports(){const t=n=>{if(n===void 0)throw new Error("Not a Zig type");return n};return{init:(...n)=>this.init(...n),abandon:()=>this.abandon(),released:()=>this.released,connect:n=>this.console=n,sizeOf:n=>t(n[J]),alignOf:n=>t(n[_]),typeOf:n=>Pn(t(n[G]))}}abandon(){this.abandoned||(this.releaseFunctions(),this.unlinkVariables(),this.abandoned=!0)}updatePointerAddresses(t){var l;const n=new Map,s=new Map,i=[],o=function({isActive:a}){var f;if(a(this)){const u=this[wt];if(!n.get(u)){const d=u[I][0];if(d){n.set(u,d);const b=d[g];if(!b[j]){const m=s.get(b.buffer);if(m){const h=Array.isArray(m)?m:[m],p=xn(h,b.byteOffset,w=>w[g].byteOffset);h.splice(p,0,d),Array.isArray(m)||(s.set(b.buffer,h),i.push(h))}else s.set(b.buffer,d);(f=d[k])==null||f.call(d,o)}}}}};t[k](o);const r=this.findTargetClusters(i),c=new Map;for(const a of r)for(const f of a.targets)c.set(f,a);for(const[a,f]of n){const u=c.get(f),d=this.getTargetAddress(f,u)??this.getShadowAddress(f,u);a[ue](d),(l=a[he])==null||l.call(a,f.length)}}findTargetClusters(t){const n=[];for(const s of t){let i=null,o=0,r=0,c=null;for(const l of s){const a=l[g],{byteOffset:f,byteLength:u}=a,d=f+u;let b=!0;i&&(r>f?(c||(c={targets:[i],start:o,end:r,address:void 0,misaligned:void 0},n.push(c)),c.targets.push(l),d>r?c.end=d:b=!1):c=null),b&&(i=l,o=f,r=d)}}return n}createClusterShadow(t){const{start:n,end:s,targets:i}=t;let o=0,r;for(const w of i){const S=w[g],M=S.byteOffset,E=w.constructor[_]??S[_];(o===void 0||E>o)&&(o=E,r=M)}const c=s-n,l=this.allocateShadowMemory(c+o,1),a=this.getViewAddress(l),f=Ci(dt(a,r-n),o),u=dt(f,n-r),d=l.byteOffset+Number(u-a),b=new DataView(l.buffer,d,c);for(const w of i){const S=w[g],M=S.byteOffset;if(M!==r){const E=w.constructor[_]??S[_];if(Di(dt(u,M-n),E))throw new Un(E,o)}}const m={[D]:H(c)},h=Object.create(m),p=Object.create(m);return h[g]=new DataView(i[0][g].buffer,Number(n),c),p[g]=b,b[j]={address:u,len:c,align:1,unalignedAddress:a,type:le.Scratch},this.addShadow(p,h,1)}getShadowAddress(t,n){if(n){const s=t[g];if(n.address===void 0){const i=this.createClusterShadow(n);n.address=this.getViewAddress(i[g])}return dt(n.address,s.byteOffset-n.start)}else{const s=this.createShadow(t);return this.getViewAddress(s[g])}}createShadow(t){const n=t[g],s=t.constructor[_]??n[_],i=Object.create(t.constructor.prototype);return i[g]=this.allocateShadowMemory(n.byteLength,s),this.addShadow(i,t,s)}addShadow(t,n,s){let{shadowMap:i}=this.context;if(i||(i=this.context.shadowMap=new Map),!t[g][j])debugger;return t[U]=Ae(null,this),i.set(t,n),this.registerMemory(t[g],n[g],s),t}removeShadow(t){const{shadowMap:n}=this.context;if(n){for(const[s]of n)if(s[g]===t){n.delete(s);break}}}updateShadows(){const{shadowMap:t}=this.context;if(t)for(const[n,s]of t)n[D](s)}updateShadowTargets(){const{shadowMap:t}=this.context;if(t)for(const[n,s]of t)s[D](n)}releaseShadows(){const{shadowMap:t}=this.context;if(t)for(const[n]of t)this.freeShadowMemory(n[g])}updatePointerTargets(t){const n=new Map,s=function({isActive:i,isMutable:o}){var c,l;const r=this[wt]??this;if(!n.get(r)){n.set(r,!0);const a=!r.constructor.const,f=r[I][0],u=!f||o(this)?r[Xe](!0,i(this)):f;(c=f==null?void 0:f[k])==null||c.call(f,s,{vivificate:!0,isMutable:()=>a}),u!==f&&((l=u==null?void 0:u[k])==null||l.call(u,s,{vivificate:!0,isMutable:()=>a}))}};t[k](s,{vivificate:!0})}writeToConsole(t){const{console:n}=this;try{const s=new Uint8Array(t.buffer,t.byteOffset,t.byteLength).slice(),i=s.lastIndexOf(10);if(i===-1)this.consolePending.push(s);else{const o=s.subarray(0,i),r=s.subarray(i+1),c=[...this.consolePending,o];n.log(Dt(c)),this.consolePending=r.length>0?[r]:[]}clearTimeout(this.consoleTimeout),this.consolePending.length>0&&(this.consoleTimeout=setTimeout(()=>{n.log(Dt(this.consolePending)),this.consolePending=[]},250))}catch(s){n.error(s)}}flushConsole(){this.consolePending.length>0&&(console.log(Dt(this.consolePending)),this.consolePending=[],clearTimeout(this.consoleTimeout))}}class ji{constructor(){P(this,"pointerProcessed",new Map);P(this,"memoryList",[]);P(this,"shadowMap",null);P(this,"call",0)}}function xn(e,t,n){let s=0,i=e.length;if(i===0)return 0;for(;s<i;){const o=Math.floor((s+i)/2);n(e[o])<=t?s=o+1:i=o}return i}function ce(e,t){return xn(e,t,n=>n.address)}function Di(e,t){if(t===void 0)return!1;typeof e=="bigint"&&(e=Number(e&0xFFFFFFFFn));const n=t-1;return(e&n)!==0}function Ci(e,t){let n;return typeof e=="bigint"?(t=BigInt(t),n=~(t-1n)):n=~(t-1),(e&n)+t}function dt(e,t){return e+(typeof e=="bigint"?BigInt(t):t)}function ki(e){return typeof e=="bigint"?e===0xaaaaaaaaaaaaaaaan:e===2863311530}class _i extends $i{constructor(){super(...arguments);P(this,"imports",{allocateExternMemory:{argType:"iii",returnType:"i"},freeExternMemory:{argType:"iiii"},runThunk:{argType:"ii",returnType:"v"},runVariadicThunk:{argType:"iiii",returnType:"v"},isRuntimeSafetyActive:{argType:"",returnType:"b"},flushStdout:{argType:"",returnType:""}});P(this,"exports",{allocateHostMemory:{argType:"ii",returnType:"v"},freeHostMemory:{argType:"iii"},captureString:{argType:"ii",returnType:"v"},captureView:{argType:"iib",returnType:"v"},castView:{argType:"iibv",returnType:"v"},readSlot:{argType:"vi",returnType:"v"},writeSlot:{argType:"viv"},getViewAddress:{argType:"v",returnType:"i"},beginDefinition:{returnType:"v"},insertInteger:{argType:"vsi",alias:"insertProperty"},insertBoolean:{argType:"vsb",alias:"insertProperty"},insertString:{argType:"vss",alias:"insertProperty"},insertObject:{argType:"vsv",alias:"insertProperty"},beginStructure:{argType:"v",returnType:"v"},attachMember:{argType:"vvb"},attachMethod:{argType:"vvb"},createTemplate:{argType:"v",returnType:"v"},attachTemplate:{argType:"vvb"},finalizeShape:{argType:"v"},endStructure:{argType:"v"}});P(this,"nextValueIndex",1);P(this,"valueTable",{0:null});P(this,"valueIndices",new Map);P(this,"memory",null);P(this,"initPromise",null);P(this,"customWASI",null);P(this,"hasCodeSource",!1);P(this,"littleEndian",!0)}async init(n){if(n&&this.hasCodeSource)throw new Error("Cannot set WASI interface after compilation has already begun (consider disabling topLevelAwait)");this.customWASI=n,await this.initPromise}allocateHostMemory(n,s){const i={[_]:s},o=H(n),r=this.allocateRelocMemory(n,s),c=this.allocateShadowMemory(n,s),l={constructor:i,[g]:r,[D]:o},a={constructor:i,[g]:c,[D]:o};return this.addShadow(a,l,s),c}freeHostMemory(n,s,i){const o=this.unregisterMemory(n);if(o)this.removeShadow(o),this.freeShadowMemory(o);else throw new jn(n)}allocateShadowMemory(n,s){return this.allocateFixedMemory(n,s,le.Scratch)}freeShadowMemory(n){return this.freeFixedMemory(n)}getBufferAddress(n){return 0}obtainExternView(n,s){const{buffer:i}=this.memory;return i[j]||(i[j]={address:0,len:i.byteLength}),this.obtainView(i,n,s)}copyBytes(n,s,i){const{memory:o}=this,r=new DataView(o.buffer,s,i);ge(i)(n,r)}findSentinel(n,s){const{memory:i}=this,o=s.byteLength,r=i.buffer.byteLength-o+1;for(let c=n;c<r;c+=o){const l=new DataView(i.buffer,c,o);let a=!0;for(let f=0;f<o;f++){const u=l.getUint8(f),d=s.getUint8(f);if(u!==d){a=!1;break}}if(a)return(c-n)/o}}captureString(n,s){const{buffer:i}=this.memory,o=new Uint8Array(i,n,s);return Dt(o)}getTargetAddress(n,s){const i=n[g];if(i[j])return this.getViewAddress(i);if(i.byteLength===0)return 0}clearExchangeTable(){this.nextValueIndex!==1&&(this.nextValueIndex=1,this.valueTable={0:null},this.valueIndices=new Map)}getObjectIndex(n){if(n){let s=this.valueIndices.get(n);return s===void 0&&(s=this.nextValueIndex++,this.valueIndices.set(n,s),this.valueTable[s]=n),s}else return 0}fromWebAssembly(n,s){switch(n){case"v":case"s":return this.valueTable[s];case"i":return s;case"b":return!!s}}toWebAssembly(n,s){switch(n){case"v":case"s":return this.getObjectIndex(s);case"i":return s;case"b":return s?1:0}}exportFunction(n,s="",i=""){return n?(...o)=>{o=o.map((c,l)=>this.fromWebAssembly(s.charAt(l),c));const r=n.apply(this,o);return this.toWebAssembly(i,r)}:()=>{}}importFunction(n,s="",i=""){return(...o)=>{o=o.map((c,l)=>this.toWebAssembly(s.charAt(l),c));const r=n.apply(this,o);return this.fromWebAssembly(i,r)}}exportFunctions(){const n={};for(const[s,{argType:i,returnType:o,alias:r}]of Object.entries(this.exports)){const c=this[r??s];n[`_${s}`]=this.exportFunction(c,i,o)}return n}importFunctions(n){for(const[s,{argType:i,returnType:o}]of Object.entries(this.imports)){const r=n[s];if(!r)throw new Error(`Unable to import function: ${s}`);this[s]=this.importFunction(r,i,o)}}async instantiateWebAssembly(n){const s=await n;this.hasCodeSource=!0;const i={env:this.exportFunctions(),wasi_snapshot_preview1:this.getWASIImport()};return s[Symbol.toStringTag]==="Response"?WebAssembly.instantiateStreaming(s,i):WebAssembly.instantiate(s,i)}loadModule(n){return this.initPromise=(async()=>{var r,c;const{instance:s}=await this.instantiateWebAssembly(n),{memory:i,_initialize:o}=s.exports;this.importFunctions(s.exports),this.trackInstance(s),(c=(r=this.customWASI)==null?void 0:r.initialize)==null||c.call(r,s),this.runtimeSafety=this.isRuntimeSafetyActive(),this.memory=i})()}trackInstance(n){const s=new WeakRef(n);Object.defineProperty(this,"released",{get:()=>!s.deref(),enumerable:!0})}linkVariables(n){this.initPromise&&(this.initPromise=this.initPromise.then(()=>super.linkVariables(n)))}getMemoryOffset(n){return n}recreateAddress(n){return n}invokeThunk(n,s){return this.runThunk?this.invokeThunkForReal(n,s):this.initPromise.then(()=>this.invokeThunkForReal(n,s))}invokeThunkForReal(n,s){try{this.startContext(),s[k]&&this.updatePointerAddresses(s);const i=this.getShadowAddress(s),o=s[Qn],r=o?this.getShadowAddress(o):0;this.updateShadows();const c=o?this.runVariadicThunk(n,i,r,o.length):this.runThunk(n,i);if(this.updateShadowTargets(),s[k]&&this.updatePointerTargets(s),this.releaseShadows(),this.endContext(),!this.context&&this.flushConsole&&(this.flushStdout(),this.flushConsole()),c)throw new Ge(c);return s.retval}catch(i){if(!(i instanceof $e&&i.code===0))throw i}}getWASIImport(){if(this.customWASI)return this.customWASI.wasiImport;{const i=()=>38;return{args_get:i,args_sizes_get:i,clock_res_get:i,clock_time_get:i,environ_get:i,environ_sizes_get:i,fd_advise:i,fd_allocate:i,fd_close:i,fd_datasync:i,fd_pread:i,fd_pwrite:i,fd_read:i,fd_readdir:i,fd_renumber:i,fd_seek:i,fd_sync:i,fd_tell:i,fd_write:(o,r,c,l)=>{if(o===1||o===2){const a=new DataView(this.memory.buffer);let f=0;for(let u=0,d=r;u<c;u++,d+=8){const b=a.getUint32(d,!0),m=a.getUint32(d+4,!0);if(m>0){const h=new DataView(this.memory.buffer,b,m);this.writeToConsole(h),f+=m}}return a.setUint32(l,f,!0),0}else return 38},fd_fdstat_get:i,fd_fdstat_set_flags:i,fd_fdstat_set_rights:i,fd_filestat_get:i,fd_filestat_set_size:i,fd_filestat_set_times:i,fd_prestat_get:()=>8,fd_prestat_dir_name:i,path_create_directory:i,path_filestat_get:i,path_filestat_set_times:i,path_link:i,path_open:i,path_readlink:i,path_remove_directory:i,path_rename:i,path_symlink:i,path_unlink_file:i,poll_oneoff:i,proc_exit:o=>{throw new $e(o)},random_get:(o,r)=>{const c=new DataView(this.memory.buffer,o,r);for(let l=0;l<r;l++)c.setUint8(l,Math.floor(256*Math.random()));return 0},sched_yield:i,sock_accept:i,sock_recv:i,sock_send:i,sock_shutdown:i}}}}function eo(e){return new _i}export{Gi as a,Xi as b,qi as c,to as d,Qi as e,Zi as f,Ki as g,Yi as h,Hi as i,Ji as j,eo as k,Bi as l,on as m,Ri as n,Ui as o,Ni as p,zi as q,Wi as u};
