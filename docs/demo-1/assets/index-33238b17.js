var fn=Object.defineProperty;var hn=(t,e,n)=>e in t?fn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var V=(t,e,n)=>(hn(t,typeof e!="symbol"?e+"":e,n),n);const x={Void:0,Bool:1,Int:2,Uint:3,Float:4,Object:5,Type:6,Comptime:7,Static:8,Literal:9,Null:10,Undefined:11},v={Primitive:0,Array:1,Struct:2,ExternStruct:3,PackedStruct:4,ArgStruct:5,ExternUnion:6,BareUnion:7,TaggedUnion:8,ErrorUnion:9,ErrorSet:10,Enumeration:11,Optional:12,Pointer:13,Slice:14,Vector:15,Opaque:16,Function:17};function Ct(t){const{type:e,bitSize:n,byteSize:s}=t;if(e===x.Int)return`${n<=32?"":"Big"}Int${n}`;if(e===x.Uint)return`${n<=32?"":"Big"}Uint${n}`;if(e===x.Float)return`Float${n}`;if(e===x.Bool)return`Bool${s!==void 0?s*8:1}`;if(e===x.Void)return"Null"}function yn(t){const{type:e,bitSize:n}=t,s=e===x.Int;let o=s?n-1:n;if(n<=32){const i=2**o-1;return{min:s?-(2**o):0,max:i}}else{o=BigInt(o);const i=2n**o-1n;return{min:s?-(2n**o):0n,max:i}}}function xe({type:t,bitSize:e}){if(t===x.Int||t===x.Uint)return e<=32?Number:BigInt;if(t===x.Float)return Number;if(t===x.Bool)return Boolean}function Ae(t){const e=xe(t);if(e)return typeof e(0)}function Kt({bitOffset:t,bitSize:e,byteSize:n}){return n!==void 0||!(t&7)&&!(e&7)||e===0}function Tt(t){return typeof t=="object"&&typeof t.error=="string"&&Object.keys(t).length===1}class dn extends TypeError{constructor(e){const{name:n}=e;super(`An initializer must be provided to the constructor of ${n}, even when the intended value is undefined`)}}class Ee extends TypeError{constructor(e,n,s=null){const{name:o,type:i,byteSize:c}=e,r=n.byteLength,l=c!==1?"s":"";let a;if(i===v.Slice&&!s)a=`${o} has elements that are ${c} byte${l} in length, received ${r}`;else{const u=i===v.Slice?s.length*c:c;a=`${o} has ${u} byte${l}, received ${r}`}super(a)}}class pn extends TypeError{constructor(e){const{type:n,byteSize:s,typedArray:o}=e,i=s!==1?"s":"",c=["ArrayBuffer","DataView"].map(Z);o&&c.push(Z(o.name));let r;n===v.Slice?r=`Expecting ${Jt(c)} that can accommodate items ${s} byte${i} in length`:r=`Expecting ${Jt(c)} that is ${s} byte${i} in length`,super(r)}}class bn extends TypeError{constructor(e,n){const{name:s}=e;let o;typeof n=="number"||typeof n=="bigint"?o=`Value given does not correspond to an item of enum ${s}: ${n}`:o=`Enum item of the type ${s} expected, received ${n}`,super(o)}}class mn extends TypeError{constructor(e,n){const{name:s}=e,o=typeof n;let i;o==="string"||o==="number"||Tt(n)?(Tt(n)&&(n=`{ error: ${JSON.stringify(n.error)} }`),i=`Error ${o} does not corresponds to any error in error set ${s}: ${n}`):i=`Error of the type ${s} expected, received ${n}`,super(i)}}class Oe extends TypeError{constructor(e){const{name:n}=e;super(`Error given is not a part of error set ${n}`)}}class ct extends TypeError{constructor(e,n,s){const{name:o}=e,i=[];if(Array.isArray(n))for(const r of n)i.push(Z(r));else i.push(Z(n));const c=Ve(s);super(`${o} expects ${Jt(i)} as argument, received ${c}`)}}class rt extends ct{constructor(e,n,s=!1){var a;const{instance:{members:[o]},type:i,typedArray:c}=e,r=[],l=Ae(o);if(l){let u;switch((a=o.structure)==null?void 0:a.type){case v.Enumeration:u="enum item";break;case v.ErrorSet:u="error";break;default:u=l}r.push(`array of ${u}s`)}else r.push("array of objects");c&&r.push(c.name),i===v.Slice&&s&&r.push("length"),super(e,r.join(" or "),n)}}class Ft extends TypeError{constructor(e,n,s){const{name:o,length:i,instance:{members:[c]}}=e,{structure:{constructor:r}}=c,{length:l,constructor:a}=s,u=(n==null?void 0:n.length)??i,f=u!==1?"s":"";let y;a===r?y="only a single one":a.child===r?y=`a slice/array that has ${l}`:y=`${l} initializer${l>1?"s":""}`,super(`${o} has ${u} element${f}, received ${y}`)}}class gn extends TypeError{constructor(e,n){const{name:s}=e;super(`Missing initializers for ${s}: ${n.join(", ")}`)}}class wn extends TypeError{constructor(e,n){const{name:s,instance:{members:o}}=e,i=o.find(r=>r.name===n);let c;i?c=`Comptime value cannot be changed: ${n}`:c=`${s} does not have a property with that name: ${n}`,super(c)}}class Sn extends Error{constructor(e,n){const{name:s,instance:{members:o}}=e,i=o.length-1,c=i!==1?"s":"";super(`${s} expects ${i} argument${c}, received ${n}`)}}class vn extends TypeError{constructor(e){super("Non-slice pointers can only be created with the help of the new operator")}}class Tn extends TypeError{constructor(e,n){const{name:s}=e,{constructor:{name:o}}=n;super(`Conversion of ${o} to ${s} requires an explicit cast`)}}class fe extends TypeError{constructor(e,n,s,o){const{name:i}=e;super(`${i} expects the sentinel value ${n} at ${o-1}, found at ${s}`)}}class Vt extends TypeError{constructor(e,n,s){const{name:o}=e;super(`${o} expects the sentinel value ${n} at ${s-1}`)}}class xn extends TypeError{constructor(e,n){super(`Unable to simultaneously align memory to ${n}-byte and ${e}-byte boundary`)}}class kt extends TypeError{constructor(e,n){const s=Ve(n);super(`Expected ${Z(e)}, received ${s}`)}}class he extends TypeError{constructor(){super("Null pointer")}}class An extends TypeError{constructor(e,n){const{name:s}=e;let o;if(n!=null){const i=typeof n,c=i==="object"&&n.constructor!==Object?`${n.constructor.name} object`:i;o=`${Me(c)} ${c}`}else o=n+"";super(`${s} cannot point to ${o}`)}}class En extends TypeError{constructor(e,n){super("Pointers in fixed memory cannot point to garbage-collected object")}}class On extends TypeError{constructor(e,n){const s=Ct(e);super(`${s} cannot represent the value given: ${n}`)}}class ye extends RangeError{constructor(e,n){const{name:s}=e;super(`Index exceeds the size of ${s??"array"}: ${n}`)}}class In extends TypeError{constructor(e){const{name:n,structure:{name:{struct:s}}}=e;super(`Unable to create ${s} as it is not situated on a byte boundary: ${n}`)}}class Vn extends TypeError{constructor(){super("Unable to modify read-only object")}}class Mn extends TypeError{constructor(e){const{name:n}=e;super(`${n} cannot point to a read-only object`)}}class de extends Error{constructor(e){super(Ie(e))}}function $n(t,e,n){const{name:s,instance:{members:o}}=t,i=`args[${e}]`,c=o.length-1,r=e!==0?"..., ":"",l=e!==c-1?", ...":"",a=r+i+l,u=Object.create(n.constructor.prototype);return u.message=`${s}(${a}): ${n.message}`,u.stack=n.stack,u}function pe(t,e,n){return n instanceof RangeError&&!(n instanceof ye)&&(n=new ye(t,e)),n}function pt(){throw new Vn}function Pn(t,e){const n=Z(t.typedArray.name),s=Z(e.constructor.name);console.warn(`Implicitly creating ${n} from ${s}`)}function Ie(t){let e=t.replace(/_/g," ");try{e=e.replace(/(\p{Uppercase}+)(\p{Lowercase}*)/gu,(n,s,o)=>{if(s.length===1)return` ${s.toLocaleLowerCase()}${o}`;if(o){const i=s.substring(0,s.length-1),c=s.charAt(s.length-1).toLocaleLowerCase();return` ${i} ${c}${o}`}else return` ${s}`}).trimStart()}catch{}return e.charAt(0).toLocaleUpperCase()+e.substring(1)}function Ve(t){const e=typeof t;let n;return e==="object"?n=t?Object.prototype.toString.call(t):"null":n=e,Z(n)}function Z(t){return`${Me(t)} ${t}`}function Me(t){return/^\W*[aeiou]/i.test(t)?"an":"a"}function Jt(t,e="or"){const n=` ${e} `;return t.length>2?t.slice(0,-1).join(", ")+n+t[t.length-1]:t.join(n)}const m=Symbol("memory"),A=Symbol("slots"),Zt=Symbol("parent"),$e=Symbol("name"),_=Symbol("type"),Pe=Symbol("tuple"),wt=Symbol("class"),be=Symbol("tag"),lt=Symbol("props"),Nt=Symbol("getter"),zt=Symbol("setter"),mt=Symbol("elementGetter"),gt=Symbol("elementSetter"),Ht=Symbol("addressGetter"),je=Symbol("addressSetter"),it=Symbol("targetGetter"),Yt=Symbol("targetSetter"),at=Symbol("entriesGetter"),dt=Symbol("fixedLocation"),Qt=Symbol("propSetters"),k=Symbol("writeDisabler"),De=Symbol("allKeys"),Xt=Symbol("length"),Ut=Symbol("proxy"),Et=Symbol("compat"),N=Symbol("size"),D=Symbol("align"),te=Symbol("array"),xt=Symbol("pointer"),ut=Symbol("constTarget"),Wt=Symbol("constProxy"),$=Symbol("copier"),me=Symbol("resetter"),G=Symbol("vivificator"),j=Symbol("pointerVisitor"),St=Symbol("environment"),Mt=Symbol("attributes"),Ce=Symbol("more");function Q(t){return function(){const e=this[m];this[m]=null,this[A]&&(this[A]={}),t.releaseFixedView(e)}}function ge(t,e,n){if(t+e<=8){const s=2**e-1;if(n)return function(o,i,c){const l=i.getUint8(c)>>t&s;o.setUint8(0,l)};{const o=255^s<<t;return function(i,c,r){const l=c.getUint8(0),u=i.getUint8(r)&o|(l&s)<<t;i.setUint8(r,u)}}}else{const s=8-t,o=2**s-1;if(n){const c=2**(e%8)-1;return function(r,l,a){let u=a,f=0,y=l.getUint8(u++),h,p=y>>t&o,d=s,b=e;do b>d&&(y=l.getUint8(u++),p=p|y<<d),h=b>=8?p&255:p&c,r.setUint8(f++,h),p>>=8,b-=8;while(b>0)}}else{const c=2**((e-s)%8)-1,r=255^o<<t,l=255^c;return function(a,u,f){let y=0,h=f,p=a.getUint8(h),d,b,g=p&r,w=t,O=e+w;do O>w&&(d=u.getUint8(y++),g=g|d<<w,w+=8),O>=8?b=g&255:(p=a.getUint8(h),b=p&l|g&c),a.setUint8(h++,b),g>>=8,w-=8,O-=8;while(O>0)}}}}function z(t,e=!1){const n=Fe(t,e);return function(s){R.call(this),R.call(s);const o=s[m],i=this[m];n(i,o)}}function Fe(t,e=!1){if(!e){const n=jn[t];if(n)return n}return t&7?t&3?t&1?Dn:Cn:Fn:kn}const jn={1:Nn,2:zn,4:Un,8:Bn,16:Ln,32:Rn};function Dn(t,e){for(let n=0,s=t.byteLength;n<s;n++)t.setInt8(n,e.getInt8(n))}function Cn(t,e){for(let n=0,s=t.byteLength;n<s;n+=2)t.setInt16(n,e.getInt16(n,!0),!0)}function Fn(t,e){for(let n=0,s=t.byteLength;n<s;n+=4)t.setInt32(n,e.getInt32(n,!0),!0)}function kn(t,e){for(let n=0,s=t.byteLength;n<s;n+=8)t.setInt32(n,e.getInt32(n,!0),!0),t.setInt32(n+4,e.getInt32(n+4,!0),!0)}function Nn(t,e){t.setInt8(0,e.getInt8(0))}function zn(t,e){t.setInt16(0,e.getInt16(0,!0),!0)}function Un(t,e){t.setInt32(0,e.getInt32(0,!0),!0)}function Bn(t,e){t.setInt32(0,e.getInt32(0,!0),!0),t.setInt32(4,e.getInt32(4,!0),!0)}function Ln(t,e){t.setInt32(0,e.getInt32(0,!0),!0),t.setInt32(4,e.getInt32(4,!0),!0),t.setInt32(8,e.getInt32(8,!0),!0),t.setInt32(12,e.getInt32(12,!0),!0)}function Rn(t,e){t.setInt32(0,e.getInt32(0,!0),!0),t.setInt32(4,e.getInt32(4,!0),!0),t.setInt32(8,e.getInt32(8,!0),!0),t.setInt32(12,e.getInt32(12,!0),!0),t.setInt32(16,e.getInt32(16,!0),!0),t.setInt32(20,e.getInt32(20,!0),!0),t.setInt32(24,e.getInt32(24,!0),!0),t.setInt32(28,e.getInt32(28,!0),!0)}function _n(t,e){const n=Gn(e);return function(){R.call(this);const s=this[m];n(s,t,e)}}function Gn(t){const e=Wn[t];return e||(t&7?t&3?t&1?qn:Jn:Hn:Yn)}const Wn={1:Xn,2:Kn,4:Zn,8:Qn,16:ts,32:es};function qn(t,e,n){for(let s=e,o=e+n;s<o;s++)t.setInt8(s,0)}function Jn(t,e,n){for(let s=e,o=e+n;s<o;s+=2)t.setInt16(s,0,!0)}function Hn(t,e,n){for(let s=e,o=e+n;s<o;s+=4)t.setInt32(s,0,!0)}function Yn(t,e,n){for(let s=e,o=e+n;s<o;s+=8)t.setInt32(s,0,!0),t.setInt32(s+4,0,!0)}function Xn(t,e){t.setInt8(e,0)}function Kn(t,e){t.setInt16(e,0,!0)}function Zn(t,e){t.setInt32(e,0,!0)}function Qn(t,e){t.setInt32(e+0,0,!0),t.setInt32(e+4,0,!0)}function ts(t,e){t.setInt32(e+0,0,!0),t.setInt32(e+4,0,!0),t.setInt32(e+8,0,!0),t.setInt32(e+12,0,!0)}function es(t,e){t.setInt32(e+0,0,!0),t.setInt32(e+4,0,!0),t.setInt32(e+8,0,!0),t.setInt32(e+12,0,!0),t.setInt32(e+16,0,!0),t.setInt32(e+20,0,!0),t.setInt32(e+24,0,!0),t.setInt32(e+28,0,!0)}function R(){const t=this[m],e=t[m];if(!e||t.buffer.byteLength!==0)return!1;const{memory:n,address:s,len:o}=e,i=new DataView(n.buffer,s,o);return i[m]=e,this[m]=i,!0}function ns(t,e){return Be(t,e,()=>{if(Kt(e)){const{byteSize:n}=e,s=Ct({type:x.Int,bitSize:n*8});if(t==="get"){const o=DataView.prototype[`get${s}`];return function(i,c){return!!o.call(this,i,c)}}else{const o=DataView.prototype[`set${s}`],i=n>4?1n:1,c=n>4?0n:0;return function(r,l,a){o.call(this,r,l?i:c,a)}}}else return Ne(t,e)})}function At(t,e){return Be(t,e,n=>DataView.prototype[n]?DataView.prototype[n]:Ne(t,e))}const ke={};function mo(){ke[x.Uint]=ss}function Ne(t,e){const n=ke[e.type];return n(t,e)}function ss(t,e){return Kt(e)?as(t,e):us(t,e)}function Bt(t,e,n){const{type:s,byteSize:o,typedArray:i}=t;let c;const r=e==null?void 0:e[Symbol.toStringTag];if(r==="DataView")c=e;else if(r==="ArrayBuffer"||r==="SharedArrayBuffer")c=n.obtainView(e,0,e.byteLength);else if(i&&r===i.name||r==="Uint8ClampedArray"&&i===Uint8Array)c=n.obtainView(e.buffer,e.byteOffset,e.byteLength);else if(r==="Uint8Array"&&typeof Buffer=="function"&&e instanceof Buffer)c=n.obtainView(e.buffer,e.byteOffset,e.byteLength);else{const l=e==null?void 0:e[m];if(l){const{constructor:a,instance:{members:[u]}}=t;if(e instanceof a)return l;if(s===v.Array||s===v.Slice||s===v.Vector){const{byteSize:f,structure:{constructor:y}}=u,h=Ue(e,y);if(h!==void 0){if(s===v.Slice||h*f===o)return l;throw new Ft(t,null,e)}}}}return c&&o!==void 0&&ze(c,t),c}function os(t){if((t==null?void 0:t[Symbol.toStringTag])!=="DataView")throw new kt("a DataView",t);return t}function ze(t,e){const{byteSize:n,type:s}=e;if(s===v.Slice?t.byteLength%n!==0:t.byteLength!==n)throw new Ee(e,t)}function Ot(t,e,n,s,o){const{byteSize:i,type:c,sentinel:r}=e,l=c===v.Slice;if(this[m]){const a=l?i*this.length:i;if(t.byteLength!==a)throw new Ee(e,t,this);const u={[m]:t};r==null||r.validateData(u,this.length),this[$](u)}else{const{shapeDefiner:a}=o;ze(t,e);const u=t.byteLength/i,f={[m]:t};r==null||r.validateData(f,u),s&&(n=!0),a.call(this,n?null:t,u,s),n&&this[$](f)}}function Ue(t,e){const{constructor:n}=t;if(n===e)return 1;if(n.child===e)return t.length}function is(t,e,n){const s=Bt(t,e,n);if(!s)throw new pn(t);return s}function ft(t){const{type:e,byteSize:n}=t;if(e===x.Int)switch(n){case 1:return Int8Array;case 2:return Int16Array;case 4:return Int32Array;case 8:return BigInt64Array}else if(e===x.Uint)switch(n){case 1:return Uint8Array;case 2:return Uint16Array;case 4:return Uint32Array;case 8:return BigUint64Array}else if(e===x.Float)switch(n){case 4:return Float32Array;case 8:return Float64Array}else if(e===x.Object)return t.structure.typedArray;return null}function rs(t,e){const n=t==null?void 0:t[Symbol.toStringTag];return!!e&&n===e.name}function cs(t,e){const n=e[Et];if(n){const s=t==null?void 0:t[Symbol.toStringTag];if(n.includes(s))return!0}return!!(e.child&&Ue(t,e.child)!==void 0)}function Lt(t){const{typedArray:e}=t,n=[];return e&&(n.push(e.name),n.push("DataView"),(e===Uint8Array||e===Int8Array)&&(n.push("ArrayBuffer"),n.push("SharedArrayBuffer"),e===Uint8Array&&n.push("Uint8ClampedArray"))),n}function ls(t){const e=DataView.prototype.getBigUint64,n=DataView.prototype.setBigUint64,s=Math.ceil(t/64);return{get:function(o,i){let c=0n;if(i)for(let r=0,l=o+(s-1)*8;r<s;r++,l-=8){const a=e.call(this,l,i);c=c<<64n|a}else for(let r=0,l=o;r<s;r++,l+=8){const a=e.call(this,l,i);c=c<<64n|a}return c},set:function(o,i,c){let r=i;const l=0xFFFFFFFFFFFFFFFFn;if(c)for(let a=0,u=o;a<s;a++,u+=8){const f=r&l;n.call(this,u,f,c),r>>=64n}else{r<<=BigInt(s*64-t);for(let a=0,u=o+(s-1)*8;a<s;a++,u-=8){const f=r&l;n.call(this,u,f,c),r>>=64n}}return r}}}function as(t,e){const{bitSize:n,byteSize:s}=e;if(n<64){const o=Ct({...e,bitSize:s*8}),i=DataView.prototype[`get${o}`],c=DataView.prototype[`set${o}`],r=n<=32?2**n-1:2n**BigInt(n)-1n;return t==="get"?function(l,a){return i.call(this,l,a)&r}:function(l,a,u){const f=a&r;c.call(this,l,f,u)}}else{const{get:o,set:i}=ls(n),c=2n**BigInt(n)-1n;return t==="get"?function(r,l){return o.call(this,r,l)&c}:function(r,l,a){const u=l&c;i.call(this,r,u,a)}}}function us(t,e){const{bitSize:n,bitOffset:s}=e,o=s&7;if(o+n<=8){const i=DataView.prototype.setUint8,c=DataView.prototype.getUint8,r=2**n-1;if(t==="get")return function(l){return c.call(this,l)>>>o&r};{const l=255^r<<o;return function(a,u){const y=c.call(this,a)&l|(u&r)<<o;i.call(this,a,y)}}}return fs(t,e)}function fs(t,e){const{bitSize:n,bitOffset:s}=e,o=s&7,i=[1,2,4,8].find(r=>r*8>=n)??Math.ceil(n/64)*64,c=new DataView(new ArrayBuffer(i));if(t==="get"){const r=At("get",{...e,byteSize:i}),l=ge(o,n,!0);return function(a,u){return l(c,this,a),r.call(c,0,u)}}else{const r=At("set",{...e,byteSize:i}),l=ge(o,n,!1);return function(a,u,f){r.call(c,0,u,f),l(this,c,a)}}}const we={};function Be(t,e,n){const{type:s,bitOffset:o,bitSize:i,structure:c}=e,r=o&7,l=Ct(e),a=Kt(e)?"":`Bit${r}`,u=s===x.Int||s===x.Uint;let f=`${t}${l}${a}`,y=!1,h=f;if(u&&i===64){const d=c==null?void 0:c.name;(d==="usize"||d==="isize")&&(f+="Size",y=!0)}let p=we[f];if(!p){if(u&&t==="set"){const d=xe(e),b=n(h);p=function(g,w,O){b.call(this,g,d(w),O)}}else if(y&&t==="get"){const d=n(h),b=BigInt(Number.MIN_SAFE_INTEGER),g=BigInt(Number.MAX_SAFE_INTEGER);p=function(w,O){const P=d.call(this,w,O);return b<=P&&P<=g?Number(P):P}}else p=n(f);p&&p.name!==f&&Object.defineProperty(p,"name",{value:f,configurable:!0,writable:!1}),we[f]=p}return p}function hs({type:t}){switch(t){case x.Type:case x.Comptime:case x.Literal:return!0;default:return!1}}const tt={};function go(){tt[x.Bool]=bs}function wo(){tt[x.Int]=ms}function ys(){tt[x.Uint]=gs}function So(){tt[x.Float]=ws}function vo(){tt[x.Object]=xs}function To(){tt[x.Type]=Es}function xo(){tt[x.Comptime]=Os}const ee={};function ds(){ee[v.Enumeration]=Ss}function ps(){ee[v.ErrorSet]=vs}function C(t,e){const n=tt[t.type];return n(t,e)}function Le(t,e){const{structure:n}=e,s=ee[n==null?void 0:n.type];return s?s(t,n):t}function bs(t,e){return Rt(t,e,ns)}function ms(t,e){const n=Re(e,At),s=Rt(t,e,n);return Le(s,t)}function gs(t,e){const n=Re(e,At),s=Rt(t,e,n);return Le(s,t)}function Re(t,e){return function(n,s){const{runtimeSafety:o=!0}=t,i=e(n,s);if(o&&n==="set"){const{min:c,max:r}=yn(s);return function(l,a,u){if(a<c||a>r)throw new On(s,a);i.call(this,l,a,u)}}return i}}function ws(t,e){return Rt(t,e,At)}function Ss(t,e){const n=function(s){const{constructor:o}=e,i=o(s);if(!i)throw new bn(e,s);return i};return{get:t.get.length===0?function(o){const i=t.get.call(this);return o==="number"?i:n(i)}:function(o){const i=t.get.call(this,o);return n(i)},set:t.set.length===1?function(o,i){i!=="number"&&(o=n(o)[Symbol.toPrimitive]()),t.set.call(this,o)}:function(o,i){const c=n(i);t.set.call(this,o,c[Symbol.toPrimitive]())}}}function vs(t,e){const n=function(s){const{constructor:o}=e,i=o(s);if(!i)throw s instanceof Error?new Oe(e):new mn(e,s);return i};return{get:t.get.length===0?function(o){const i=t.get.call(this);return o==="number"?i:n(i)}:function(o){const i=t.get.call(this,o);return n(i)},set:t.set.length===1?function(o,i){if(i!=="number"){const c=n(o);o=Number(c)}t.set.call(this,o)}:function(o,i){const c=n(i);i=Number(c),t.set.call(this,o,i)}}}function ne(t){switch(t.type){case v.Primitive:case v.ErrorUnion:case v.Optional:case v.Enumeration:case v.ErrorSet:return!0;default:return!1}}function _e(t){return(this[A][t]??this[G](t))[Nt]()}function Ge(t){return this[A][t]??this[G](t)}function Ts(t,e){(this[A][t]??this[G](t))[zt](e)}function se(t,{get:e,set:n}){return t!==void 0?{get:function(){return e.call(this,t)},set:n?function(s){return n.call(this,t,s)}:void 0}:{get:e,set:n}}function xs(t,e){const{structure:n,slot:s}=t;return se(s,{get:ne(n)?_e:Ge,set:Ts})}function As(t){const e=this[A][t];return e==null?void 0:e.constructor}function Es(t,e){const{slot:n}=t;return se(n,{get:As})}function Os(t,e){const{slot:n,structure:s}=t;return se(n,{get:ne(s)?_e:Ge})}function Rt(t,e,n){const{littleEndian:s=!0}=e,{bitOffset:o,byteSize:i}=t,c=n("get",t),r=n("set",t);if(o!==void 0){const l=o>>3;return{get:function(){try{return c.call(this[m],l,s)}catch(u){if(u instanceof TypeError&&R.call(this))return c.call(this[m],l,s);throw u}},set:function(u){try{return r.call(this[m],l,u,s)}catch(f){if(f instanceof TypeError&&R.call(this))return r.call(this[m],l,u,s);throw f}}}}else return{get:function(a){try{return c.call(this[m],a*i,s)}catch(u){if(u instanceof TypeError&&R.call(this))return c.call(this[m],a*i,s);throw pe(t,a,u)}},set:function(a,u){try{return r.call(this[m],a*i,u,s)}catch(f){if(f instanceof TypeError&&R.call(this))return r.call(this[m],a*i,u,s);throw pe(t,a,f)}}}}function F(t,e){for(const[n,s]of Object.entries(e))if(s){const{set:o,get:i,value:c,enumerable:r,configurable:l=!0,writable:a=!0}=s;Object.defineProperty(t,n,i?{get:i,set:o,configurable:l,enumerable:r}:{value:c,configurable:l,enumerable:r,writable:a})}for(const n of Object.getOwnPropertySymbols(e)){const s=e[n];s&&Object.defineProperty(t,n,s)}}function H(t,e,n){const s={};for(const[c,r]of Object.entries(e))r!=null&&r.set&&c!=="$"&&(s[c]=r.set);const{get:o,set:i}=e.$;return F(t.prototype,{[De]:{value:Object.keys(s)},[zt]:{value:i},[Nt]:{value:o},[Qt]:{value:s},[ut]:{value:null},...e}),F(t,n),t}function ht(){const t=Object.getOwnPropertyDescriptors(this.constructor.prototype);for(const[e,n]of Object.entries(t))n.set&&(n.set=pt,Object.defineProperty(this,e,n));Object.defineProperty(this,zt,{value:pt}),Object.defineProperty(this,ut,{value:this})}function Y(t,e,n){const{byteSize:s,align:o,instance:{members:i,template:c},hasPointer:r}=t,{modifier:l,initializer:a,finalizer:u,alternateCaster:f,shapeDefiner:y}=e,h=Is(i);let p;if(c!=null&&c[A]){const g=i.filter(w=>hs(w));g.length>0&&(p=g.map(w=>w.slot))}const d=new Vs,b=function(g,w={}){const{fixed:O=!1}=w,P=this instanceof b;let M,T;if(P){if(arguments.length===0)throw new dn(t);M=this,h&&(M[A]={}),y?(a.call(M,g,O),T=M[m]):M[m]=T=n.allocateMemory(s,o,O)}else{if(f&&(M=f.call(this,g,w),M!==!1)||(T=is(t,g,n),M=d.find(T)))return M;M=Object.create(b.prototype),y?Ot.call(M,T,t,!1,!1,{shapeDefiner:y}):M[m]=T,h&&(M[A]={})}if(p)for(const E of p)M[A][E]=c[A][E];return l&&l.call(M),P&&(y||a.call(M,g)),u&&(M=u.call(M)),d.save(T,M)};return b}function It({source:t}){const e=t[A][0];e&&this[Yt](e)}function et(t){const{instance:{template:e}}=t;return function(n,s){var f;const o=Object.keys(n),i=this[Qt],c=this[De];for(const y of o)if(!(y in i))throw new wn(t,y);let r=0,l=0,a=0,u=0;for(const y of c){const h=i[y];h.special?y in n&&u++:(r++,y in n?l++:h.required&&a++)}if(a!==0&&u===0){const y=c.filter(h=>i[h].required&&!(h in n));throw new gn(t,y)}if(u+l>o.length)for(const y of c)y in n&&(o.includes(y)||o.push(y));l<r&&u===0&&e&&(e[m]&&this[$](e),(f=this[j])==null||f.call(this,It,{vivificate:!0,source:e}));for(const y of o)i[y].call(this,n[y],s);return o.length}}function Is(t){for(const{type:e}of t)switch(e){case x.Object:case x.Comptime:case x.Type:case x.Literal:return!0}return!1}function We(){return this}class Vs{constructor(){V(this,"map",new WeakMap)}find(e){return this.map.get(e)}save(e,n){return this.map.set(e,n),n}}const Se={},ve={};function vt(t,e="utf-8"){let n=Se[e];n||(n=Se[e]=new TextDecoder(e));let s;if(Array.isArray(t))if(t.length===1)s=t[0];else{let o=0;for(const r of t)o+=r.length;const{constructor:i}=t[0];s=new i(o);let c=0;for(const r of t)s.set(r,c),c+=r.length}else s=t;return n.decode(s)}function Ms(t,e="utf-8"){switch(e){case"utf-16":{const{length:n}=t,s=new Uint16Array(n);for(let o=0;o<n;o++)s[o]=t.charCodeAt(o);return s}default:{let n=ve[e];return n||(n=ve[e]=new TextEncoder),n.encode(t)}}}function $s(t){const e=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=String.fromCharCode.apply(null,e);return btoa(n)}function Ps(t){const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<n.byteLength;s++)n[s]=e.charCodeAt(s);return new DataView(n.buffer)}function U(){return qe(this,!1)}function W(){return qe(this,!0)}const js=BigInt(Number.MAX_SAFE_INTEGER),Ds=BigInt(Number.MIN_SAFE_INTEGER);function qe(t,e){const n=e?"return":"throw",s=new Map,o=function(i){var l,a,u;const c=typeof i=="function"?v.Struct:(l=i==null?void 0:i.constructor)==null?void 0:l[_];if(c===void 0){if(e){if(typeof i=="bigint"&&Ds<=i&&i<=js)return Number(i);if(i instanceof Error)return{error:i.message}}return i}let r=s.get(i);if(r===void 0){let f;switch(c){case v.Struct:case v.PackedStruct:case v.ExternStruct:case v.TaggedUnion:case v.BareUnion:case v.ExternUnion:f=(a=i[at])==null?void 0:a.call(i,{error:n}),r=i.constructor[Pe]?[]:{};break;case v.Array:case v.Vector:case v.Slice:f=(u=i[at])==null?void 0:u.call(i,{error:n}),r=[];break;case v.Pointer:try{r=i["*"]}catch{r=Symbol.for("inaccessible")}break;case v.Enumeration:r=Pt(()=>String(i),{error:n});break;case v.Opaque:r={};break;default:r=Pt(()=>i.$,{error:n})}if(r=o(r),s.set(i,r),f)for(const[y,h]of f)r[y]=o(h)}return r};return o(t)}function Pt(t,e={}){const{error:n="throw"}=e;try{return t()}catch(s){debugger;if(n==="return")return s;throw s}}function nt(t,e={}){return _t({get(){return R.call(this),this[m]},set(n,s){os(n),Ot.call(this,n,t,!0,s,e)}})}function st(t,e={}){return _t({get(){return $s(this.dataView)},set(n,s){if(typeof n!="string")throw new kt("string",n);const o=Ps(n);Ot.call(this,o,t,!1,s,e)}})}function Je(t,e={}){const{sentinel:n,instance:{members:s}}=t,{byteSize:o}=s[0];return _t({get(){const i=this.dataView,c=o===1?Int8Array:Int16Array,r=new c(i.buffer,i.byteOffset,this.length),l=vt(r,`utf-${o*8}`);return(n==null?void 0:n.value)===void 0?l:l.slice(0,-1)},set(i,c){if(typeof i!="string")throw new kt("a string",i);(n==null?void 0:n.value)!==void 0&&i.charCodeAt(i.length-1)!==n.value&&(i=i+String.fromCharCode(n.value));const r=Ms(i,`utf-${o*8}`),l=new DataView(r.buffer);Ot.call(this,l,t,!1,c,e)}})}function bt(t,e={}){const{typedArray:n}=t;return _t({get(){const s=this.dataView,o=s.byteLength/n.BYTES_PER_ELEMENT;return new n(s.buffer,s.byteOffset,o)},set(s,o){if(!rs(s,n))throw new kt(n.name,s);const i=new DataView(s.buffer,s.byteOffset,s.byteLength);Ot.call(this,i,t,!0,o,e)}})}function _t({get:t,set:e}){return t.special=e.special=!0,{get:t,set:e}}let K,$t;function He(t,e){const{name:n,byteSize:s,align:o,instance:{members:[i]}}=t;if($t||($t=class extends ks{},K=He({...t,name:"anyerror"},e)),K&&n==="anyerror")return t.constructor=K,t.typedArray=ft(i),K;const c=$t,{get:r,set:l}=C(i,e),a=["string","number"],u=et(t),f=function(g){if(g instanceof h[wt])l.call(this,g);else if(g&&typeof g=="object"&&!Tt(g)){if(u.call(this,g)===0)throw new ct(t,a,g)}else g!==void 0&&l.call(this,g)},y=function(g){if(typeof g=="number"||typeof g=="string")return h[g];if(g instanceof h[wt])return h[Number(g)];if(Tt(g))return h[`Error: ${g.error}`];if(Bt(t,g,e))return!1;throw new ct(t,a,g)},h=t.constructor=Y(t,{initializer:f,alternateCaster:y},e),p=t.typedArray=ft(i),d={$:{get:r,set:l},dataView:nt(t),base64:st(t),typedArray:p&&bt(t),valueOf:{value:U},toJSON:{value:W},delete:{value:Q(e)},[$]:{value:z(s)},[k]:{value:ht}},b={[D]:{value:o},[N]:{value:s},[wt]:{value:c},[lt]:n==="anyerror"?{value:[]}:void 0,[_]:{value:t.type}};return H(h,d,b)}function Cs(t,e,n){const s=n[Nt]("number");let o=K[s];if(!o){const r=t[wt];o=new r(e,s)}const i=String(o),c={[s]:{value:o},[i]:{value:o},[e]:{value:o}};F(t,c),F(K,c),K[lt].push(e)}function Fs(){$t=K=void 0}class ks extends Error{constructor(e,n){super(Ie(e)),this.number=n,this.stack=void 0}[Symbol.toPrimitive](e){switch(e){case"string":case"default":return Error.prototype.toString.call(this,e);default:return this.number}}toJSON(){return{error:this.message}}}function Ns(t,e){const n=(s,{methods:o},i)=>{const c={},r=/^(get|set)\s+([\s\S]+)/;for(const l of o){const a=e.createCaller(l,i),u=r.exec(a.name);if(u){const f=u[1],y=u[2],h=f==="get"?0:1;if(zs(l,i)===h){let d=c[y];d||(d=c[y]={configurable:!0,enumerable:!0}),d[f]=a}}else c[a.name]={value:a,configurable:!0,writable:!0}}F(s,c)};n(t.constructor,t.static,!1),n(t.constructor.prototype,t.instance,!0)}function zs(t,e){const{argStruct:{instance:{members:n}}}=t;return n.length-(e?2:1)}function Us(t,e){const{byteSize:n,align:s,instance:{members:[o]}}=t,{get:i,set:c}=C(o,e),r=["string","number","tagged union"],l=et(t),a=function(b){if(b&&typeof b=="object"){if(l.call(this,b)===0)throw new ct(t,r,b)}else b!==void 0&&c.call(this,b)},u=function(b){if(typeof b=="string"||typeof b=="number"||typeof b=="bigint"){let g=f[b];if(!g&&f[Ce]&&typeof b!="string"){g=new f(void 0);debugger;c.call(g,b,"number"),Ye(f,`${b}`,g)}return g}else{if(b instanceof f)return b;if((b==null?void 0:b[be])instanceof f)return b[be];if(Bt(t,b,e))return!1;throw new ct(t,r,b)}},f=t.constructor=Y(t,{initializer:a,alternateCaster:u},e),y=t.typedArray=ft(o),h=function(b){switch(b){case"string":case"default":return this.$[$e];default:return i.call(this,"number")}},p={$:{get:i,set:c},dataView:nt(t),base64:st(t),typedArray:y&&bt(t),valueOf:{value:U},toString:{value:U},toJSON:{value:W},delete:{value:Q(e)},[Symbol.toPrimitive]:{value:h},[$]:{value:z(n)},[k]:{value:ht}},d={[D]:{value:s},[N]:{value:n},[_]:{value:t.type}};return H(f,p,d)}function Ye(t,e,n){if(e!==void 0){if(n instanceof t){F(n,{[$e]:{value:e}});const s=n[Symbol.toPrimitive]();F(t,{[s]:{value:n},[e]:{value:n}})}}else F(t,{[Ce]:{value:!0}})}function Bs(t,e){const{byteSize:n,align:s,instance:{members:[o]},isConst:i}=t,{runtimeSafety:c=!0}=e,{structure:r}=o,{type:l,sentinel:a,length:u}=r,f=l===v.Slice&&r.length===void 0&&!a,y=f?n/2:n,{get:h,set:p}=C({type:x.Uint,bitOffset:0,bitSize:y*8,byteSize:y,structure:{byteSize:y}},e),{get:d,set:b}=f?C({type:x.Uint,bitOffset:y*8,bitSize:y*8,byteSize:y,structure:{name:"usize",byteSize:y}},e):{},g=function(){const S=this[dt];if(S){const I=this[Ht]();if(I.address!==S.address||I.length!==S.length){const{constructor:q}=r,X=e.findMemory(I.address,I.length,q[N]),Gt=q.call(St,X);this[A][0]=Gt,this[dt]=I}}},w=function(){g.call(this);const S=this[A][0];if(!S)throw new he;return i?Xe(S):S},O=function(S){if(e.inFixedMemory(this))if(e.inFixedMemory(S)){const I={address:e.getViewAddress(S[m]),length:f?S.length:ae};le.call(this,I),this[dt]=I}else throw new En(t,S);this[A][0]=S},P=ne(r)?function(){return w.call(this)[Nt]()}:w,M=i?pt:function(S){g.call(this);const I=this[A][0];if(!I)throw new he;return I[zt](S)},T=function(S,I){const q=r.constructor;if(this===St||this===Zt||S instanceof ot)return!1;if(Te(S,q))return new ot(q(S["*"]),I);if(l===v.Slice)return new ot(q(S),I);throw new vn(t)},E=function(){const S=l===v.Pointer?{}:qs,I=new Proxy(this,S);return Object.defineProperty(this,Ut,{value:I}),I},L=function(S){var q;const I=r.constructor;if(Te(S,I)){if(!i&&S.constructor.const)throw new Tn(t,S);S=S[A][0]}if(S instanceof I){R.call(S);const X=S[ut];if(X)if(i)S=X;else throw new Mn(t)}else if(cs(S,I)){const X=Bt(r,S,e);S=I(X)}else if(S!==void 0&&!S[m]){const X=e.inFixedMemory(this),Gt=new I(S,{fixed:X});if(c&&r.typedArray){const ue=(q=S==null?void 0:S.buffer)==null?void 0:q[Symbol.toStringTag];(ue==="ArrayBuffer"||ue==="SharedArrayBuffer")&&Pn(r,S)}S=Gt}else if(S!==void 0)throw new An(t,S);this[Yt](S)},ot=t.constructor=Y(t,{initializer:L,alternateCaster:T,finalizer:E},e),le=function({address:S,length:I}){p.call(this,S),b==null||b.call(this,I)},ae=l!=v.Slice?1:u,ln=function(){const S=h.call(this),I=d?d.call(this):a?S?e.findSentinel(S,a.bytes)+1:0:ae;return{address:S,length:I}},an={"*":{get:P,set:M},$:{get:oe,set:L},valueOf:{value:U},toJSON:{value:W},delete:{value:Rs},[Symbol.toPrimitive]:l===v.Primitive&&{value:_s},[it]:{value:w},[Yt]:{value:O},[Ht]:{value:ln},[je]:{value:le},[j]:{value:Ws},[$]:{value:z(n)},[dt]:{value:void 0,writable:!0},[k]:{value:Ls}},un={child:{get:()=>r.constructor},const:{value:i},[D]:{value:s},[N]:{value:n},[_]:{value:t.type}};return H(ot,an,un)}function Ls(){const t=this[xt],e=Object.getOwnPropertyDescriptor(t.constructor.prototype,"$");e.set=pt,Object.defineProperty(t,"$",e),Object.defineProperty(t,ut,{value:t})}function Rs(){const t=this[A][0];t==null||t.delete()}function _s(t){return this[A][0][Symbol.toPrimitive](t)}function oe(){return this[Ut]}function Gs({isActive:t}){this[A][0]&&!t(this)&&(this[A][0]=void 0)}function Ws(t,e={}){const{source:n,isActive:s=J,isMutable:o=J}=e;t.call(this,{source:n,isActive:s,isMutable:o})}function Te(t,e){var n;return((n=t==null?void 0:t.constructor)==null?void 0:n.child)===e&&t["*"]}function Xe(t){let e=t[Wt];return e||(Object.defineProperty(t,Wt,{value:void 0,configurable:!0}),e=new Proxy(t,Js),Object.defineProperty(t,Wt,{value:e})),e}const qs={get(t,e){return e===xt?t:e in t?t[e]:t[it]()[e]},set(t,e,n){if(e in t)t[e]=n;else{const s=t[it]();s[e]=n}return!0},deleteProperty(t,e){if(e in t)delete t[e];else{const n=t[it]();delete n[e]}return!0},has(t,e){if(e in t)return!0;{const n=t[it]();return e in n}}},Js={get(t,e){if(e===ut)return t;{const n=t[e];return(n==null?void 0:n[ut])===null?Xe(n):n}},set(t,e,n){const s=t[xt];if(s&&!(e in s))return t[e]=n,!0;pt()}};function J(){return!0}function Hs(t,e){const{length:n,byteSize:s,align:o,instance:{members:[i]}}=t,{bitSize:c,structure:r}=i,l={};for(let d=0,b=0;d<n;d++,b+=c){const{get:g,set:w}=C({...i,bitOffset:b},e);l[d]={get:g,set:w,configurable:!0}}const a=et(t),u=function(d){if(d instanceof f)this[$](d);else if(d!=null&&d[Symbol.iterator]){let b=d.length;if(typeof b!="number"&&(d=[...d],b=d.length),b!==n)throw new Ft(t,this,d);let g=0;for(const w of d)this[Qt][g++].call(this,w)}else if(d&&typeof d=="object"){if(a.call(this,d)===0)throw new rt(t,d)}else if(d!==void 0)throw new rt(t,d)},f=t.constructor=Y(t,{initializer:u},e),y=t.typedArray=ft(i),h={...l,$:{get:We,set:u},length:{value:n},dataView:nt(t),base64:st(t),typedArray:y&&bt(t),valueOf:{value:U},toJSON:{value:W},entries:{value:jt},delete:{value:Q(t)},[Symbol.iterator]:{value:Ke},[at]:{value:jt},[$]:{value:z(s)},[k]:{value:ht}},p={child:{get:()=>r.constructor},[Et]:{value:Lt(t)},[D]:{value:o},[N]:{value:s},[_]:{value:t.type}};return H(f,h,p)}function Ke(){const t=this,e=this.length;let n=0;return{next(){let s,o;if(n<e){const i=n++;s=t[i],o=!1}else o=!0;return{value:s,done:o}}}}function Ys(){const t=this,e=this.length;let n=0;return{next(){let s,o;if(n<e){const i=n++;s=[i,t[i]],o=!1}else o=!0;return{value:s,done:o}}}}function jt(){return{[Symbol.iterator]:Ys.bind(this),length:this.length}}function Xs(t,e){const{byteSize:n,align:s,instance:{members:o},isTuple:i,hasPointer:c}=t,r={};for(const p of o){const{get:d,set:b}=C(p,e);r[p.name]={get:d,set:b,configurable:!0,enumerable:!0},p.isRequired&&b&&(b.required=!0)}const l=!!o.find(p=>p.type===x.Object),a=et(t),u=function(p){if(p instanceof f)this[$](p),c&&this[j](It,{vivificate:!0,source:p});else if(p&&typeof p=="object")a.call(this,p);else if(p!==void 0)throw new ct(t,"object",p)},f=t.constructor=Y(t,{initializer:u},e),y={$:{get:We,set:u},dataView:nt(t),base64:st(t),length:i&&{value:o.length>0?parseInt(o[o.length-1].name)+1:0},valueOf:{value:U},toJSON:{value:W},delete:{value:Q(e)},entries:i&&{value:jt},...r,[Symbol.iterator]:{value:i?Ke:Ze},[at]:{value:i?jt:ie},[$]:{value:z(n)},[G]:l&&{value:re(t)},[j]:c&&{value:ce(t,J)},[k]:{value:ht},[lt]:{value:o.map(p=>p.name)}},h={[D]:{value:s},[N]:{value:n},[_]:{value:t.type},[Pe]:{value:i}};return H(f,y,h)}function ie(t){return{[Symbol.iterator]:Ks.bind(this,t),length:this[lt].length}}function Ze(t){return ie.call(this,t)[Symbol.iterator]()}function Ks(t){const e=this,n=this[lt];let s=0;return{next(){let o,i;if(s<n.length){const c=n[s++];o=[c,Pt(()=>e[c],t)],i=!1}else i=!0;return{value:o,done:i}}}}function re(t){const{instance:{members:e}}=t,n={};for(const s of e.filter(o=>o.type===x.Object))n[s.slot]=s;return function(o){const i=n[o],{bitOffset:c,byteSize:r,structure:{constructor:l}}=i,a=this[m],f=a.byteOffset+(c>>3);let y=r;if(y===void 0){if(c&7)throw new In(i);y=i.bitSize>>3}const h=new DataView(a.buffer,f,y);return this[A][o]=l.call(Zt,h)}}function ce(t,e={}){const{isChildActive:n=J,isChildMutable:s=J}=e,{instance:{members:o}}=t,i=o.filter(c=>c.structure.hasPointer);return function(r,l={}){var p;const{source:a,vivificate:u=!1,isActive:f=J,isMutable:y=J}=l,h={...l,isActive:d=>f(this)&&n.call(this,d),isMutable:d=>y(this)&&s.call(this,d)};for(const{slot:d}of i){if(a){const g=(p=a[A])==null?void 0:p[d];if(!g)continue;h.source=g}const b=this[A][d]??(u?this[G](d):null);b&&b[j](r,h)}}}function Zs(t,e){const{type:n,constructor:s,static:{members:o,template:i}}=t,c={};for(const r of o)c[r.name]=C(r,e);if(F(s,{valueOf:{value:U},toJSON:{value:W},...c,[Symbol.iterator]:{value:Ze},[at]:{value:ie},[A]:i&&{value:i[A]},[lt]:!s[lt]&&{value:o.map(r=>r.name)}}),n===v.Enumeration)for(const{name:r,slot:l}of o)Ye(s,r,s[A][l]);else if(n===v.ErrorSet)for(const{name:r,slot:l}of o)Cs(s,r,s[A][l])}function Qs(t,e){const{byteSize:n,align:s,instance:{members:o},hasPointer:i}=t,c=!!o.find(h=>h.type===x.Object),r=t.constructor=function(h){const p=e.allocateMemory(n,s);this[m]=p,c&&(this[A]={}),u.call(this,h)},l=o.slice(0,-1).map(h=>h.name),a=l.length,u=function(h){if(h.length!==a)throw new Sn(t,h.length);for(const[p,d]of l.entries())try{this[d]=h[p]}catch(b){throw $n(t,p,b)}},f={};for(const h of o)f[h.name]=C(h,e);const y=function(h){return h===this.retval};return F(r.prototype,{...f,[$]:{value:z(n)},[G]:c&&{value:re(t)},[j]:i&&{value:ce(t,{isChildMutable:y})}}),F(r,{[D]:{value:s},[N]:{value:n}}),r}function to(t,e){const{length:n,byteSize:s,align:o,instance:{members:[i]},hasPointer:c}=t,{get:r,set:l}=C(i,e),a=en(i),u=et(t),f=function(w){if(w instanceof h)this[$](w),c&&this[j](It,{vivificate:!0,source:w});else if(typeof w=="string"&&a&&(w={string:w}),w!=null&&w[Symbol.iterator]){if(w=rn(w),w.length!==n)throw new Ft(t,this,w);let O=0;for(const P of w)l.call(this,O++,P)}else if(w&&typeof w=="object"){if(u.call(this,w)===0)throw new rt(t,w)}else if(w!==void 0)throw new rt(t,w)},y=Qe,h=t.constructor=Y(t,{initializer:f,finalizer:y},e),p=t.typedArray=ft(i),d=i.type===x.Object,b={$:{get:oe,set:f},length:{value:n},dataView:nt(t),base64:st(t),string:a&&Je(t),typedArray:p&&bt(t),get:{value:r},set:{value:l},entries:{value:Dt},valueOf:{value:U},toJSON:{value:W},delete:{value:Q(e)},[Symbol.iterator]:{value:nn},[at]:{value:Dt},[$]:{value:z(s)},[G]:d&&{value:sn(t)},[j]:c&&{value:on()},[k]:{value:tn}},g={child:{get:()=>i.structure.constructor},[Et]:{value:Lt(t)},[D]:{value:o},[N]:{value:s},[_]:{value:t.type}};return H(h,b,g)}function Qe(){const t=new Proxy(this,no);return Object.defineProperty(this,Ut,{value:t}),t}function tn(){ht.call(this),Object.defineProperty(this,"set",{value:pt});const t=this.get;Object.defineProperty(this,"get",{value:function(n){var o;const s=t.call(this,n);return(s==null?void 0:s[ut])===null&&((o=s[k])==null||o.call(s)),s}})}function en(t){return t.type===x.Uint&&[8,16].includes(t.bitSize)}function nn(){const t=this[te]??this,e=this.length;let n=0;return{next(){let s,o;if(n<e){const i=n++;s=t.get(i),o=!1}else o=!0;return{value:s,done:o}}}}function eo(t){const e=this[te]??this,n=this.length;let s=0;return{next(){let o,i;if(s<n){const c=s++;o=[c,Pt(()=>e.get(c),t)],i=!1}else i=!0;return{value:o,done:i}}}}function Dt(t){return{[Symbol.iterator]:eo.bind(this,t),length:this.length}}function sn(t){const{instance:{members:[e]}}=t,{byteSize:n,structure:s}=e;return function(i){const{constructor:c}=s,r=this[m],a=r.byteOffset+n*i,u=new DataView(r.buffer,a,n);return this[A][i]=c.call(Zt,u)}}function on(t){return function(n,s={}){const{source:o,vivificate:i=!1,isActive:c=J,isMutable:r=J}=s,l={...s,isActive:()=>c(this),isMutable:()=>r(this)};for(let a=0,u=this.length;a<u;a++){o&&(l.source=o==null?void 0:o[A][a]);const f=this[A][a]??(i?this[G](a):null);f&&f[j](n,l)}}}function rn(t){var o;if(typeof t.length=="number")return t;const e=t[Symbol.iterator](),n=e.next(),s=(o=n.value)==null?void 0:o.length;if(typeof s=="number"&&Object.keys(n.value).join()==="length")return Object.assign(function*(){let i;for(;!(i=e.next()).done;)yield i.value}(),{length:s});{const i=[];let c=n;for(;!c.done;)i.push(c.value),c=e.next();return i}}const no={get(t,e){const n=typeof e=="symbol"?0:e|0;if(n!==0||n==e)return t.get(n);switch(e){case"get":return t[mt]||(t[mt]=t.get.bind(t)),t[mt];case"set":return t[gt]||(t[gt]=t.set.bind(t)),t[gt];case te:return t;default:return t[e]}},set(t,e,n){const s=typeof e=="symbol"?0:e|0;if(s!==0||s==e)t.set(s,n);else switch(e){case"get":t[mt]=n;break;case"set":t[gt]=n;break;default:t[e]=n}return!0},deleteProperty(t,e){const n=typeof e=="symbol"?0:e|0;if(n!==0||n==e)return!1;switch(e){case"get":delete t[mt];break;case"set":delete t[gt];break;default:delete t[e]}return!0},has(t,e){const n=typeof e=="symbol"?0:e|0;return n!==0||n==e?n>=0&&n<t.length:t[e]},ownKeys(t){const e=[];for(let n=0,s=t.length;n<s;n++)e.push(`${n}`);return e.push("length",Ut),e},getOwnPropertyDescriptor(t,e){const n=typeof e=="symbol"?0:e|0;if(n!==0||n==e){if(n>=0&&n<t.length)return{value:t.get(n),enumerable:!0,writable:!0,configurable:!0}}else return Object.getOwnPropertyDescriptor(t,e)}};function so(t,e){const{byteSize:n,align:s,instance:{members:o},hasPointer:i}=t,{get:c,set:r}=C(o[0],e),{get:l,set:a}=C(o[1],e),u=function(){if(l.call(this,"number"))throw l.call(this);return c.call(this)},f=o[0].type===x.Void,y=o[1].structure.constructor,h=function(){return!l.call(this,"number")},p=function(){var E;this[me](),(E=this[j])==null||E.call(this,Gs)},d=!!o.find(E=>E.type===x.Object),b=et(t),g=function(E){if(E instanceof w)this[$](E),i&&h.call(this)&&this[j](It,{vivificate:!0,source:E});else if(E instanceof y[wt]&&y(E))a.call(this,E),p.call(this);else if(E!==void 0||f)try{r.call(this,E),a.call(this,0,"number")}catch(L){if(E instanceof Error)throw new Oe(t);if(Tt(E))a.call(this,E),p.call(this);else if(E&&typeof E=="object"){if(b.call(this,E)===0)throw L}else throw L}},w=t.constructor=Y(t,{initializer:g},e),{bitOffset:O,byteSize:P}=o[0],M={$:{get:u,set:g},dataView:nt(t),base64:st(t),valueOf:{value:U},toJSON:{value:W},delete:{value:Q(e)},[$]:{value:z(n)},[me]:{value:_n(O/8,P)},[G]:d&&{value:re(t)},[j]:i&&{value:ce(t,{isChildActive:h})},[k]:{value:ht}},T={[D]:{value:s},[N]:{value:n},[_]:{value:t.type}};return H(w,M,T)}function oo(t,e){const{byteSize:n,align:s,instance:{members:[o]}}=t,{get:i,set:c}=C(o,e),r=et(t),l=function(h){if(h instanceof a)this[$](h);else if(h&&typeof h=="object"){if(r.call(this,h)===0){const p=Ae(o);throw new ct(t,p,h)}}else h!==void 0&&c.call(this,h)},a=t.constructor=Y(t,{initializer:l},e),u=t.typedArray=ft(o),f={$:{get:i,set:c},dataView:nt(t),base64:st(t),typedArray:u&&bt(t),valueOf:{value:U},toJSON:{value:W},delete:{value:Q(e)},[Symbol.toPrimitive]:{value:i},[$]:{value:z(n)},[k]:{value:ht}},y={[Et]:{value:Lt(t)},[D]:{value:s},[N]:{value:n},[_]:{value:t.type}};return H(a,f,y)}function io(t,e){const{align:n,instance:{members:[s]},hasPointer:o}=t,{get:i,set:c}=C(s,e),{byteSize:r,structure:l}=s,a=co(t,e);a&&(t.sentinel=a);const u=en(s),f=function(T,E,L=!1){T||(T=e.allocateMemory(E*r,n,L)),this[m]=T,this[Xt]=E},y=function(T,E){if(E!==this[Xt])throw new Ft(t,this,T)},h=et(t),p=function(T,E=!1){if(T instanceof b)this[m]?y.call(this,T,T.length):f.call(this,null,T.length,E),this[$](T),o&&this[j](It,{vivificate:!0,source:T});else if(typeof T=="string"&&u)p.call(this,{string:T},E);else if(T!=null&&T[Symbol.iterator]){T=rn(T),this[m]?y.call(this,T,T.length):f.call(this,null,T.length,E);let L=0;for(const ot of T)a==null||a.validateValue(ot,L,T.length),c.call(this,L++,ot)}else if(typeof T=="number")if(!this[m]&&T>=0&&isFinite(T))f.call(this,null,T);else throw new rt(t,T,!this[m]);else if(T&&typeof T=="object"){if(h.call(this,T,E)===0)throw new rt(t,T)}else if(T!==void 0)throw new rt(t,T)},d=Qe,b=t.constructor=Y(t,{initializer:p,shapeDefiner:f,finalizer:d},e),g=t.typedArray=ft(s),w=s.type===x.Object,O={shapeDefiner:f},P={$:{get:oe,set:p},length:{get:ro},dataView:nt(t,O),base64:st(t,O),string:u&&Je(t,O),typedArray:g&&bt(t,O),get:{value:i},set:{value:c},entries:{value:Dt},valueOf:{value:U},toJSON:{value:W},delete:{value:Q(e)},[Symbol.iterator]:{value:nn},[at]:{value:Dt},[$]:{value:z(r,!0)},[G]:w&&{value:sn(t)},[j]:o&&{value:on()},[k]:{value:tn}},M={child:{get:()=>l.constructor},[Et]:{value:Lt(t)},[D]:{value:n},[N]:{value:r},[_]:{value:t.type}};return H(b,P,M)}function ro(){return this[Xt]}function co(t,e){const{runtimeSafety:n=!0}=e,{byteSize:s,instance:{members:[o,i],template:c}}=t;if(!i)return;const{get:r}=C(i,e),l=r.call(c,0),{get:a}=C(o,e),u=n?function(h,p,d){if(h===l&&p!==d-1)throw new fe(t,h,p,d);if(h!==l&&p===d-1)throw new Vt(t,l,p,d)}:function(h,p,d){if(h!==l&&p===d-1)throw new Vt(t,l,d)},f=n?function(h,p){for(let d=0;d<p;d++){const b=a.call(h,d);if(b===l&&d!==p-1)throw new fe(t,l,d,p);if(b!==l&&d===p-1)throw new Vt(t,l,p)}}:function(h,p){if(p*s===h[m].byteLength){const d=p-1;if(a.call(h,d)!==l)throw new Vt(t,l,p)}},y=c[m];return{value:l,bytes:y,validateValue:u,validateData:f}}const B=Array(Object.values(v).length);function Eo(){B[v.Primitive]=oo}function Oo(){B[v.Array]=to}function Io(){B[v.Struct]=Xs}function Vo(){B[v.ArgStruct]=Qs}function Mo(){B[v.ErrorUnion]=so}function $o(){B[v.ErrorSet]=He,ps()}function Po(){B[v.Enumeration]=Us,ds()}function jo(){B[v.Pointer]=Bs,ys()}function Do(){B[v.Slice]=io}function Co(){B[v.Vector]=Hs}function lo(t){return B[t]}class ao{constructor(){V(this,"context");V(this,"contextStack",[]);V(this,"consolePending",[]);V(this,"consoleTimeout",0);V(this,"viewMap",new WeakMap);V(this,"initPromise");V(this,"abandoned",!1);V(this,"released",!1);V(this,"littleEndian",!0);V(this,"runtimeSafety",!0);V(this,"comptime",!1);V(this,"variables",[]);V(this,"imports");V(this,"console",globalThis.console)}startContext(){this.context&&this.contextStack.push(this.context),this.context=new uo}endContext(){this.context=this.contextStack.pop()}allocateMemory(e,n=0,s=!1){return s?this.allocateFixedMemory(e,n):this.allocateRelocMemory(e,n)}allocateRelocMemory(e,n){return this.obtainView(new ArrayBuffer(e),0,e)}registerMemory(e,n=null,s=void 0){const{memoryList:o}=this.context,i=this.getViewAddress(e),c=qt(o,i);return o.splice(c,0,{address:i,dv:e,len:e.byteLength,targetDV:n,targetAlign:s}),i}unregisterMemory(e){const{memoryList:n}=this.context,s=qt(n,e),o=n[s-1];(o==null?void 0:o.address)===e&&n.splice(s-1,1)}findMemory(e,n,s){if(yo(e))if(!n)e=0;else return null;else if(!e&&n)return null;let o=n*(s??0);if(this.context){const{memoryList:i}=this.context,c=qt(i,e),r=i[c-1];if((r==null?void 0:r.address)===e&&r.len===o)return r.targetDV??r.dv;if((r==null?void 0:r.address)<=e&&e<yt(r.address,r.len)){const l=Number(e-r.address),a=r.targetDV??r.dv,u=s===void 0;u&&(o=a.byteLength-l);const f=this.obtainView(a.buffer,a.byteOffset+l,o);return u&&(f[D]=r.targetAlign),f}}return this.obtainFixedView(e,o)}getViewAddress(e){const n=this.getBufferAddress(e.buffer);return yt(n,e.byteOffset)}obtainView(e,n,s){let o=this.viewMap.get(e);if(!o){const r=new DataView(e,n,s);return this.viewMap.set(e,r),r}if(o instanceof DataView){if(o.byteOffset===n&&o.byteLength===s)return o;{const r=o;o={[`${r.byteOffset}:${r.byteLength}`]:r},this.viewMap.set(e,o)}}const i=`${n}:${s}`;let c=o[i];return c||(c=o[i]=new DataView(e,n,s)),c}captureView(e,n,s){if(s){const o=this.allocateRelocMemory(n,0);return n>0&&this.copyBytes(o,e,n),o}else return this.obtainFixedView(e,n)}castView(e,n,s,o){const{constructor:i,hasPointer:c}=o,r=this.captureView(e,n,s),l=i.call(St,r);return c&&this.acquirePointerTargets(l),s&&l[k](),l}finalizeShape(e){const s=lo(e.type)(e,this);typeof s=="function"&&(F(s,{name:{value:e.name,configurable:!0}}),s.prototype.hasOwnProperty(Symbol.toStringTag)||F(s.prototype,{[Symbol.toStringTag]:{value:e.name,configurable:!0}}))}finalizeStructure(e){Zs(e,this),Ns(e,this)}createCaller(e,n){const{name:s,argStruct:o,thunkId:i}=e,{constructor:c}=o,r=this;let l;return n?l=function(...a){return r.invokeThunk(i,new c([this,...a]))}:l=function(...a){return r.invokeThunk(i,new c(a))},Object.defineProperty(l,"name",{value:s}),l}recreateStructures(e,n){Object.assign(this,n);const s=(c,r)=>{for(const[l,a]of Object.entries(r))c[l]=o(a);return c},o=c=>{var r;if(c.memory){const{array:l,offset:a,length:u}=c.memory,f=this.obtainView(l.buffer,a,u),{constructor:y}=c.structure,{reloc:h,const:p}=c,d=y.call(St,f);return p&&((r=d[k])==null||r.call(d)),c.slots&&s(d[A],c.slots),h!==void 0&&this.variables.push({reloc:h,object:d}),d}else return c.structure};Fs();const i=new Map;for(const c of e){for(const r of[c.instance,c.static])if(r.template){const l=r.template,a=r.template={};if(l.memory){const{array:u,offset:f,length:y}=l.memory;a[m]=this.obtainView(u.buffer,f,y)}if(l.slots){const u=a[A]={};i.set(u,l.slots)}}this.finalizeShape(c)}for(const[c,r]of i)s(c,r);for(const c of e)this.finalizeStructure(c)}linkVariables(e){const n=[];for(const{object:s,reloc:o}of this.variables)this.linkObject(s,o,e),s[it]&&s[A][0]&&n.push(s);for(const s of n){const o=s[it](),i=this.getViewAddress(o[m]),{length:c=1}=o;s[dt]={address:i,length:c}}}linkObject(e,n,s){if(this.inFixedMemory(e))return;const o=e[m],i=this.recreateAddress(n),c=this.obtainFixedView(i,o.byteLength);if(s){const l=Object.create(e.constructor.prototype);l[m]=c,l[$](e)}e[m]=c;const r=l=>{if(l[A]){for(const a of Object.values(l[A]))if(a){const u=a[m];if(u.buffer===o.buffer){const f=u.byteOffset-o.byteOffset;a[m]=this.obtainView(c.buffer,f,u.byteLength),r(a)}}}};r(e)}unlinkVariables(){for(const{object:e}of this.variables)this.unlinkObject(e)}unlinkObject(e){if(!this.inFixedMemory(e))return;const n=e[m],s=this.allocateMemory(n.byteLength),o=Object.create(e.constructor.prototype);o[m]=s,o[$](e),e[m]=s}releaseFunctions(){const e=()=>{throw new Error("Module was abandoned")};for(const n of Object.keys(this.imports))this[n]&&(this[n]=e)}getSpecialExports(){return{init:()=>this.initPromise??Promise.resolve(),abandon:()=>this.abandon(),released:()=>this.released,connect:e=>this.console=e}}abandon(){this.abandoned||(this.releaseFunctions(),this.unlinkVariables(),this.abandoned=!0)}writeToConsole(e){const{console:n}=this;try{const s=new Uint8Array(e.buffer,e.byteOffset,e.byteLength).slice(),o=s.lastIndexOf(10);if(o===-1)this.consolePending.push(s);else{const i=s.subarray(0,o),c=s.subarray(o+1),r=[...this.consolePending,i];n.log(vt(r)),this.consolePending=c.length>0?[c]:[]}clearTimeout(this.consoleTimeout),this.consolePending.length>0&&(this.consoleTimeout=setTimeout(()=>{n.log(vt(this.consolePending)),this.consolePending=[]},250))}catch(s){n.error(s)}}flushConsole(){this.consolePending.length>0&&(console.log(vt(this.consolePending)),this.consolePending=[],clearTimeout(this.consoleTimeout))}updatePointerAddresses(e){const n=new Map,s=new Map,o=[],i=this,c=function({isActive:a}){var y;if(!a(this))return;const u=this[xt];if(n.get(u))return;const f=u[A][0];if(f&&(n.set(u,f),!i.inFixedMemory(f))){const h=f[m],p=s.get(h.buffer);if(p){const d=Array.isArray(p)?p:[p],b=cn(d,h.byteOffset,g=>g[m].byteOffset);d.splice(b,0,f),Array.isArray(p)||(s.set(h.buffer,d),o.push(d))}else s.set(h.buffer,f);(y=f[j])==null||y.call(f,c)}};e[j](c);const r=this.findTargetClusters(o),l=new Map;for(const a of r)for(const u of a.targets)l.set(u,a);for(const[a,u]of n){const f=l.get(u),{length:y=1}=u;let h=this.getTargetAddress(u,f);h===!1&&(h=this.getShadowAddress(u,f)),a[je]({address:h,length:y})}}findTargetClusters(e){const n=[];for(const s of e){let o=null,i=0,c=0,r=null;for(const l of s){const a=l[m],{byteOffset:u,byteLength:f}=a,y=u+f;let h=!0;o&&(c>u?(r||(r={targets:[o],start:i,end:c,address:void 0,misaligned:void 0},n.push(r)),r.targets.push(l),y>c?r.end=y:h=!1):r=null),h&&(o=l,i=u,c=y)}}return n}createClusterShadow(e){const{start:n,end:s,targets:o}=e;let i=0,c;for(const g of o){const w=g[m],O=w.byteOffset,P=g.constructor[D]??w[D];(i===void 0||P>i)&&(i=P,c=O)}const r=s-n,l=this.allocateShadowMemory(r+i,1),a=this.getViewAddress(l),u=ho(yt(a,c-n),i),f=yt(u,n-c),y=l.byteOffset+Number(f-a),h=new DataView(l.buffer,y,r);for(const g of o){const w=g[m],O=w.byteOffset;if(O!==c){const P=g.constructor[D]??w[D];if(fo(yt(f,O-n),P))throw new xn(P,i)}}const p={[$]:z(r)},d=Object.create(p),b=Object.create(p);return d[m]=new DataView(o[0][m].buffer,Number(n),r),b[m]=h,b[Mt]={address:a,len:l.byteLength,align:1},this.addShadow(b,d,1)}getShadowAddress(e,n){if(n){const s=e[m];if(n.address===void 0){const o=this.createClusterShadow(n);n.address=this.getViewAddress(o[m])}return yt(n.address,s.byteOffset-n.start)}else{const s=this.createShadow(e);return this.getViewAddress(s[m])}}createShadow(e){const n=e[m],s=e.constructor[D]??n[D],o=Object.create(e.constructor.prototype),i=o[m]=this.allocateShadowMemory(n.byteLength,s);return o[Mt]={address:this.getViewAddress(i),len:i.byteLength,align:s},this.addShadow(o,e,s)}addShadow(e,n,s){let{shadowMap:o}=this.context;return o||(o=this.context.shadowMap=new Map),o.set(e,n),this.registerMemory(e[m],n[m],s),e}removeShadow(e){const{shadowMap:n}=this.context;if(n){for(const[s]of n)if(s[m]===e){n.delete(s);break}}}updateShadows(){const{shadowMap:e}=this.context;if(e)for(const[n,s]of e)n[$](s)}updateShadowTargets(){const{shadowMap:e}=this.context;if(e)for(const[n,s]of e)s[$](n)}releaseShadows(){const{shadowMap:e}=this.context;if(e)for(const[n]of e){const{address:s,len:o,align:i}=n[Mt];this.freeShadowMemory(s,o,i)}}acquirePointerTargets(e){const n=this,s=new Map,o=function({isActive:i,isMutable:c}){var y,h;const r=this[xt];if(s.get(r))return;s.set(r,!0);const l=!r.constructor.const,a=r[A][0];let u,f;if(i(this)){const p=r.constructor.child;if(!a||c(this)){f=r[Ht]();const d=n.findMemory(f.address,f.length,p[N]);u=d?p.call(St,d):null}else u=a}(y=a==null?void 0:a[j])==null||y.call(a,o,{vivificate:!0,isMutable:()=>l}),u!==a&&((h=u==null?void 0:u[j])==null||h.call(u,o,{vivificate:!0,isMutable:()=>l}),r[A][0]=u,n.inFixedMemory(r)&&(r[dt]=f))};e[j](o,{vivificate:!0})}}class uo{constructor(){V(this,"pointerProcessed",new Map);V(this,"memoryList",[]);V(this,"shadowMap",null);V(this,"call",0)}}function cn(t,e,n){let s=0,o=t.length;if(o===0)return 0;for(;s<o;){const i=Math.floor((s+o)/2);n(t[i])<=e?s=i+1:o=i}return o}function qt(t,e){return cn(t,e,n=>n.address)}function fo(t,e){if(e===void 0)return!1;typeof t=="bigint"&&(t=Number(t&0xFFFFFFFFn));const n=e-1;return(t&n)!==0}function ho(t,e){let n;return typeof t=="bigint"?(e=BigInt(e),n=~(e-1n)):n=~(e-1),(t&n)+e}function yt(t,e){return t+(typeof t=="bigint"?BigInt(e):e)}function yo(t){return typeof t=="bigint"?t===0xaaaaaaaaaaaaaaaan:t===2863311530}class po extends ao{constructor(){super(...arguments);V(this,"imports",{getFactoryThunk:{argType:"",returnType:"i"},allocateExternMemory:{argType:"ii",returnType:"i"},freeExternMemory:{argType:"iii"},allocateShadowMemory:{argType:"cii",returnType:"v"},freeShadowMemory:{argType:"ciii"},runThunk:{argType:"iv",returnType:"v"},isRuntimeSafetyActive:{argType:"",returnType:"b"}});V(this,"exports",{allocateHostMemory:{argType:"ii",returnType:"v"},freeHostMemory:{argType:"iii"},captureString:{argType:"ii",returnType:"v"},captureView:{argType:"iib",returnType:"v"},castView:{argType:"iibv",returnType:"v"},getSlotNumber:{argType:"ii",returnType:"i"},readSlot:{argType:"vi",returnType:"v"},writeSlot:{argType:"viv"},getViewAddress:{argType:"v",returnType:"i"},beginDefinition:{returnType:"v"},insertInteger:{argType:"vsi",alias:"insertProperty"},insertBoolean:{argType:"vsb",alias:"insertProperty"},insertString:{argType:"vss",alias:"insertProperty"},insertObject:{argType:"vsv",alias:"insertProperty"},beginStructure:{argType:"v",returnType:"v"},attachMember:{argType:"vvb"},attachMethod:{argType:"vvb"},createTemplate:{argType:"v",returnType:"v"},attachTemplate:{argType:"vvb"},finalizeShape:{argType:"v"},endStructure:{argType:"v"},startCall:{argType:"iv",returnType:"i"},endCall:{argType:"iv",returnType:"i"}});V(this,"nextValueIndex",1);V(this,"valueTable",{0:null});V(this,"valueIndices",new Map);V(this,"memory",null);V(this,"littleEndian",!0)}allocateHostMemory(n,s){const o={[D]:s},i=z(n),c=this.allocateRelocMemory(n,s),r=this.allocateShadowMemory(n,s),l={constructor:o,[m]:c,[$]:i},a={constructor:o,[m]:r,[$]:i};return a[Mt]={address:this.getViewAddress(r),len:n,align:s},this.addShadow(a,l,s),r}freeHostMemory(n,s,o){const i=this.findMemory(n,s,1);this.removeShadow(i),this.unregisterMemory(n),this.freeShadowMemory(n,s,o)}getBufferAddress(n){return 0}allocateFixedMemory(n,s){const o=n?this.allocateExternMemory(n,s):0,i=this.obtainFixedView(o,n);return i[D]=s,i}freeFixedMemory(n,s,o){s&&this.freeExternMemory(n,s,o)}obtainFixedView(n,s){const{memory:o}=this,i=this.obtainView(o.buffer,n,s);return i[m]={memory:o,address:n,len:s},i}releaseFixedView(n){n.buffer;const s=n.byteOffset,o=n.byteLength,i=n[D];i!==void 0&&this.freeFixedMemory(s,o,i)}inFixedMemory(n){return this.memory?(R.call(n),n[m].buffer===this.memory.buffer):!1}copyBytes(n,s,o){const{memory:i}=this,c=new DataView(i.buffer,s,o);Fe(o)(n,c)}findSentinel(n,s){const{memory:o}=this,i=s.byteLength,c=o.buffer.byteLength-i+1;for(let r=n;r<c;r+=i){const l=new DataView(o.buffer,r,i);let a=!0;for(let u=0;u<i;u++){const f=l.getUint8(u),y=s.getUint8(u);if(f!==y){a=!1;break}}if(a)return(r-n)/i}}captureString(n,s){const{buffer:o}=this.memory,i=new Uint8Array(o,n,s);return vt(i)}getTargetAddress(n,s){return this.inFixedMemory(n)?this.getViewAddress(n[m]):n[m].byteLength===0?0:!1}clearExchangeTable(){this.nextValueIndex!==1&&(this.nextValueIndex=1,this.valueTable={0:null},this.valueIndices=new Map)}getObjectIndex(n){if(n){let s=this.valueIndices.get(n);return s===void 0&&(s=this.nextValueIndex++,this.valueIndices.set(n,s),this.valueTable[s]=n),s}else return 0}fromWebAssembly(n,s){switch(n){case"v":case"s":return this.valueTable[s];case"i":return s;case"b":return!!s}}toWebAssembly(n,s){switch(n){case"v":case"s":return this.getObjectIndex(s);case"i":return s;case"b":return s?1:0}}exportFunction(n,s="",o=""){return n?(...i)=>{i=i.map((r,l)=>this.fromWebAssembly(s.charAt(l),r));const c=n.apply(this,i);return this.toWebAssembly(o,c)}:()=>{}}importFunction(n,s="",o=""){let i=!1;return s.startsWith("c")&&(i=!0,s=s.slice(1)),(...c)=>{c=c.map((l,a)=>this.toWebAssembly(s.charAt(a),l)),i&&(c=[this.context.call,...c]);const r=n.apply(this,c);return this.fromWebAssembly(o,r)}}exportFunctions(){const n={};for(const[s,{argType:o,returnType:i,alias:c}]of Object.entries(this.exports)){const r=this[c??s];n[`_${s}`]=this.exportFunction(r,o,i)}return n}importFunctions(n){for(const[s,o]of Object.entries(n)){const i=this.imports[s];if(i){const{argType:c,returnType:r}=i;this[s]=this.importFunction(o,c,r)}}}async instantiateWebAssembly(n){const s=await n,o=this.exportFunctions(),i=this.getWASI(),c={env:o,wasi_snapshot_preview1:i};return s[Symbol.toStringTag]==="Response"?WebAssembly.instantiateStreaming(s,c):WebAssembly.instantiate(s,c)}loadModule(n){return this.initPromise=(async()=>{const{instance:s}=await this.instantiateWebAssembly(n),{memory:o,_initialize:i}=s.exports;this.importFunctions(s.exports),this.trackInstance(s),this.runtimeSafety=this.isRuntimeSafetyActive(),this.memory=o,i==null||i()})()}trackInstance(n){const s=new WeakRef(n);Object.defineProperty(this,"released",{get:()=>!s.deref(),enumerable:!0})}linkVariables(n){this.initPromise&&(this.initPromise=this.initPromise.then(()=>super.linkVariables(n)))}getMemoryOffset(n){return n}recreateAddress(n){return n}startCall(n,s){this.startContext(),this.context.call=n,s[j]&&this.updatePointerAddresses(s);const o=this.getShadowAddress(s);return this.updateShadows(),o}endCall(n,s){this.updateShadowTargets(),s[j]&&this.acquirePointerTargets(s),this.releaseShadows(),this.endContext(),!this.context&&this.flushConsole&&this.flushConsole()}async runThunk(n,s){return await this.initPromise,this.runThunk(n,s)}invokeThunk(n,s){const o=this.runThunk(n,s);if(o){if(o[Symbol.toStringTag]==="Promise")return o.then(i=>{if(i)throw new de(i);return s.retval});throw new de(o)}return s.retval}getWASI(){return{fd_write:(n,s,o,i)=>{if(n===1||n===2){const c=new DataView(this.memory.buffer);let r=0;for(let l=0,a=s;l<o;l++,a+=8){const u=c.getUint32(a,!0),f=c.getUint32(a+4,!0),y=new DataView(this.memory.buffer,u,f);this.writeToConsole(y),r+=f}return c.setUint32(i,r,!0),0}else return 1},random_get:(n,s)=>{const o=new DataView(this.memory.buffer,n,s);for(let i=0;i<s;i++)o.setUint8(i,Math.floor(256*Math.random()));return 0},proc_exit:()=>{},path_open:()=>1,fd_read:()=>1,fd_close:()=>1}}}function Fo(t){return new po}export{Oo as a,jo as b,Io as c,Co as d,Do as e,Po as f,$o as g,Mo as h,Vo as i,Fo as j,To as k,ys as l,vo as m,xo as n,wo as o,So as p,mo as q,go as r,Eo as u};
